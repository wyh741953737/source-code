(window["webpackJsonp"] = window["webpackJsonp"] || []).push([[2],{

/***/ "../src/pages/mycj/system-message/message.module.js":
/*!**********************************************************!*\
  !*** ../src/pages/mycj/system-message/message.module.js ***!
  \**********************************************************/
/*! exports provided: messageFactory */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"messageFactory\", function() { return messageFactory; });\n/* harmony import */ var _msg_all__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./msg-all */ \"../src/pages/mycj/system-message/msg-all.js\");\n/* harmony import */ var _msg_list__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./msg-list */ \"../src/pages/mycj/system-message/msg-list.js\");\n\n\nfunction messageFactory(angular) {\n  var module = angular.module('system-message', []); // 所有消息\n\n  module.controller('system-message-all.ctrl', ['$rootScope', '$scope', '$timeout', '$location', 'dsp', '$stateParams', _msg_all__WEBPACK_IMPORTED_MODULE_0__[\"messageAllCtrl\"]]); // 消息详情\n\n  module.controller('system-message-list.ctrl', ['$rootScope', '$scope', 'dsp', '$stateParams', '$timeout', '$location', '$sce', _msg_list__WEBPACK_IMPORTED_MODULE_1__[\"messageListCtrl\"]]);\n  return module;\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi4vc3JjL3BhZ2VzL215Y2ovc3lzdGVtLW1lc3NhZ2UvbWVzc2FnZS5tb2R1bGUuanMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi4vc3JjL3BhZ2VzL215Y2ovc3lzdGVtLW1lc3NhZ2UvbWVzc2FnZS5tb2R1bGUuanM/N2QxMyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBtZXNzYWdlQWxsQ3RybCB9IGZyb20gJy4vbXNnLWFsbCc7XHJcbmltcG9ydCB7IG1lc3NhZ2VMaXN0Q3RybCB9IGZyb20gJy4vbXNnLWxpc3QnO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIG1lc3NhZ2VGYWN0b3J5KGFuZ3VsYXIpIHtcclxuXHJcbiAgY29uc3QgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ3N5c3RlbS1tZXNzYWdlJywgW10pO1xyXG5cclxuICAvLyDmiYDmnInmtojmga9cclxuICBtb2R1bGUuY29udHJvbGxlcignc3lzdGVtLW1lc3NhZ2UtYWxsLmN0cmwnLCBbXHJcbiAgICAnJHJvb3RTY29wZScsICckc2NvcGUnLCAnJHRpbWVvdXQnLCAnJGxvY2F0aW9uJywgJ2RzcCcsICckc3RhdGVQYXJhbXMnLFxyXG4gICAgbWVzc2FnZUFsbEN0cmxdKTtcclxuXHJcbiAgLy8g5raI5oGv6K+m5oOFXHJcbiAgbW9kdWxlLmNvbnRyb2xsZXIoJ3N5c3RlbS1tZXNzYWdlLWxpc3QuY3RybCcsIFtcclxuICAgICckcm9vdFNjb3BlJywgJyRzY29wZScsICdkc3AnLCAnJHN0YXRlUGFyYW1zJywgJyR0aW1lb3V0JywgJyRsb2NhdGlvbicsICckc2NlJyxcclxuICAgIG1lc3NhZ2VMaXN0Q3RybF0pO1xyXG5cclxuICByZXR1cm4gbW9kdWxlO1xyXG59XHJcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUlBO0FBSUE7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///../src/pages/mycj/system-message/message.module.js\n");

/***/ }),

/***/ "../src/pages/mycj/system-message/msg-all.js":
/*!***************************************************!*\
  !*** ../src/pages/mycj/system-message/msg-all.js ***!
  \***************************************************/
/*! exports provided: messageAllCtrl */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"messageAllCtrl\", function() { return messageAllCtrl; });\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction messageAllCtrl($rootScope, $scope, $timeout, $location, dsp, $stateParams) {\n  var base64 = new Base64();\n  var token = $rootScope.userInfo.token;\n  $scope.vip = $rootScope.userInfo.vip;\n  $scope.token = token;\n  $scope.userId = base64.decode(localStorage.getItem('userId') == undefined ? \"\" : localStorage.getItem('userId'));\n  $('.cj-am-wrap').css('min-height', $(window).height() - 171 + 'px'); //添加消息详情链接\n\n  $('.cj-ul-p2').click(function () {\n    location.href = '#/message-list';\n  });\n  $scope.pageSize = 10;\n  $scope.pageNum = 1; // $scope.messageList = [];\n\n  layer.load(2); // getMessageList();\n\n  $scope.nodata = false; // tab栏\n\n  $scope.tabVal = '1';\n  $scope.messageTab = [{\n    name: 'From CJ',\n    val: \"1\",\n    isActive: 'true'\n  }, {\n    name: 'ELITES',\n    val: \"2\",\n    isActive: 'false'\n  }, {\n    name: 'Recommendations',\n    val: \"3\",\n    isActive: 'false'\n  }]; //切换tab\n\n  console.log($stateParams.id); // for (var key in $stateParams.id) {\n  //   if (key !== '') {\n  //     $scope.type = key\n  //   }\n  // }\n  // if ($scope.type) {\n  // $scope.tabVal = $scope.type || '1'\n\n  if ($stateParams.id) {\n    $scope.tabVal = $stateParams.id || '1'; // 默认高亮第一个\n\n    console.log($scope.type, $scope.tabVal);\n\n    for (var i = 0; i < $scope.messageTab.length; i++) {\n      $scope.messageTab[i].isActive = 'false';\n    }\n\n    $scope.messageTab[$scope.tabVal - 1].isActive = 'true';\n  }\n\n  $scope.checkTab = function (item) {\n    // window.location.href = \"myCJ.html#/all-message?\" + item.val\n    window.location.href = \"myCJ.html#/all-message/\" + item.val;\n\n    for (var _i = 0; _i < $scope.messageTab.length; _i++) {\n      $scope.messageTab[_i].isActive = 'false';\n    }\n\n    item.isActive = 'true';\n    $scope.tabVal = item.val;\n    $scope.pageNum = 1;\n    getMessage();\n  };\n\n  $scope.toMarkAll = function () {\n    if ($scope.tabVal == '1') {\n      dsp.postFun('messageCenterCj/notification/updateRead', {\n        userId: $scope.userId\n      }, function (data) {\n        console.log(data);\n\n        if (data.data.code == 200) {\n          getMessage(); // window.location.reload()\n        }\n      });\n    } else if ($scope.tabVal == '2') {\n      dsp.postFun('cujia-message/cj/notification/allRead', {}, function (data) {\n        console.log(data);\n\n        if (data.data.statusCode == 200) {\n          getCount();\n          getMessage(); //  window.location.reload()\n        }\n      });\n    } else if ($scope.tabVal == '3') {\n      dsp.postFun('cj/appPush/updateAppPushIsRead', {}, function (data) {\n        console.log(data);\n\n        if (data.data.statusCode == 200) {\n          getCount();\n          getMessage(); //  window.location.reload()\n        }\n      });\n    }\n  };\n\n  $scope.toDetailPage = function (item) {\n    var params = {\n      userId: $scope.userId,\n      noticeId: item.notificationchId\n    };\n    dsp.postFun('messageCenterCj/notification/updateRead', params, function (_ref) {\n      var data = _ref.data;\n      var code = data.code;\n\n      if (+code === 200) {\n        getMessage();\n        CJMsg && CJMsg.refresh();\n      }\n    });\n\n    if (item.redirectType == '2') {\n      // 0详情页1.商品页2.私有库存页\n      location.href = 'myCJ.html#/my-inventory';\n    } else if (item.redirectType == '1') {\n      window.open(item.url + '&href');\n    } else if (item.redirectType == '0') {\n      location.href = 'myCJ.html#/message-list/' + item.id;\n    }\n  };\n\n  $scope.toElites = function (item) {\n    var otime = new Date().getTime();\n    console.log($scope.token);\n    dsp.postFun('cujia-message/cj/notification/informRead', JSON.stringify({\n      id: item.id\n    }), function (data) {\n      if (data.data.statusCode == '200') {\n        getMessage();\n        CJMsg && CJMsg.refresh();\n      }\n    });\n    var token = base64.decode(localStorage.getItem('token') == undefined ? \"\" : localStorage.getItem('token'));\n\n    if (item.operation_type == '1') {\n      window.open(\"https://elites.cjdropshipping.com/cross?token=\".concat(token, \"&_t=\").concat(otime, \"&url=/personal-index?id=\").concat(item.user_id, \"&page=other\")); //关注\n    }\n\n    if (item.operation_type == '4' || item.operation_type == '6' || item.operation_type == '9' || item.operation_type == '10') {\n      window.open(\"https://elites.cjdropshipping.com/cross?token=\".concat(token, \"&_t=\").concat(otime, \"&url=/question-detail?id=\").concat(item.detail_id)); //问题\n    }\n\n    if (item.operation_type == '3' || item.operation_type == '7') {\n      window.open(\"https://elites.cjdropshipping.com/cross?token=\".concat(token, \"&_t=\").concat(otime, \"&url=/question-detail?id=\").concat(item.question_id)); //问题\n    }\n\n    if (item.operation_type == '2' || item.operation_type == '5' || item.operation_type == '8') {\n      window.open(\"https://elites.cjdropshipping.com/cross?token=\".concat(token, \"&_t=\").concat(otime, \"&url=/article-detail?id=\").concat(item.detail_id)); //文章详情      \n    }\n  };\n\n  $scope.toCommentDetail = function (item) {\n    console.log(item);\n    CJMsg && CJMsg.refresh();\n    location.href = 'list-detail.html?id=' + item.push_id + '&fromType=CommentList';\n  }; // 最后一条删除成功时, 页数减1, 再请求接口\n\n\n  function beforeDelLastItem() {\n    if ($scope.messageList.length <= 1 && $scope.pageNum > 1) {\n      $scope.pageNum--;\n    }\n  }\n\n  $scope.deleteMes = function (item, index1, $event) {\n    $event.stopPropagation();\n    var params = {\n      deleteId: item.notificationchId,\n      userId: $scope.userId\n    };\n    dsp.postFun('messageCenterCj/notification/deleteNotification', params, function (_ref2) {\n      var data = _ref2.data;\n      var code = data.code;\n\n      if (+code !== 200) {\n        layer.msg('Delete failed');\n        return;\n      }\n\n      layer.msg('Delete successfully', {\n        time: 1000\n      }); // $timeout(function () {\n      //   $scope.messageList.splice(index1, 1);\n      //   $('.cj-list-ul li').eq(index1).remove();\n      // }, 1000);\n\n      beforeDelLastItem();\n      getMessage();\n    });\n  };\n\n  $scope.deleteRecommend = function (item, index1, $event) {\n    $event.stopPropagation();\n    console.log(item);\n    var deleteDate = {};\n    deleteDate.push_id = item.push_id;\n    dsp.postFun('cj/appPush/delectAppPushById', JSON.stringify(deleteDate), function (data) {\n      var data = data.data;\n      console.log(data);\n\n      if (data.statusCode != 200) {\n        layer.msg('Delete failed');\n        return false;\n      }\n\n      layer.msg('Delete successfully', {\n        time: 1000\n      }); // $timeout(function () {\n      //   $scope.messageList.splice(index1, 1);\n      //   $('.cj-list-ul li').eq(index1).remove();\n      // }, 1000);\n\n      delgetReconed(dsp, $rootScope);\n      beforeDelLastItem();\n      getMessage();\n    }, err);\n  };\n\n  $scope.totalPage = '';\n\n  function getMessage() {\n    if ($scope.tabVal == '1') {\n      $scope.messageList = [];\n      getMessageCJ();\n    } else if ($scope.tabVal == '2') {\n      $scope.messageList = [];\n      getMessageElites();\n    } else if ($scope.tabVal == '3') {\n      $scope.messageList = [];\n      getCommentList();\n    }\n  }\n\n  getMessage();\n\n  function getMessageCJ(isFy) {\n    $scope.nodata = false;\n    var getTopMesData = {\n      pageSize: $scope.pageSize * 1,\n      pageNum: $scope.pageNum * 1,\n      data: {\n        userId: $scope.userId\n      }\n    }; // dsp.postFun('messageCenterCj/notification/queryGetCjnotification', getTopMesData, ({ data }) => {\n\n    dsp.postFun('messageCenterCj/notification/queryNotificationList', getTopMesData, function (_ref3) {\n      var data = _ref3.data;\n      var code = data.code,\n          _data$data = data.data,\n          result = _data$data === void 0 ? {} : _data$data;\n      layer.closeAll('loading');\n\n      if (+code !== 200) {\n        $scope.nodata = true;\n        return;\n      }\n\n      ;\n      var list = result.list,\n          total = result.total;\n      $scope.messageList = list.map(function (v) {\n        var ind = v.notificationType.indexOf('html:');\n\n        if (ind > -1) {\n          v.url = v.notificationType.slice(ind + 5);\n          v.notificationType = v.notificationType.slice(0, ind);\n        }\n\n        return v;\n      });\n\n      if ($scope.messageList.length == 0) {\n        $scope.nodata = true;\n      }\n\n      $scope.totalPage = +total;\n      !isFy && $(\"#ld-pages\").jqPaginator({\n        // totalPages: 20,//分页的总页数\n        totalCounts: $scope.totalPage,\n        pageSize: $scope.pageSize,\n        visiblePages: 5,\n        //显示多少页\n        currentPage: $scope.pageNum,\n        //当钱第几页\n        activeClass: $scope.vip == '1' ? 'pageActiveVip' : 'active',\n        prev: '<a class=\"prev\" href=\"javascript:void(0);\">&lt;<\\/a>',\n        next: '<a class=\"next\" href=\"javascript:void(0);\">&gt;<\\/a>',\n        page: '<a href=\"javascript:void(0);\">{{page}}<\\/a>',\n        first: '<a class=\"prev\" href=\"javascript:void(0);\">&lt&lt;<\\/a>',\n        last: '<a class=\"prev\" href=\"javascript:void(0);\">&gt&gt;<\\/a>',\n        onPageChange: function onPageChange(n, type) {\n          if (type == 'init') return;\n          $scope.pageNum = n;\n          getMessageCJ(true);\n        }\n      });\n    });\n  }\n\n  function getMessageElites() {\n    $scope.nodata = false;\n    var getTopMesData = {\n      pageSize: $scope.pageSize + '',\n      pageNum: $scope.pageNum + ''\n    };\n    dsp.postFun(\"cujia-message/cj/notification/getInformList\", getTopMesData, function (data) {\n      layer.closeAll('loading');\n      console.log(data);\n      var data = data.data;\n      var result = data.result;\n\n      if (result.total == 0) {\n        $scope.messageList = [];\n        $scope.nodata = true;\n        return;\n      }\n\n      $scope.messageList = result.list;\n      $(\"#ld-pages\").jqPaginator({\n        // totalPages: 20,//分页的总页数\n        totalCounts: result.total,\n        pageSize: $scope.pageSize,\n        visiblePages: 5,\n        //显示多少页\n        currentPage: $scope.pageNum,\n        //当钱第几页\n        activeClass: $scope.vip == '1' ? 'pageActiveVip' : 'active',\n        prev: '<a class=\"prev\" href=\"javascript:void(0);\">&lt;<\\/a>',\n        next: '<a class=\"next\" href=\"javascript:void(0);\">&gt;<\\/a>',\n        page: '<a href=\"javascript:void(0);\">{{page}}<\\/a>',\n        first: '<a class=\"prev\" href=\"javascript:void(0);\">&lt&lt;<\\/a>',\n        last: '<a class=\"prev\" href=\"javascript:void(0);\">&gt&gt;<\\/a>',\n        onPageChange: function onPageChange(n, type) {\n          if (type == 'init') return;\n          $scope.pageNum = n;\n          var getMesListData = {\n            pageSize: $scope.pageSize + '',\n            pageNum: $scope.pageNum + ''\n          };\n          dsp.postFun('cujia-message/cj/notification/getInformList', JSON.stringify(getMesListData), function (data) {\n            layer.closeAll('loading');\n            var data = data.data;\n\n            if (data.statusCode == 200) {\n              var result = data.result;\n              $scope.messageList = result.list;\n\n              if (result.total == 0) {\n                $scope.messageList = [];\n                $scope.nodata = true;\n                return;\n              }\n            }\n          }, err);\n        }\n      });\n    }, err);\n  }\n\n  function getCommentList() {\n    $scope.nodata = false;\n    dsp.postFun('cj/appPush/getCJPushInfoListByUserId', {\n      pageSize: $scope.pageSize,\n      pageNum: $scope.pageNum\n    }, function (data) {\n      layer.closeAll('loading');\n      console.log(data);\n      var data = data.data;\n      var result = data.result;\n      console.log(result);\n\n      if (result.count == 0 || result.total == 0) {\n        $scope.messageList = [];\n        $scope.nodata = true;\n        return;\n      }\n\n      var isReadArr = [];\n      var list = result.list || [];\n      $scope.messageList = list.map(function (_) {\n        var arr = _.picurl.split(',');\n\n        return _objectSpread(_objectSpread({}, _), {}, {\n          img_url_one: arr.length > 0 ? arr[0] : _.picurl\n        });\n      });\n      $scope.messageList && $scope.messageList.forEach(function (con) {\n        con.create_time = con.create_time.split('.')[0];\n      });\n      $scope.totalPage = result.total;\n      $(\"#ld-pages\").jqPaginator({\n        // totalPages: 20,//分页的总页数\n        totalCounts: result.count ? result.count : result.total,\n        pageSize: $scope.pageSize,\n        visiblePages: 5,\n        //显示多少页\n        currentPage: $scope.pageNum,\n        //当钱第几页\n        activeClass: $scope.vip == '1' ? 'pageActiveVip' : 'active',\n        prev: '<a class=\"prev\" href=\"javascript:void(0);\">&lt;<\\/a>',\n        next: '<a class=\"next\" href=\"javascript:void(0);\">&gt;<\\/a>',\n        page: '<a href=\"javascript:void(0);\">{{page}}<\\/a>',\n        first: '<a class=\"prev\" href=\"javascript:void(0);\">&lt&lt;<\\/a>',\n        last: '<a class=\"prev\" href=\"javascript:void(0);\">&gt&gt;<\\/a>',\n        onPageChange: function onPageChange(n, type) {\n          if (type == 'init') return;\n          $scope.pageNum = n;\n          var getMesListData = {\n            pageSize: $scope.pageSize,\n            isread: '',\n            start: $scope.pageNum\n          };\n          dsp.postFun('cj/appPush/getCJPushInfoListByUserId', {\n            pageSize: $scope.pageSize,\n            pageNum: $scope.pageNum\n          }, function (data) {\n            layer.closeAll('loading');\n            var data = data.data;\n\n            if (data.statusCode == 200) {\n              var result = data.result;\n\n              var _list = result.list || [];\n\n              $scope.messageList = _list.map(function (_) {\n                var arr = _.picurl.split(',');\n\n                return _objectSpread(_objectSpread({}, _), {}, {\n                  img_url_one: arr.length > 0 ? arr[0] : _.picurl\n                });\n              });\n\n              if (result.count == 0 || result.total == 0) {\n                $scope.messageList = [];\n                $scope.nodata = true;\n                return;\n              } // $scope.messageList = result.list;\n\n\n              $scope.messageList && $scope.messageList.forEach(function (con) {\n                con.create_time = con.create_time.split('.')[0];\n              });\n            }\n          }, err);\n        }\n      });\n    }, err);\n  } //获取信息数量\n\n\n  function getCount() {\n    dsp.postFun('cujia-message/cj/notification/selectIsNotRead', {\n      isread: 0\n    }, function (data) {\n      if (data.data.statusCode == 200) {\n        result = data.data.result;\n        $scope.messageNum = result.count * 1;\n\n        for (var _i2 = 0; _i2 < $scope.messageTab.length; _i2++) {\n          $scope.messageTab[0].count = result.cjCount * 1;\n          $scope.messageTab[1].count = result.elitesCount * 1;\n          $scope.messageTab[2].count = result.pushCount * 1;\n        }\n      }\n    });\n  }\n\n  if ($scope.hasLogin) {\n    getCount();\n  }\n\n  function err(err) {\n    layer.closeAll('loading');\n    console.log(err);\n  }\n\n  function delgetReconed(dsp, $rootScope) {\n    var getTopMesData = {\n      \"pageNum\": \"1\",\n      \"pageSize\": \"5\"\n    };\n    dsp.postFun('cj/appPush/getCJPushInfoListByUserId', getTopMesData, function (data) {\n      console.log(data.data);\n      var data = data.data;\n\n      if (data.statusCode == 200) {\n        var result = data.result;\n        console.log(result);\n        $scope.messagePre = result.list;\n        var isReadArr = [];\n\n        for (var _i3 = 0; _i3 < $scope.messagePre.length; _i3++) {\n          isReadArr.push($scope.messagePre[_i3].is_read);\n\n          if (isReadArr.includes(2)) {\n            $scope.isMark = false;\n          }\n        }\n      }\n    });\n  }\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi4vc3JjL3BhZ2VzL215Y2ovc3lzdGVtLW1lc3NhZ2UvbXNnLWFsbC5qcy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uLi9zcmMvcGFnZXMvbXljai9zeXN0ZW0tbWVzc2FnZS9tc2ctYWxsLmpzP2NmY2YiXSwic291cmNlc0NvbnRlbnQiOlsiXHJcbmV4cG9ydCBmdW5jdGlvbiBtZXNzYWdlQWxsQ3RybCgkcm9vdFNjb3BlLCAkc2NvcGUsICR0aW1lb3V0LCAkbG9jYXRpb24sIGRzcCwgJHN0YXRlUGFyYW1zKSB7XHJcbiAgdmFyIGJhc2U2NCA9IG5ldyBCYXNlNjQoKTtcclxuICB2YXIgdG9rZW4gPSAkcm9vdFNjb3BlLnVzZXJJbmZvLnRva2VuO1xyXG4gICRzY29wZS52aXAgPSAkcm9vdFNjb3BlLnVzZXJJbmZvLnZpcDtcclxuICAkc2NvcGUudG9rZW4gPSB0b2tlblxyXG4gICRzY29wZS51c2VySWQgPSBiYXNlNjQuZGVjb2RlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd1c2VySWQnKSA9PSB1bmRlZmluZWQgPyBcIlwiIDogbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3VzZXJJZCcpKTtcclxuICAkKCcuY2otYW0td3JhcCcpLmNzcygnbWluLWhlaWdodCcsICgkKHdpbmRvdykuaGVpZ2h0KCkgLSAxNzEpICsgJ3B4Jyk7XHJcbiAgLy/mt7vliqDmtojmga/or6bmg4Xpk77mjqVcclxuICAkKCcuY2otdWwtcDInKS5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICBsb2NhdGlvbi5ocmVmID0gJyMvbWVzc2FnZS1saXN0JztcclxuICB9KVxyXG4gICRzY29wZS5wYWdlU2l6ZSA9IDEwO1xyXG4gICRzY29wZS5wYWdlTnVtID0gMTtcclxuICAvLyAkc2NvcGUubWVzc2FnZUxpc3QgPSBbXTtcclxuICBsYXllci5sb2FkKDIpO1xyXG4gIC8vIGdldE1lc3NhZ2VMaXN0KCk7XHJcbiAgJHNjb3BlLm5vZGF0YSA9IGZhbHNlO1xyXG5cclxuICAvLyB0YWLmoI9cclxuICAkc2NvcGUudGFiVmFsID0gJzEnXHJcbiAgJHNjb3BlLm1lc3NhZ2VUYWIgPSBbXHJcbiAgICB7IG5hbWU6ICdGcm9tIENKJywgdmFsOiBcIjFcIiwgaXNBY3RpdmU6ICd0cnVlJyB9LFxyXG4gICAgeyBuYW1lOiAnRUxJVEVTJywgdmFsOiBcIjJcIiwgaXNBY3RpdmU6ICdmYWxzZScgfSxcclxuICAgIHsgbmFtZTogJ1JlY29tbWVuZGF0aW9ucycsIHZhbDogXCIzXCIsIGlzQWN0aXZlOiAnZmFsc2UnIH0sXHJcbiAgXVxyXG4gIC8v5YiH5o2idGFiXHJcbiAgY29uc29sZS5sb2coJHN0YXRlUGFyYW1zLmlkKVxyXG4gIC8vIGZvciAodmFyIGtleSBpbiAkc3RhdGVQYXJhbXMuaWQpIHtcclxuICAvLyAgIGlmIChrZXkgIT09ICcnKSB7XHJcbiAgLy8gICAgICRzY29wZS50eXBlID0ga2V5XHJcbiAgLy8gICB9XHJcbiAgLy8gfVxyXG4gIC8vIGlmICgkc2NvcGUudHlwZSkge1xyXG4gICAgLy8gJHNjb3BlLnRhYlZhbCA9ICRzY29wZS50eXBlIHx8ICcxJ1xyXG4gIGlmICgkc3RhdGVQYXJhbXMuaWQpIHtcclxuICAgICRzY29wZS50YWJWYWwgPSAkc3RhdGVQYXJhbXMuaWQgfHwgJzEnIC8vIOm7mOiupOmrmOS6ruesrOS4gOS4qlxyXG4gICAgY29uc29sZS5sb2coJHNjb3BlLnR5cGUsICRzY29wZS50YWJWYWwpXHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8ICRzY29wZS5tZXNzYWdlVGFiLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICRzY29wZS5tZXNzYWdlVGFiW2ldLmlzQWN0aXZlID0gJ2ZhbHNlJ1xyXG4gICAgfVxyXG4gICAgICAkc2NvcGUubWVzc2FnZVRhYlskc2NvcGUudGFiVmFsIC0gMV0uaXNBY3RpdmUgPSAndHJ1ZSdcclxuICB9XHJcbiAgJHNjb3BlLmNoZWNrVGFiID0gZnVuY3Rpb24gKGl0ZW0pIHtcclxuICAgIC8vIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gXCJteUNKLmh0bWwjL2FsbC1tZXNzYWdlP1wiICsgaXRlbS52YWxcclxuICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gXCJteUNKLmh0bWwjL2FsbC1tZXNzYWdlL1wiICsgaXRlbS52YWxcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgJHNjb3BlLm1lc3NhZ2VUYWIubGVuZ3RoOyBpKyspIHtcclxuICAgICAgJHNjb3BlLm1lc3NhZ2VUYWJbaV0uaXNBY3RpdmUgPSAnZmFsc2UnXHJcbiAgICB9XHJcbiAgICBpdGVtLmlzQWN0aXZlID0gJ3RydWUnXHJcbiAgICAkc2NvcGUudGFiVmFsID0gaXRlbS52YWw7XHJcbiAgICAkc2NvcGUucGFnZU51bSA9IDFcclxuICAgIGdldE1lc3NhZ2UoKTtcclxuXHJcbiAgfVxyXG5cclxuICAkc2NvcGUudG9NYXJrQWxsID0gZnVuY3Rpb24gKCkge1xyXG4gICAgaWYgKCRzY29wZS50YWJWYWwgPT0gJzEnKSB7XHJcbiAgICAgIGRzcC5wb3N0RnVuKCdtZXNzYWdlQ2VudGVyQ2ovbm90aWZpY2F0aW9uL3VwZGF0ZVJlYWQnLCB7IHVzZXJJZDogJHNjb3BlLnVzZXJJZCB9LCBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGRhdGEpXHJcbiAgICAgICAgaWYgKGRhdGEuZGF0YS5jb2RlID09IDIwMCkge1xyXG4gICAgICAgICAgZ2V0TWVzc2FnZSgpXHJcbiAgICAgICAgICAvLyB3aW5kb3cubG9jYXRpb24ucmVsb2FkKClcclxuICAgICAgICB9XHJcbiAgICAgIH0pXHJcbiAgICB9IGVsc2UgaWYgKCRzY29wZS50YWJWYWwgPT0gJzInKSB7XHJcbiAgICAgIGRzcC5wb3N0RnVuKCdjdWppYS1tZXNzYWdlL2NqL25vdGlmaWNhdGlvbi9hbGxSZWFkJywge30sIGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coZGF0YSlcclxuICAgICAgICBpZiAoZGF0YS5kYXRhLnN0YXR1c0NvZGUgPT0gMjAwKSB7XHJcbiAgICAgICAgICBnZXRDb3VudCgpXHJcbiAgICAgICAgICBnZXRNZXNzYWdlKClcclxuICAgICAgICAgIC8vICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKClcclxuICAgICAgICB9XHJcbiAgICAgIH0pXHJcbiAgICB9IGVsc2UgaWYgKCRzY29wZS50YWJWYWwgPT0gJzMnKSB7XHJcbiAgICAgIGRzcC5wb3N0RnVuKCdjai9hcHBQdXNoL3VwZGF0ZUFwcFB1c2hJc1JlYWQnLCB7fSwgZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhkYXRhKVxyXG4gICAgICAgIGlmIChkYXRhLmRhdGEuc3RhdHVzQ29kZSA9PSAyMDApIHtcclxuICAgICAgICAgIGdldENvdW50KClcclxuICAgICAgICAgIGdldE1lc3NhZ2UoKVxyXG4gICAgICAgICAgLy8gIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKVxyXG4gICAgICAgIH1cclxuICAgICAgfSlcclxuICAgIH1cclxuICB9XHJcblxyXG4gICRzY29wZS50b0RldGFpbFBhZ2UgPSBmdW5jdGlvbiAoaXRlbSkge1xyXG4gICAgY29uc3QgcGFyYW1zID0ge1xyXG4gICAgICB1c2VySWQ6ICRzY29wZS51c2VySWQsXHJcbiAgICAgIG5vdGljZUlkOiBpdGVtLm5vdGlmaWNhdGlvbmNoSWRcclxuICAgIH1cclxuICAgIGRzcC5wb3N0RnVuKCdtZXNzYWdlQ2VudGVyQ2ovbm90aWZpY2F0aW9uL3VwZGF0ZVJlYWQnLCBwYXJhbXMsICh7IGRhdGEgfSkgPT4ge1xyXG4gICAgICBjb25zdCB7IGNvZGUgfSA9IGRhdGFcclxuICAgICAgaWYgKCtjb2RlID09PSAyMDApIHtcclxuICAgICAgICBnZXRNZXNzYWdlKCk7XHJcbiAgICAgICAgQ0pNc2cgJiYgQ0pNc2cucmVmcmVzaCgpXHJcbiAgICAgIH1cclxuICAgIH0pXHJcbiAgICBpZihpdGVtLnJlZGlyZWN0VHlwZSA9PSAnMicpIHsvLyAw6K+m5oOF6aG1MS7llYblk4HpobUyLuengeacieW6k+WtmOmhtVxyXG4gICAgICBsb2NhdGlvbi5ocmVmID0gJ215Q0ouaHRtbCMvbXktaW52ZW50b3J5J1xyXG4gICAgfSBlbHNlIGlmKGl0ZW0ucmVkaXJlY3RUeXBlID09ICcxJykge1xyXG4gICAgICB3aW5kb3cub3BlbihpdGVtLnVybCArICcmaHJlZicpO1xyXG4gICAgfSBlbHNlIGlmKGl0ZW0ucmVkaXJlY3RUeXBlID09ICcwJykge1xyXG4gICAgICBsb2NhdGlvbi5ocmVmID0gJ215Q0ouaHRtbCMvbWVzc2FnZS1saXN0LycgKyBpdGVtLmlkXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuXHJcbiAgJHNjb3BlLnRvRWxpdGVzID0gZnVuY3Rpb24gKGl0ZW0pIHtcclxuICAgIGxldCBvdGltZSA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xyXG4gICAgY29uc29sZS5sb2coJHNjb3BlLnRva2VuKVxyXG4gICAgZHNwLnBvc3RGdW4oJ2N1amlhLW1lc3NhZ2UvY2ovbm90aWZpY2F0aW9uL2luZm9ybVJlYWQnLCBKU09OLnN0cmluZ2lmeSh7IGlkOiBpdGVtLmlkIH0pLCBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICBpZiAoZGF0YS5kYXRhLnN0YXR1c0NvZGUgPT0gJzIwMCcpIHtcclxuICAgICAgICBnZXRNZXNzYWdlKCk7XHJcbiAgICAgICAgQ0pNc2cgJiYgQ0pNc2cucmVmcmVzaCgpXHJcbiAgICAgIH1cclxuICAgIH0pXHJcbiAgICBjb25zdCB0b2tlbiA9IGJhc2U2NC5kZWNvZGUobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3Rva2VuJykgPT0gdW5kZWZpbmVkID8gXCJcIiA6IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd0b2tlbicpKTtcclxuICAgIGlmIChpdGVtLm9wZXJhdGlvbl90eXBlID09ICcxJykge1xyXG4gICAgICB3aW5kb3cub3BlbihgaHR0cHM6Ly9lbGl0ZXMuY2pkcm9wc2hpcHBpbmcuY29tL2Nyb3NzP3Rva2VuPSR7dG9rZW59Jl90PSR7b3RpbWV9JnVybD0vcGVyc29uYWwtaW5kZXg/aWQ9JHtpdGVtLnVzZXJfaWR9JnBhZ2U9b3RoZXJgKSAgICAgICAgICAgLy/lhbPms6hcclxuICAgIH1cclxuICAgIGlmIChpdGVtLm9wZXJhdGlvbl90eXBlID09ICc0JyB8fCBpdGVtLm9wZXJhdGlvbl90eXBlID09ICc2JyB8fCBpdGVtLm9wZXJhdGlvbl90eXBlID09ICc5JyB8fCBpdGVtLm9wZXJhdGlvbl90eXBlID09ICcxMCcpIHtcclxuICAgICAgd2luZG93Lm9wZW4oYGh0dHBzOi8vZWxpdGVzLmNqZHJvcHNoaXBwaW5nLmNvbS9jcm9zcz90b2tlbj0ke3Rva2VufSZfdD0ke290aW1lfSZ1cmw9L3F1ZXN0aW9uLWRldGFpbD9pZD0ke2l0ZW0uZGV0YWlsX2lkfWApICAgICAgICAgICAvL+mXrumimFxyXG4gICAgfVxyXG4gICAgaWYgKGl0ZW0ub3BlcmF0aW9uX3R5cGUgPT0gJzMnIHx8IGl0ZW0ub3BlcmF0aW9uX3R5cGUgPT0gJzcnKSB7XHJcbiAgICAgIHdpbmRvdy5vcGVuKGBodHRwczovL2VsaXRlcy5jamRyb3BzaGlwcGluZy5jb20vY3Jvc3M/dG9rZW49JHt0b2tlbn0mX3Q9JHtvdGltZX0mdXJsPS9xdWVzdGlvbi1kZXRhaWw/aWQ9JHtpdGVtLnF1ZXN0aW9uX2lkfWApICAgICAgICAgICAvL+mXrumimFxyXG4gICAgfVxyXG4gICAgaWYgKGl0ZW0ub3BlcmF0aW9uX3R5cGUgPT0gJzInIHx8IGl0ZW0ub3BlcmF0aW9uX3R5cGUgPT0gJzUnIHx8IGl0ZW0ub3BlcmF0aW9uX3R5cGUgPT0gJzgnKSB7XHJcbiAgICAgIHdpbmRvdy5vcGVuKGBodHRwczovL2VsaXRlcy5jamRyb3BzaGlwcGluZy5jb20vY3Jvc3M/dG9rZW49JHt0b2tlbn0mX3Q9JHtvdGltZX0mdXJsPS9hcnRpY2xlLWRldGFpbD9pZD0ke2l0ZW0uZGV0YWlsX2lkfWApICAgLy/mlofnq6Dor6bmg4UgICAgICBcclxuICAgIH1cclxuXHJcbiAgfVxyXG5cclxuICAkc2NvcGUudG9Db21tZW50RGV0YWlsID0gZnVuY3Rpb24gKGl0ZW0pIHtcclxuICAgIGNvbnNvbGUubG9nKGl0ZW0pXHJcbiAgICBDSk1zZyAmJiBDSk1zZy5yZWZyZXNoKClcclxuICAgIGxvY2F0aW9uLmhyZWYgPSAnbGlzdC1kZXRhaWwuaHRtbD9pZD0nICsgaXRlbS5wdXNoX2lkICsgJyZmcm9tVHlwZT1Db21tZW50TGlzdCdcclxuICB9XHJcblxyXG4gIC8vIOacgOWQjuS4gOadoeWIoOmZpOaIkOWKn+aXtiwg6aG15pWw5YePMSwg5YaN6K+35rGC5o6l5Y+jXHJcbiAgZnVuY3Rpb24gYmVmb3JlRGVsTGFzdEl0ZW0oKXtcclxuICAgIGlmKCRzY29wZS5tZXNzYWdlTGlzdC5sZW5ndGggPD0gMSAmJiAkc2NvcGUucGFnZU51bSA+IDEpIHtcclxuICAgICAgJHNjb3BlLnBhZ2VOdW0tLVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgJHNjb3BlLmRlbGV0ZU1lcyA9IGZ1bmN0aW9uIChpdGVtLCBpbmRleDEsICRldmVudCkge1xyXG4gICAgJGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgY29uc3QgcGFyYW1zID0ge1xyXG4gICAgICBkZWxldGVJZDogaXRlbS5ub3RpZmljYXRpb25jaElkLFxyXG4gICAgICB1c2VySWQ6ICRzY29wZS51c2VySWRcclxuICAgIH1cclxuICAgIGRzcC5wb3N0RnVuKCdtZXNzYWdlQ2VudGVyQ2ovbm90aWZpY2F0aW9uL2RlbGV0ZU5vdGlmaWNhdGlvbicsIHBhcmFtcywgKHsgZGF0YSB9KSA9PiB7XHJcbiAgICAgIGNvbnN0IHsgY29kZSB9ID0gZGF0YVxyXG4gICAgICBpZiAoK2NvZGUgIT09IDIwMCApIHtcclxuICAgICAgICBsYXllci5tc2coJ0RlbGV0ZSBmYWlsZWQnKTtcclxuICAgICAgICByZXR1cm5cclxuICAgICAgfVxyXG4gICAgICBsYXllci5tc2coJ0RlbGV0ZSBzdWNjZXNzZnVsbHknLCB7IHRpbWU6IDEwMDAgfSk7XHJcbiAgICAgIC8vICR0aW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgLy8gICAkc2NvcGUubWVzc2FnZUxpc3Quc3BsaWNlKGluZGV4MSwgMSk7XHJcbiAgICAgIC8vICAgJCgnLmNqLWxpc3QtdWwgbGknKS5lcShpbmRleDEpLnJlbW92ZSgpO1xyXG4gICAgICAvLyB9LCAxMDAwKTtcclxuXHJcbiAgICAgIGJlZm9yZURlbExhc3RJdGVtKClcclxuICAgICAgZ2V0TWVzc2FnZSgpO1xyXG4gICAgfSlcclxuICB9XHJcbiAgJHNjb3BlLmRlbGV0ZVJlY29tbWVuZCA9IGZ1bmN0aW9uIChpdGVtLCBpbmRleDEsICRldmVudCkge1xyXG4gICAgJGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgY29uc29sZS5sb2coaXRlbSlcclxuICAgIHZhciBkZWxldGVEYXRlID0ge307XHJcbiAgICBkZWxldGVEYXRlLnB1c2hfaWQgPSBpdGVtLnB1c2hfaWQ7XHJcbiAgICBkc3AucG9zdEZ1bignY2ovYXBwUHVzaC9kZWxlY3RBcHBQdXNoQnlJZCcsIEpTT04uc3RyaW5naWZ5KGRlbGV0ZURhdGUpLCBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICB2YXIgZGF0YSA9IGRhdGEuZGF0YTtcclxuICAgICAgY29uc29sZS5sb2coZGF0YSk7XHJcbiAgICAgIGlmIChkYXRhLnN0YXR1c0NvZGUgIT0gMjAwKSB7XHJcbiAgICAgICAgbGF5ZXIubXNnKCdEZWxldGUgZmFpbGVkJyk7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICB9XHJcbiAgICAgIGxheWVyLm1zZygnRGVsZXRlIHN1Y2Nlc3NmdWxseScsIHsgdGltZTogMTAwMCB9KTtcclxuICAgICAgLy8gJHRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAvLyAgICRzY29wZS5tZXNzYWdlTGlzdC5zcGxpY2UoaW5kZXgxLCAxKTtcclxuICAgICAgLy8gICAkKCcuY2otbGlzdC11bCBsaScpLmVxKGluZGV4MSkucmVtb3ZlKCk7XHJcbiAgICAgIC8vIH0sIDEwMDApO1xyXG4gICAgICBkZWxnZXRSZWNvbmVkKGRzcCwgJHJvb3RTY29wZSk7XHJcbiAgICAgIGJlZm9yZURlbExhc3RJdGVtKClcclxuICAgICAgZ2V0TWVzc2FnZSgpO1xyXG4gICAgfSwgZXJyKTtcclxuICB9XHJcbiAgJHNjb3BlLnRvdGFsUGFnZSA9ICcnXHJcbiAgZnVuY3Rpb24gZ2V0TWVzc2FnZSgpIHtcclxuICAgIGlmICgkc2NvcGUudGFiVmFsID09ICcxJykge1xyXG4gICAgICAkc2NvcGUubWVzc2FnZUxpc3QgPSBbXVxyXG4gICAgICBnZXRNZXNzYWdlQ0ooKVxyXG4gICAgfSBlbHNlIGlmICgkc2NvcGUudGFiVmFsID09ICcyJykge1xyXG4gICAgICAkc2NvcGUubWVzc2FnZUxpc3QgPSBbXVxyXG4gICAgICBnZXRNZXNzYWdlRWxpdGVzKClcclxuICAgIH0gZWxzZSBpZiAoJHNjb3BlLnRhYlZhbCA9PSAnMycpIHtcclxuICAgICAgJHNjb3BlLm1lc3NhZ2VMaXN0ID0gW11cclxuICAgICAgZ2V0Q29tbWVudExpc3QoKVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgZ2V0TWVzc2FnZSgpO1xyXG4gIGZ1bmN0aW9uIGdldE1lc3NhZ2VDSihpc0Z5KSB7XHJcbiAgICAkc2NvcGUubm9kYXRhID0gZmFsc2U7XHJcbiAgICBjb25zdCBnZXRUb3BNZXNEYXRhID0ge1xyXG4gICAgICBwYWdlU2l6ZTogJHNjb3BlLnBhZ2VTaXplICogMSxcclxuICAgICAgcGFnZU51bTogJHNjb3BlLnBhZ2VOdW0gKiAxLFxyXG4gICAgICBkYXRhOiB7XHJcbiAgICAgICAgdXNlcklkOiAkc2NvcGUudXNlcklkXHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIC8vIGRzcC5wb3N0RnVuKCdtZXNzYWdlQ2VudGVyQ2ovbm90aWZpY2F0aW9uL3F1ZXJ5R2V0Q2pub3RpZmljYXRpb24nLCBnZXRUb3BNZXNEYXRhLCAoeyBkYXRhIH0pID0+IHtcclxuICAgIGRzcC5wb3N0RnVuKCdtZXNzYWdlQ2VudGVyQ2ovbm90aWZpY2F0aW9uL3F1ZXJ5Tm90aWZpY2F0aW9uTGlzdCcsIGdldFRvcE1lc0RhdGEsICh7IGRhdGEgfSkgPT4ge1xyXG4gICAgICBjb25zdCB7IGNvZGUsIGRhdGE6IHJlc3VsdCA9IHt9IH0gPSBkYXRhXHJcbiAgICAgIGxheWVyLmNsb3NlQWxsKCdsb2FkaW5nJyk7XHJcbiAgICAgIGlmICgrY29kZSAhPT0gMjAwKSB7XHJcbiAgICAgICAgJHNjb3BlLm5vZGF0YSA9IHRydWU7XHJcbiAgICAgICAgcmV0dXJuIDtcclxuICAgICAgfTtcclxuXHJcbiAgICAgIGNvbnN0IHsgbGlzdCwgdG90YWwgfSA9IHJlc3VsdFxyXG4gICAgICAkc2NvcGUubWVzc2FnZUxpc3QgPSBsaXN0Lm1hcCh2ID0+IHtcclxuICAgICAgICBjb25zdCBpbmQgPSB2Lm5vdGlmaWNhdGlvblR5cGUuaW5kZXhPZignaHRtbDonKVxyXG4gICAgICAgIGlmICggaW5kID4gLTEpIHtcclxuICAgICAgICAgIHYudXJsID0gdi5ub3RpZmljYXRpb25UeXBlLnNsaWNlKGluZCArIDUpO1xyXG4gICAgICAgICAgdi5ub3RpZmljYXRpb25UeXBlID0gdi5ub3RpZmljYXRpb25UeXBlLnNsaWNlKDAsIGluZClcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHZcclxuICAgICAgfSlcclxuICAgICAgaWYoJHNjb3BlLm1lc3NhZ2VMaXN0Lmxlbmd0aCA9PSAwKSB7XHJcbiAgICAgICAgJHNjb3BlLm5vZGF0YSA9IHRydWU7XHJcbiAgICAgIH1cclxuICAgICAgJHNjb3BlLnRvdGFsUGFnZSA9ICt0b3RhbFxyXG4gICAgICAhaXNGeSAmJiAkKFwiI2xkLXBhZ2VzXCIpLmpxUGFnaW5hdG9yKHtcclxuICAgICAgICAvLyB0b3RhbFBhZ2VzOiAyMCwvL+WIhumhteeahOaAu+mhteaVsFxyXG4gICAgICAgIHRvdGFsQ291bnRzOiAkc2NvcGUudG90YWxQYWdlLFxyXG4gICAgICAgIHBhZ2VTaXplOiAkc2NvcGUucGFnZVNpemUsXHJcbiAgICAgICAgdmlzaWJsZVBhZ2VzOiA1LC8v5pi+56S65aSa5bCR6aG1XHJcbiAgICAgICAgY3VycmVudFBhZ2U6ICRzY29wZS5wYWdlTnVtLC8v5b2T6ZKx56ys5Yeg6aG1XHJcbiAgICAgICAgYWN0aXZlQ2xhc3M6ICRzY29wZS52aXAgPT0gJzEnID8gJ3BhZ2VBY3RpdmVWaXAnIDogJ2FjdGl2ZScsXHJcbiAgICAgICAgcHJldjogJzxhIGNsYXNzPVwicHJldlwiIGhyZWY9XCJqYXZhc2NyaXB0OnZvaWQoMCk7XCI+Jmx0OzxcXC9hPicsXHJcbiAgICAgICAgbmV4dDogJzxhIGNsYXNzPVwibmV4dFwiIGhyZWY9XCJqYXZhc2NyaXB0OnZvaWQoMCk7XCI+Jmd0OzxcXC9hPicsXHJcbiAgICAgICAgcGFnZTogJzxhIGhyZWY9XCJqYXZhc2NyaXB0OnZvaWQoMCk7XCI+e3twYWdlfX08XFwvYT4nLFxyXG4gICAgICAgIGZpcnN0OiAnPGEgY2xhc3M9XCJwcmV2XCIgaHJlZj1cImphdmFzY3JpcHQ6dm9pZCgwKTtcIj4mbHQmbHQ7PFxcL2E+JyxcclxuICAgICAgICBsYXN0OiAnPGEgY2xhc3M9XCJwcmV2XCIgaHJlZj1cImphdmFzY3JpcHQ6dm9pZCgwKTtcIj4mZ3QmZ3Q7PFxcL2E+JyxcclxuICAgICAgICBvblBhZ2VDaGFuZ2U6IGZ1bmN0aW9uIChuLCB0eXBlKSB7XHJcbiAgICAgICAgICBpZiAodHlwZSA9PSAnaW5pdCcpIHJldHVybjtcclxuICAgICAgICAgICRzY29wZS5wYWdlTnVtID0gbjtcclxuICAgICAgICAgIGdldE1lc3NhZ2VDSih0cnVlKVxyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9KVxyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gZ2V0TWVzc2FnZUVsaXRlcygpIHtcclxuICAgICRzY29wZS5ub2RhdGEgPSBmYWxzZTtcclxuICAgIGNvbnN0IGdldFRvcE1lc0RhdGEgPSB7XHJcbiAgICAgIHBhZ2VTaXplOiAkc2NvcGUucGFnZVNpemUgKyAnJyxcclxuICAgICAgcGFnZU51bTogJHNjb3BlLnBhZ2VOdW0gKyAnJ1xyXG4gICAgfVxyXG4gICAgZHNwLnBvc3RGdW4oXCJjdWppYS1tZXNzYWdlL2NqL25vdGlmaWNhdGlvbi9nZXRJbmZvcm1MaXN0XCIsIGdldFRvcE1lc0RhdGEsIGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgIGxheWVyLmNsb3NlQWxsKCdsb2FkaW5nJyk7XHJcbiAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xyXG4gICAgICB2YXIgZGF0YSA9IGRhdGEuZGF0YTtcclxuICAgICAgdmFyIHJlc3VsdCA9IGRhdGEucmVzdWx0O1xyXG4gICAgICBpZiAocmVzdWx0LnRvdGFsID09IDApIHtcclxuICAgICAgICAkc2NvcGUubWVzc2FnZUxpc3QgPSBbXTtcclxuICAgICAgICAkc2NvcGUubm9kYXRhID0gdHJ1ZTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgICAgJHNjb3BlLm1lc3NhZ2VMaXN0ID0gcmVzdWx0Lmxpc3Q7XHJcblxyXG4gICAgICAkKFwiI2xkLXBhZ2VzXCIpLmpxUGFnaW5hdG9yKHtcclxuICAgICAgICAvLyB0b3RhbFBhZ2VzOiAyMCwvL+WIhumhteeahOaAu+mhteaVsFxyXG4gICAgICAgIHRvdGFsQ291bnRzOiByZXN1bHQudG90YWwsXHJcbiAgICAgICAgcGFnZVNpemU6ICRzY29wZS5wYWdlU2l6ZSxcclxuICAgICAgICB2aXNpYmxlUGFnZXM6IDUsLy/mmL7npLrlpJrlsJHpobVcclxuICAgICAgICBjdXJyZW50UGFnZTogJHNjb3BlLnBhZ2VOdW0sLy/lvZPpkrHnrKzlh6DpobVcclxuICAgICAgICBhY3RpdmVDbGFzczogJHNjb3BlLnZpcCA9PSAnMScgPyAncGFnZUFjdGl2ZVZpcCcgOiAnYWN0aXZlJyxcclxuICAgICAgICBwcmV2OiAnPGEgY2xhc3M9XCJwcmV2XCIgaHJlZj1cImphdmFzY3JpcHQ6dm9pZCgwKTtcIj4mbHQ7PFxcL2E+JyxcclxuICAgICAgICBuZXh0OiAnPGEgY2xhc3M9XCJuZXh0XCIgaHJlZj1cImphdmFzY3JpcHQ6dm9pZCgwKTtcIj4mZ3Q7PFxcL2E+JyxcclxuICAgICAgICBwYWdlOiAnPGEgaHJlZj1cImphdmFzY3JpcHQ6dm9pZCgwKTtcIj57e3BhZ2V9fTxcXC9hPicsXHJcbiAgICAgICAgZmlyc3Q6ICc8YSBjbGFzcz1cInByZXZcIiBocmVmPVwiamF2YXNjcmlwdDp2b2lkKDApO1wiPiZsdCZsdDs8XFwvYT4nLFxyXG4gICAgICAgIGxhc3Q6ICc8YSBjbGFzcz1cInByZXZcIiBocmVmPVwiamF2YXNjcmlwdDp2b2lkKDApO1wiPiZndCZndDs8XFwvYT4nLFxyXG4gICAgICAgIG9uUGFnZUNoYW5nZTogZnVuY3Rpb24gKG4sIHR5cGUpIHtcclxuICAgICAgICAgIGlmICh0eXBlID09ICdpbml0JykgcmV0dXJuO1xyXG4gICAgICAgICAgJHNjb3BlLnBhZ2VOdW0gPSBuO1xyXG4gICAgICAgICAgdmFyIGdldE1lc0xpc3REYXRhID0ge1xyXG4gICAgICAgICAgICBwYWdlU2l6ZTogJHNjb3BlLnBhZ2VTaXplICsgJycsXHJcbiAgICAgICAgICAgIHBhZ2VOdW06ICRzY29wZS5wYWdlTnVtICsgJydcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGRzcC5wb3N0RnVuKCdjdWppYS1tZXNzYWdlL2NqL25vdGlmaWNhdGlvbi9nZXRJbmZvcm1MaXN0JywgSlNPTi5zdHJpbmdpZnkoZ2V0TWVzTGlzdERhdGEpLCBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICBsYXllci5jbG9zZUFsbCgnbG9hZGluZycpO1xyXG4gICAgICAgICAgICB2YXIgZGF0YSA9IGRhdGEuZGF0YTtcclxuICAgICAgICAgICAgaWYgKGRhdGEuc3RhdHVzQ29kZSA9PSAyMDApIHtcclxuICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gZGF0YS5yZXN1bHQ7XHJcbiAgICAgICAgICAgICAgJHNjb3BlLm1lc3NhZ2VMaXN0ID0gcmVzdWx0Lmxpc3Q7XHJcbiAgICAgICAgICAgICAgaWYgKHJlc3VsdC50b3RhbCA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUubWVzc2FnZUxpc3QgPSBbXTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5ub2RhdGEgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIH0sIGVycilcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfSwgZXJyKTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGdldENvbW1lbnRMaXN0KCkge1xyXG4gICAgJHNjb3BlLm5vZGF0YSA9IGZhbHNlO1xyXG4gICAgZHNwLnBvc3RGdW4oJ2NqL2FwcFB1c2gvZ2V0Q0pQdXNoSW5mb0xpc3RCeVVzZXJJZCcsIHsgcGFnZVNpemU6ICRzY29wZS5wYWdlU2l6ZSwgcGFnZU51bTogJHNjb3BlLnBhZ2VOdW0gfSwgZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgbGF5ZXIuY2xvc2VBbGwoJ2xvYWRpbmcnKTtcclxuICAgICAgY29uc29sZS5sb2coZGF0YSk7XHJcbiAgICAgIHZhciBkYXRhID0gZGF0YS5kYXRhO1xyXG4gICAgICB2YXIgcmVzdWx0ID0gZGF0YS5yZXN1bHQ7XHJcbiAgICAgIGNvbnNvbGUubG9nKHJlc3VsdCk7XHJcbiAgICAgIGlmIChyZXN1bHQuY291bnQgPT0gMCB8fCByZXN1bHQudG90YWwgPT0gMCkge1xyXG4gICAgICAgICRzY29wZS5tZXNzYWdlTGlzdCA9IFtdO1xyXG4gICAgICAgICRzY29wZS5ub2RhdGEgPSB0cnVlO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICBsZXQgaXNSZWFkQXJyID0gW11cclxuICAgICAgY29uc3QgbGlzdCA9IHJlc3VsdC5saXN0IHx8IFtdXHJcbiAgICAgICRzY29wZS5tZXNzYWdlTGlzdCA9IGxpc3QubWFwKF8gPT4ge1xyXG4gICAgICAgIGNvbnN0IGFyciA9IF8ucGljdXJsLnNwbGl0KCcsJylcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgLi4uXywgXHJcbiAgICAgICAgICBpbWdfdXJsX29uZTogYXJyLmxlbmd0aCA+IDAgPyBhcnJbMF0gOiBfLnBpY3VybCBcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgICAkc2NvcGUubWVzc2FnZUxpc3QgJiYgJHNjb3BlLm1lc3NhZ2VMaXN0LmZvckVhY2goY29uID0+IHtcclxuICAgICAgICBjb24uY3JlYXRlX3RpbWUgPSBjb24uY3JlYXRlX3RpbWUuc3BsaXQoJy4nKVswXVxyXG4gICAgICB9KVxyXG4gICAgICAkc2NvcGUudG90YWxQYWdlID0gcmVzdWx0LnRvdGFsXHJcblxyXG5cclxuICAgICAgJChcIiNsZC1wYWdlc1wiKS5qcVBhZ2luYXRvcih7XHJcbiAgICAgICAgLy8gdG90YWxQYWdlczogMjAsLy/liIbpobXnmoTmgLvpobXmlbBcclxuICAgICAgICB0b3RhbENvdW50czogcmVzdWx0LmNvdW50ID8gcmVzdWx0LmNvdW50IDogcmVzdWx0LnRvdGFsLFxyXG4gICAgICAgIHBhZ2VTaXplOiAkc2NvcGUucGFnZVNpemUsXHJcbiAgICAgICAgdmlzaWJsZVBhZ2VzOiA1LC8v5pi+56S65aSa5bCR6aG1XHJcbiAgICAgICAgY3VycmVudFBhZ2U6ICRzY29wZS5wYWdlTnVtLC8v5b2T6ZKx56ys5Yeg6aG1XHJcbiAgICAgICAgYWN0aXZlQ2xhc3M6ICRzY29wZS52aXAgPT0gJzEnID8gJ3BhZ2VBY3RpdmVWaXAnIDogJ2FjdGl2ZScsXHJcbiAgICAgICAgcHJldjogJzxhIGNsYXNzPVwicHJldlwiIGhyZWY9XCJqYXZhc2NyaXB0OnZvaWQoMCk7XCI+Jmx0OzxcXC9hPicsXHJcbiAgICAgICAgbmV4dDogJzxhIGNsYXNzPVwibmV4dFwiIGhyZWY9XCJqYXZhc2NyaXB0OnZvaWQoMCk7XCI+Jmd0OzxcXC9hPicsXHJcbiAgICAgICAgcGFnZTogJzxhIGhyZWY9XCJqYXZhc2NyaXB0OnZvaWQoMCk7XCI+e3twYWdlfX08XFwvYT4nLFxyXG4gICAgICAgIGZpcnN0OiAnPGEgY2xhc3M9XCJwcmV2XCIgaHJlZj1cImphdmFzY3JpcHQ6dm9pZCgwKTtcIj4mbHQmbHQ7PFxcL2E+JyxcclxuICAgICAgICBsYXN0OiAnPGEgY2xhc3M9XCJwcmV2XCIgaHJlZj1cImphdmFzY3JpcHQ6dm9pZCgwKTtcIj4mZ3QmZ3Q7PFxcL2E+JyxcclxuICAgICAgICBvblBhZ2VDaGFuZ2U6IGZ1bmN0aW9uIChuLCB0eXBlKSB7XHJcbiAgICAgICAgICBpZiAodHlwZSA9PSAnaW5pdCcpIHJldHVybjtcclxuICAgICAgICAgICRzY29wZS5wYWdlTnVtID0gbjtcclxuXHJcbiAgICAgICAgICB2YXIgZ2V0TWVzTGlzdERhdGEgPSB7XHJcbiAgICAgICAgICAgIHBhZ2VTaXplOiAkc2NvcGUucGFnZVNpemUsXHJcbiAgICAgICAgICAgIGlzcmVhZDogJycsXHJcbiAgICAgICAgICAgIHN0YXJ0OiAkc2NvcGUucGFnZU51bVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgZHNwLnBvc3RGdW4oJ2NqL2FwcFB1c2gvZ2V0Q0pQdXNoSW5mb0xpc3RCeVVzZXJJZCcsIHsgcGFnZVNpemU6ICRzY29wZS5wYWdlU2l6ZSwgcGFnZU51bTogJHNjb3BlLnBhZ2VOdW0gfSwgZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgbGF5ZXIuY2xvc2VBbGwoJ2xvYWRpbmcnKTtcclxuICAgICAgICAgICAgdmFyIGRhdGEgPSBkYXRhLmRhdGE7XHJcbiAgICAgICAgICAgIGlmIChkYXRhLnN0YXR1c0NvZGUgPT0gMjAwKSB7XHJcbiAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IGRhdGEucmVzdWx0O1xyXG4gICAgICAgICAgICAgIGNvbnN0IGxpc3QgPSByZXN1bHQubGlzdCB8fCBbXVxyXG5cclxuICAgICAgICAgICAgICAkc2NvcGUubWVzc2FnZUxpc3QgPSBsaXN0Lm1hcChfID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGFyciA9IF8ucGljdXJsLnNwbGl0KCcsJylcclxuICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgIC4uLl8sIFxyXG4gICAgICAgICAgICAgICAgICBpbWdfdXJsX29uZTogYXJyLmxlbmd0aCA+IDAgPyBhcnJbMF0gOiBfLnBpY3VybCBcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICBpZiAocmVzdWx0LmNvdW50ID09IDAgfHwgcmVzdWx0LnRvdGFsID09IDApIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5tZXNzYWdlTGlzdCA9IFtdO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLm5vZGF0YSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIC8vICRzY29wZS5tZXNzYWdlTGlzdCA9IHJlc3VsdC5saXN0O1xyXG4gICAgICAgICAgICAgICRzY29wZS5tZXNzYWdlTGlzdCAmJiAkc2NvcGUubWVzc2FnZUxpc3QuZm9yRWFjaChjb24gPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uLmNyZWF0ZV90aW1lID0gY29uLmNyZWF0ZV90aW1lLnNwbGl0KCcuJylbMF1cclxuICAgICAgICAgICAgICB9KVxyXG5cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIH0sIGVycilcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfSwgZXJyKTtcclxuICB9XHJcblxyXG4gIC8v6I635Y+W5L+h5oGv5pWw6YePXHJcbiAgZnVuY3Rpb24gZ2V0Q291bnQoKSB7XHJcbiAgICBkc3AucG9zdEZ1bignY3VqaWEtbWVzc2FnZS9jai9ub3RpZmljYXRpb24vc2VsZWN0SXNOb3RSZWFkJywgeyBpc3JlYWQ6IDAgfSwgZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgaWYgKGRhdGEuZGF0YS5zdGF0dXNDb2RlID09IDIwMCkge1xyXG4gICAgICAgIHJlc3VsdCA9IGRhdGEuZGF0YS5yZXN1bHRcclxuICAgICAgICAkc2NvcGUubWVzc2FnZU51bSA9IHJlc3VsdC5jb3VudCAqIDE7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAkc2NvcGUubWVzc2FnZVRhYi5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgJHNjb3BlLm1lc3NhZ2VUYWJbMF0uY291bnQgPSByZXN1bHQuY2pDb3VudCAqIDFcclxuICAgICAgICAgICRzY29wZS5tZXNzYWdlVGFiWzFdLmNvdW50ID0gcmVzdWx0LmVsaXRlc0NvdW50ICogMTtcclxuICAgICAgICAgICRzY29wZS5tZXNzYWdlVGFiWzJdLmNvdW50ID0gcmVzdWx0LnB1c2hDb3VudCAqIDFcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0pXHJcbiAgfVxyXG4gIGlmICgkc2NvcGUuaGFzTG9naW4pIHtcclxuICAgIGdldENvdW50KClcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGVycihlcnIpIHtcclxuICAgIGxheWVyLmNsb3NlQWxsKCdsb2FkaW5nJyk7XHJcbiAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gZGVsZ2V0UmVjb25lZChkc3AsICRyb290U2NvcGUpIHtcclxuICAgIHZhciBnZXRUb3BNZXNEYXRhID0ge1xyXG4gICAgICBcInBhZ2VOdW1cIjogXCIxXCIsXHJcbiAgICAgIFwicGFnZVNpemVcIjogXCI1XCJcclxuICAgIH1cclxuICAgIGRzcC5wb3N0RnVuKCdjai9hcHBQdXNoL2dldENKUHVzaEluZm9MaXN0QnlVc2VySWQnLCBnZXRUb3BNZXNEYXRhLCBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICBjb25zb2xlLmxvZyhkYXRhLmRhdGEpXHJcbiAgICAgIHZhciBkYXRhID0gZGF0YS5kYXRhO1xyXG4gICAgICBpZiAoZGF0YS5zdGF0dXNDb2RlID09IDIwMCkge1xyXG4gICAgICAgIHZhciByZXN1bHQgPSBkYXRhLnJlc3VsdDtcclxuICAgICAgICBjb25zb2xlLmxvZyhyZXN1bHQpXHJcbiAgICAgICAgJHNjb3BlLm1lc3NhZ2VQcmUgPSByZXN1bHQubGlzdDtcclxuICAgICAgICBsZXQgaXNSZWFkQXJyID0gW11cclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8ICRzY29wZS5tZXNzYWdlUHJlLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICBpc1JlYWRBcnIucHVzaCgkc2NvcGUubWVzc2FnZVByZVtpXS5pc19yZWFkKVxyXG4gICAgICAgICAgaWYgKGlzUmVhZEFyci5pbmNsdWRlcygyKSkge1xyXG4gICAgICAgICAgICAkc2NvcGUuaXNNYXJrID0gZmFsc2VcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBSEE7QUFDQTtBQU9BO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBTkE7QUFBQTtBQVNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFoQkE7QUFrQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQWpDQTtBQW1DQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUZBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBS0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUZBO0FBSUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBaERBO0FBa0RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///../src/pages/mycj/system-message/msg-all.js\n");

/***/ }),

/***/ "../src/pages/mycj/system-message/msg-list.js":
/*!****************************************************!*\
  !*** ../src/pages/mycj/system-message/msg-list.js ***!
  \****************************************************/
/*! exports provided: messageListCtrl */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"messageListCtrl\", function() { return messageListCtrl; });\nfunction messageListCtrl($rootScope, $scope, dsp, $stateParams, $timeout, $location, $sce) {\n  var base64 = $rootScope.base64;\n  $scope.userId = base64.decode(localStorage.getItem('userId') == undefined ? \"\" : localStorage.getItem('userId'));\n  var noticeid = $stateParams.mid;\n  $('.cj-am-wrap').css('min-height', $(window).height() - 171 + 'px'); //标记为已读\n\n  function setIsRead(noticeId) {\n    var params = {\n      userId: $scope.userId,\n      noticeId: noticeId\n    };\n    dsp.postFun('messageCenterCj/notification/updateRead', params, function (_ref) {\n      var data = _ref.data;\n      var code = data.code;\n\n      if (+code === 200) {\n        CJMsg && CJMsg.refresh();\n      }\n    });\n  } //获取通知i详情\n\n\n  function getNoticeInfo() {\n    var params = {\n      userId: $scope.userId,\n      id: noticeid\n    };\n    dsp.postFun('messageCenterCj/notification/queryDetails', params, function (_ref2) {\n      var data = _ref2.data;\n      var code = data.code,\n          _data$data = data.data,\n          result = _data$data === void 0 ? {} : _data$data;\n      if (+code !== 200) return;\n      var _result$notification = result.notification,\n          html = _result$notification.html,\n          sendDate = _result$notification.sendDate,\n          notificationType = _result$notification.notificationType,\n          notificationchId = _result$notification.notificationchId,\n          info = _result$notification.info;\n      $scope.mestitle = notificationType;\n      $scope.mesInfo = info;\n      $scope.mestime = sendDate;\n      $scope.mesdetail = $sce.trustAsHtml(html);\n      $scope.noticeId = notificationchId;\n      setIsRead(notificationchId);\n      $rootScope.$emit('updateNotReadMsg', {\n        updateNotReadMsg: true\n      });\n    });\n  } //删除\n\n\n  $scope.deleteMes = function () {\n    var params = {\n      deleteId: $scope.noticeId,\n      userId: $scope.userId\n    };\n    dsp.postFun('messageCenterCj/notification/deleteNotification', params, function (_ref3) {\n      var data = _ref3.data;\n      var code = data.code;\n\n      if (+code !== 200) {\n        layer.msg('Delete failed');\n        return;\n      }\n\n      layer.msg('Delete successfully', {\n        time: 1000\n      });\n      $timeout(function () {\n        $location.path('/all-message/1');\n      }, 1000);\n    });\n  }; // setIsRead()\n\n\n  getNoticeInfo();\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi4vc3JjL3BhZ2VzL215Y2ovc3lzdGVtLW1lc3NhZ2UvbXNnLWxpc3QuanMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi4vc3JjL3BhZ2VzL215Y2ovc3lzdGVtLW1lc3NhZ2UvbXNnLWxpc3QuanM/NDYxYiJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZnVuY3Rpb24gbWVzc2FnZUxpc3RDdHJsKCRyb290U2NvcGUsICRzY29wZSwgZHNwLCAkc3RhdGVQYXJhbXMsICR0aW1lb3V0LCAkbG9jYXRpb24sICRzY2UpIHtcclxuICBjb25zdCBiYXNlNjQgPSAkcm9vdFNjb3BlLmJhc2U2NDtcclxuICAkc2NvcGUudXNlcklkID0gYmFzZTY0LmRlY29kZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndXNlcklkJykgPT0gdW5kZWZpbmVkID8gXCJcIiA6IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd1c2VySWQnKSk7XHJcbiAgY29uc3Qgbm90aWNlaWQgPSAkc3RhdGVQYXJhbXMubWlkXHJcblxyXG4gICQoJy5jai1hbS13cmFwJykuY3NzKCdtaW4taGVpZ2h0JywgKCQod2luZG93KS5oZWlnaHQoKSAtIDE3MSkgKyAncHgnKTtcclxuXHJcblxyXG4gIC8v5qCH6K6w5Li65bey6K+7XHJcbiAgZnVuY3Rpb24gc2V0SXNSZWFkKG5vdGljZUlkKSB7XHJcbiAgICBjb25zdCBwYXJhbXMgPSB7XHJcbiAgICAgIHVzZXJJZDogJHNjb3BlLnVzZXJJZCxcclxuICAgICAgbm90aWNlSWRcclxuICAgIH1cclxuICAgIGRzcC5wb3N0RnVuKCdtZXNzYWdlQ2VudGVyQ2ovbm90aWZpY2F0aW9uL3VwZGF0ZVJlYWQnLCBwYXJhbXMsICh7IGRhdGEgfSkgPT4geyBcclxuICAgICAgY29uc3QgeyBjb2RlIH0gPSBkYXRhXHJcbiAgICAgIGlmICgrY29kZSA9PT0gMjAwKSB7XHJcbiAgICAgICAgQ0pNc2cgJiYgQ0pNc2cucmVmcmVzaCgpXHJcbiAgICAgIH1cclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICAvL+iOt+WPlumAmuefpWnor6bmg4VcclxuICBmdW5jdGlvbiBnZXROb3RpY2VJbmZvKCkge1xyXG4gICAgY29uc3QgcGFyYW1zID0ge1xyXG4gICAgICB1c2VySWQ6ICRzY29wZS51c2VySWQsXHJcbiAgICAgIGlkOiBub3RpY2VpZFxyXG4gICAgfVxyXG4gICAgZHNwLnBvc3RGdW4oJ21lc3NhZ2VDZW50ZXJDai9ub3RpZmljYXRpb24vcXVlcnlEZXRhaWxzJywgcGFyYW1zLCAoeyBkYXRhIH0pID0+IHtcclxuICAgICAgY29uc3QgeyBjb2RlLCBkYXRhOiByZXN1bHQgPSB7fSB9ID0gZGF0YVxyXG4gICAgICBpZiAoK2NvZGUgIT09IDIwMCkgcmV0dXJuO1xyXG4gICAgICBjb25zdCB7IG5vdGlmaWNhdGlvbjogeyBodG1sLCBzZW5kRGF0ZSwgbm90aWZpY2F0aW9uVHlwZSwgbm90aWZpY2F0aW9uY2hJZCwgaW5mb30gfSA9IHJlc3VsdFxyXG4gICAgICAkc2NvcGUubWVzdGl0bGUgPSBub3RpZmljYXRpb25UeXBlXHJcbiAgICAgICRzY29wZS5tZXNJbmZvID0gaW5mbztcclxuICAgICAgJHNjb3BlLm1lc3RpbWUgPSBzZW5kRGF0ZVxyXG4gICAgICAkc2NvcGUubWVzZGV0YWlsID0gJHNjZS50cnVzdEFzSHRtbChodG1sKVxyXG4gICAgICAkc2NvcGUubm90aWNlSWQgPSBub3RpZmljYXRpb25jaElkXHJcbiAgICAgIHNldElzUmVhZChub3RpZmljYXRpb25jaElkKVxyXG4gICAgICAkcm9vdFNjb3BlLiRlbWl0KCd1cGRhdGVOb3RSZWFkTXNnJywge3VwZGF0ZU5vdFJlYWRNc2c6IHRydWV9KVxyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIC8v5Yig6ZmkXHJcbiAgJHNjb3BlLmRlbGV0ZU1lcyA9ICgpID0+IHtcclxuICAgIGNvbnN0IHBhcmFtcyA9IHtcclxuICAgICAgZGVsZXRlSWQ6ICRzY29wZS5ub3RpY2VJZCxcclxuICAgICAgdXNlcklkOiAkc2NvcGUudXNlcklkXHJcbiAgICB9XHJcbiAgICBkc3AucG9zdEZ1bignbWVzc2FnZUNlbnRlckNqL25vdGlmaWNhdGlvbi9kZWxldGVOb3RpZmljYXRpb24nLCBwYXJhbXMsICh7IGRhdGEgfSkgPT4ge1xyXG4gICAgICBjb25zdCB7IGNvZGUgfSA9IGRhdGFcclxuICAgICAgaWYgKCtjb2RlICE9PSAyMDApIHtcclxuICAgICAgICBsYXllci5tc2coJ0RlbGV0ZSBmYWlsZWQnKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgICAgbGF5ZXIubXNnKCdEZWxldGUgc3VjY2Vzc2Z1bGx5JywgeyB0aW1lOiAxMDAwIH0pO1xyXG4gICAgICAkdGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy9hbGwtbWVzc2FnZS8xJyk7XHJcbiAgICAgIH0sIDEwMDApO1xyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIC8vIHNldElzUmVhZCgpXHJcbiAgZ2V0Tm90aWNlSW5mbygpXHJcblxyXG59Il0sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBRkE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///../src/pages/mycj/system-message/msg-list.js\n");

/***/ })

}]);