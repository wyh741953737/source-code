(window["webpackJsonp"] = window["webpackJsonp"] || []).push([[8],{

/***/ "../src/pages/mycj/connection/connection.js":
/*!**************************************************!*\
  !*** ../src/pages/mycj/connection/connection.js ***!
  \**************************************************/
/*! exports provided: connectionFactory */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"connectionFactory\", function() { return connectionFactory; });\n/* harmony import */ var _src_pages_mycj_mycj_common__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @src/pages/mycj/mycj-common */ \"../src/pages/mycj/mycj-common.js\");\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n\nfunction connectionFactory(angular) {\n  var app = angular.module('connection.module', []);\n  app.controller('connection.ctrl', ['$rootScope', '$scope', '$timeout', '$stateParams', 'dsp', '$state', function ($rootScope, $scope, $timeout, $stateParams, dsp, $state) {\n    $rootScope.$on('app/connection/conList', function (_, bool) {\n      $scope.loading = bool;\n      if (bool) $scope.notDataFound = false;\n    });\n    dsp.domainData().then(function (res) {\n      // 请求成功的结果\n      console.log(res);\n      $scope.iscj = res.iscj;\n      $scope.affModel = res.affModel;\n\n      if ($scope.iscj == '1') {\n        //cj\n        $scope.websiteName = 'CJ';\n      } else {\n        //客户\n        $scope.websiteName = res.websiteName || 'CJ';\n      }\n    });\n    var vip = localStorage.getItem('vip') == undefined ? \"\" : localStorage.getItem('vip');\n\n    if (vip == '1') {\n      //vipFlag\n      $('.header-nav').addClass('vipFlag');\n      $('.mycj-right-wrap').css('background', '#F0EDE7').addClass('vip');\n    } else {\n      $('.header-nav').removeClass('vipFlag');\n      $('.mycj-right-wrap').css('background', '#f2f3f5').removeClass('vip');\n    }\n\n    $('.header-nav li').eq(2).addClass('active');\n\n    $scope.afterGetLeftNav = function () {\n      if (vip == '1') {\n        $('.mycj-left-bar').addClass('vipFlag');\n      } else {\n        $('.mycj-left-bar').removeClass('vipFlag');\n      }\n\n      $('.mycj-left-bar li').eq(0).addClass('active');\n    };\n\n    dsp.setRightMinHeight();\n    console.log(\"productsConnectedCtrl\");\n    var base64 = new Base64();\n    var userId = base64.decode(localStorage.getItem('userId') == undefined ? \"\" : localStorage.getItem('userId'));\n    console.log(userId);\n\n    try {\n      var seachCs = decodeURI($stateParams.seachCs || '');\n    } catch (e) {\n      console.log(e);\n    }\n\n    $scope.content = 'Are you sure to remove the packaging?';\n    $scope.showPopUps = false;\n    console.log(seachCs);\n    $rootScope.$on('app/shop/getshop', function (_, bool) {\n      return $scope.loading_shop = bool;\n    });\n    dsp.postFun('app/shop/getshop', {\n      \"data\": \"{'userId':'\" + userId + \"'}\"\n    }, getshop);\n\n    function getshop(n) {\n      var obj = JSON.parse(n.data.result); // console.log('下拉', obj.shoplist)\n\n      $scope.shopselectlist = obj.shoplist;\n      $scope.shopselectlist.forEach(function (e) {\n        e.rNAME = \"\".concat(e.NAME, \" - \").concat(e.TYPE, \" \").concat(replaceName(e.ThemeId || e.MarketplaceUrl)); //ThemeId是shopee的国家;MarketplaceUrl是lazada的国家\n      });\n\n      function replaceName(params) {\n        var rName = '';\n\n        if (/sg/i.test(params)) {\n          rName = ' - Singapore';\n        }\n\n        if (/my/i.test(params)) {\n          rName = ' - Malaysia';\n        }\n\n        if (/id/i.test(params)) {\n          rName = ' - Indonesia';\n        }\n\n        if (/th/i.test(params)) {\n          rName = ' - Thailand';\n        }\n\n        if (/ph/i.test(params)) {\n          rName = ' - Philippines';\n        }\n\n        if (/vn/i.test(params)) {\n          rName = ' - Vietnam';\n        }\n\n        return rName;\n      }\n\n      $scope.shopselectlist.unshift({\n        rNAME: 'All Stores'\n      });\n      console.log('下拉', $scope.shopselectlist);\n      1;\n      $scope.selectshopinfo = $scope.shopselectlist[0];\n      getConnectedList();\n    } //获取批量删除权限\n\n\n    function getBatchPermisstion() {\n      var userId = $rootScope.base64.decode(localStorage.getItem('userId'));\n      console.log(userId);\n      dsp.postFun('cj/PackConnection/getDelPackPermissions', {\n        userId: userId\n      }, function (res) {\n        if (res.data.statusCode == 200) {\n          $scope.packStatus = res.data.result.packStatus; //0-无 1-有\n        } else {\n          $scope.packStatus = 0;\n        }\n      });\n    }\n\n    getBatchPermisstion();\n\n    function getElementLeft(element) {\n      var actualLeft = element.offsetLeft;\n      var current = element.offsetParent;\n\n      while (current !== null) {\n        actualLeft += current.offsetLeft;\n        current = current.offsetParent;\n      }\n\n      return actualLeft;\n    }\n\n    function getElementTop(element) {\n      var actualTop = element.offsetTop;\n      var current = element.offsetParent;\n\n      while (current !== null) {\n        actualTop += current.offsetTop;\n        current = current.offsetParent;\n      }\n\n      return actualTop;\n    }\n\n    $scope.conpagesize = '10';\n    $scope.conpagenum = '1';\n    $scope.conshopid = '';\n    $scope.consearchinfo = '';\n    $scope.conTotalNum = '';\n    $scope.conTotalPage = ''; // $scope.conlist = [];\n\n    if (seachCs) {\n      $scope.consearchinfo = seachCs;\n      console.log($scope.consearchinfo);\n    } // layer.load(2);\n\n\n    function getConnectedList() {\n      // dsp.load();\n      var jsonObj = {};\n      jsonObj.pageSize = $scope.conpagesize;\n      jsonObj.pageNum = $scope.conpagenum;\n      jsonObj.shopId = $scope.selectshopinfo.ID ? $scope.selectshopinfo.ID : '';\n      jsonObj.userId = userId;\n      jsonObj.serachName = $scope.consearchinfo.replace(/'/g, \"''\");\n      $scope.conlist = [];\n      $scope.showFlag = [];\n      $scope.isCheckAll = false;\n      dsp.postFun('app/connection/conList', {\n        \"data\": JSON.stringify(jsonObj)\n      }, jiechuguanlian);\n    }\n\n    $scope.$on('ship-setting', function (ev, data) {\n      if (data.flag == 'submit-ship-success') {\n        $scope.conlist[data.ship.proindex].LOGISTICS = data.ship.shipMethod;\n        $scope.conlist[data.ship.proindex].defaultArea = data.ship.defaultArea;\n      }\n    });\n\n    function settleData(obj) {\n      var pList = obj.conList;\n      var remarkArr = obj.remark || [];\n      console.log(pList);\n\n      for (var i = 0; i < pList.length; i++) {\n        pList[i].discountPrice = dsp.cacuDiscount(pList[i].SELLPRICE, pList[i].SELLDISCOUNT);\n        pList[i].decountry = null;\n        pList[i].deltPrice = 0;\n        pList[i].discountPriceShip = 0;\n\n        if (pList[i].deltPrice) {\n          pList[i].discountPriceShip = dsp.cacuDiscount(pList[i].deltPrice, pList[i].FREIGHTDISCOUNT);\n          pList[i].AMOUNTPRICE = dsp.cacuAmount(pList[i].discountPrice, pList[i].discountPriceShip);\n        } else {\n          pList[i].discountPriceShip = '';\n          pList[i].AMOUNTPRICE = pList[i].discountPrice;\n        }\n\n        for (var j = 0; j < remarkArr.length; j++) {\n          if (pList[i].LOGISTICS == remarkArr[j].nameen) {\n            console.log(remarkArr[j].remark);\n            pList[i].wuliuRemark = remarkArr[j].remark;\n            break;\n          }\n        } // 物流试算组件用\n\n\n        pList[i].shipinfo = {\n          weight: pList[i].packweight,\n          enName: pList[i].LOGISTICS,\n          pid: pList[i].PID,\n          shopType: pList[i].shopType,\n          shipDiscount: pList[i].FREIGHTDISCOUNT,\n          areaCountryCode: pList[i].areaCountryCode,\n          index1: i\n        };\n      }\n\n      $scope.conlist = pList;\n      console.log($scope.conlist);\n      $scope.conTotalPage = Math.ceil($scope.conTotalNum * 1 / ($scope.conpagesize * 1));\n    } // 物流试算组件返回值接收\n\n\n    $scope.$on('saveShipPrice', function (d, data) {\n      console.log(data);\n\n      if (data.index2 >= 0 && data.index1 >= 0) {\n        if (data.shipDiscountPrice) {\n          $scope.conlist[data.index1].varientList[data.index2].isProAmountTip = false;\n        }\n\n        $scope.conlist[data.index1].varientList[data.index2].AMOUNTPRICE = dsp.cacuAmount($scope.conlist[data.index1].varientList[data.index2].discountPrice, data.shipDiscountPrice || 0);\n      } else {\n        if (data.shipDiscountPrice) {\n          $scope.conlist[data.index1].isProAmountTip = false;\n        }\n\n        $scope.conlist[data.index1].AMOUNTPRICE = dsp.cacuAmount($scope.conlist[data.index1].discountPrice, data.shipDiscountPrice || 0);\n      }\n\n      setTimeout(function () {\n        $scope.$apply();\n      });\n    });\n\n    function jiechuguanlian(n) {\n      console.log(n.data);\n      var obj = JSON.parse(n.data.result);\n      $scope.connectedlist = obj;\n      $scope.conTotalNum = obj.total;\n\n      if ($scope.conTotalNum == 0) {\n        $scope.conTotalPage = 0;\n        $scope.conlist = [];\n        $scope.notDataFound = true;\n        return;\n      }\n\n      settleData(obj);\n      $scope.$broadcast('page-data', {\n        pageNum: +$scope.conpagenum,\n        totalNum: $scope.conTotalPage,\n        totalCounts: +$scope.conTotalNum,\n        pageSize: $scope.conpagesize,\n        pagesizeList: ['10', '20', '50']\n      });\n    }\n\n    $scope.$on('pagedata-fa', function (d, data) {\n      //分页切换数据监听\n      $scope.conpagenum = data.pageNum;\n      $scope.conpagesize = data.pageSize;\n      getConnectedList();\n    }); //搜索\n\n    $scope.searchshop = function () {\n      $scope.conpagenum = '1';\n      getConnectedList();\n    };\n\n    $scope.enterSearch = function (event) {\n      if (event.keyCode == \"13\") {\n        $scope.searchshop();\n      }\n    }; //每页数据条数改变的时候\n\n\n    $scope.conpagechange = function (pagesize) {\n      console.log(pagesize);\n      $scope.conpagesize = pagesize;\n      $scope.conpagenum = '1';\n      getConnectedList();\n    }; //输入页码数跳转\n\n\n    $scope.conpagenumchange = function () {\n      $scope.conpagenum = $scope.conpagenum * 1;\n      if ($scope.conpagenum > $scope.conTotalPage || $scope.conpagenum < 1) return;\n      console.log($scope.conpagenum);\n      getConnectedList();\n    }; //店铺选择\n\n\n    $scope.searchshopconnect = function (n) {\n      if (n == null) {\n        n = '';\n      }\n\n      console.log(n);\n      $scope.conshopid = n;\n      $scope.selectshopinfo = n;\n      getConnectedList();\n    }; // 展开变体详情\n\n\n    $scope.showVarient = function (item, index) {\n      $scope.Management = [];\n      dsp.postFun('app/connection/conListdateill', {\n        \"data\": JSON.stringify({\n          accpid: item.ACCPID,\n          shopId: item.shopId\n        })\n      }, function (data) {\n        var data = data.data;\n\n        if (data.statusCode != '200') {\n          console.log(data);\n          return false;\n        }\n\n        var varientList = JSON.parse(data.result).conList;\n        $timeout(function () {\n          for (var i = 0; i < varientList.length; i++) {\n            varientList[i].discountPrice = dsp.cacuDiscount(varientList[i].SELLPRICE, varientList[i].SELLDISCOUNT);\n            varientList[i].decountry = null;\n            varientList[i].deltPrice = 0;\n            varientList[i].discountPriceShip = 0;\n            varientList[i].ischeck = false;\n\n            if (varientList[i].deltPrice) {\n              varientList[i].discountPriceShip = dsp.cacuDiscount(varientList[i].deltPrice, varientList[i].FREIGHTDISCOUNT);\n              varientList[i].AMOUNTPRICE = dsp.cacuAmount(varientList[i].discountPrice, varientList[i].discountPriceShip);\n            } else {\n              varientList[i].discountPriceShip = '';\n              varientList[i].AMOUNTPRICE = varientList[i].discountPrice;\n            } // 展示变体属性\n\n\n            if (varientList[i].variantkey) {\n              var curVarientVal = Array.isArray(varientList[i].variantkey) ? varientList[i].variantkey : varientList[i].variantkey.split('-');\n              varientList[i].varientStr = curVarientVal.join('; ');\n            } // 物流试算组件用\n\n\n            varientList[i].shipinfo = {\n              weight: varientList[i].PACKWEIGHT,\n              enName: varientList[i].LOGISTICS,\n              pid: varientList[i].PID,\n              shopType: item.shopType,\n              shipDiscount: varientList[i].FREIGHTDISCOUNT,\n              areaCountryCode: $scope.conlist[index].areaCountryCode,\n              index1: index,\n              index2: i\n            };\n          }\n\n          console.log(varientList);\n          $scope.conlist[index].varientList = varientList;\n          $('.media').eq(index).find('.asj-pro-box').hide();\n          $('.media').eq(index).css({\n            'padding-bottom': '25px',\n            'background': '#f8f8f8'\n          });\n          console.log($scope.conlist);\n          $scope.showFlag = $scope.conlist.filter(function (item) {\n            if (item.varientList && item.varientList.length > 0) {\n              return true;\n            }\n          });\n          getCheckList();\n        });\n      });\n    }; // 获取变体选择列表\n\n\n    function getCheckList() {\n      var checkL = [];\n      $scope.conlist.forEach(function (_v) {\n        if (_v.varientList) {\n          _v.varientList.forEach(function (_cv) {\n            if (_cv.ischeck) {\n              var shopId = _cv.shopId,\n                  NAMEEN = _cv.NAMEEN,\n                  prices = _cv.prices,\n                  PACKWEIGHT = _cv.PACKWEIGHT,\n                  shopName = _cv.shopName,\n                  SKU = _cv.SKU,\n                  VID = _cv.VID,\n                  ACCPID = _cv.ACCPID,\n                  vsku = _cv.vsku,\n                  ACCVID = _cv.ACCVID;\n              checkL.push({\n                shopName: shopName,\n                shopId: shopId,\n                NAMEEN: NAMEEN,\n                prices: prices,\n                SKU: SKU,\n                VID: VID,\n                ACCPID: ACCPID,\n                vsku: vsku,\n                ACCVID: ACCVID,\n                shopType: _v.shopType,\n                PID: '',\n                packweight: PACKWEIGHT,\n                type: \"1\",\n                sku: SKU\n              });\n            }\n          });\n        } else if (_v.ischeck) {\n          var _checkL$push;\n\n          var PID = _v.PID,\n              shopId = _v.shopId,\n              NAMEEN = _v.NAMEEN,\n              prices = _v.prices,\n              packweight = _v.packweight,\n              shopName = _v.shopName,\n              SKU = _v.SKU,\n              VID = _v.VID,\n              ACCPID = _v.ACCPID,\n              ACCVID = _v.ACCVID,\n              shopType = _v.shopType;\n          checkL.push((_checkL$push = {\n            shopName: shopName,\n            shopId: shopId,\n            NAMEEN: NAMEEN,\n            prices: prices,\n            SKU: SKU,\n            VID: VID,\n            PID: PID,\n            packweight: packweight,\n            ACCPID: ACCPID,\n            ACCVID: ACCVID,\n            shopType: shopType\n          }, _defineProperty(_checkL$push, \"VID\", ''), _defineProperty(_checkL$push, \"type\", \"1\"), _defineProperty(_checkL$push, \"sku\", SKU), _checkL$push));\n        }\n      });\n      console.log(\"checkL===\", checkL);\n      $scope.checkList = checkL;\n      $scope.isConnection = checkL.length > 0;\n      $scope.showFlag = $scope.checkList;\n    } //变体列表\n\n\n    $scope.Management = [];\n\n    $scope.cheched = function (itemV, idx) {\n      console.log(itemV);\n      itemV.ischeck = !itemV.ischeck;\n      getCheckList();\n    }; // 同步库存到店铺\n\n\n    $scope.fulfil = '1';\n    $scope.Levels = '1';\n\n    $scope.fulfillmentFun = function () {\n      if ($scope.checkList.length == 0) return layer.msg('Please select a product');\n      var isSame = true,\n          isShopify = true;\n      var shopName = $scope.checkList[0].shopName;\n      $scope.checkList.some(function (_v) {\n        if (_v.shopName != shopName) isSame = false;\n        if (_v.shopType !== 'shopify') isShopify = false;\n      });\n      if (!isSame) return layer.msg('Please select the item under the same store');\n      if (!isShopify) return layer.msg('CJ Fulfillment is only available to Shopify stores');\n      $scope.isCJManagement = true;\n\n      $scope.YCJManagement = function () {\n        var shopName = $scope.checkList[0].shopName;\n        var shopId = $scope.checkList[0].shopId;\n        var skus = [];\n        var accPids = [];\n        $scope.checkList.forEach(function (o) {\n          if (!o.PID) {\n            skus.push({\n              vid: o.ACCVID,\n              sku: o.vsku\n            });\n          } else {\n            accPids.push(o.ACCPID);\n          }\n        });\n        var url = 'platform-product/fulfillment/fulfillmentSetting';\n        var parms = {\n          fulfillmentservice: $scope.fulfil == '1' ? 'cjdropshipping' : null,\n          inventoryManagement: $scope.Levels == '1' ? 'cjdropshipping' : null,\n          shopName: shopName,\n          shopId: shopId,\n          accPids: accPids,\n          skus: skus\n        };\n        var msgLoading = cjMessage.loading({\n          isFixed: true\n        });\n        dsp.postFun(url, parms, function (res) {\n          msgLoading.hide();\n\n          if (res.data.code == 200) {\n            $scope.isCJManagement = false;\n            getConnectedList();\n            $scope.Management = [];\n            layer.msg(res.data.data);\n          } else if (res.data.code == 5010) {\n            $scope.isCJManagement = false;\n            $scope.storeAutoExpirePopup = true;\n          } else {\n            layer.msg('The server is busy now, please try again later.');\n          }\n        }, function (err) {\n          layer.msg('Service exception');\n          msgLoading.hide();\n        });\n      };\n\n      if ($scope.showFlag[0].shopType == \"shopify\") {\n        var shopList = $scope.shopselectlist.filter(function (item) {\n          return item.ID == $scope.showFlag[0].shopId;\n        });\n        $scope.syncInventory = shopList[0].sync_inventory;\n        console.log(shopList, $scope.syncInventory);\n      }\n    };\n\n    $scope.hideVarient = function (item, index) {\n      $scope.Management = [];\n      $scope.conlist[index].varientList = undefined;\n      $('.media').eq(index).find('.asj-pro-box').show();\n      $('.media').eq(index).css({\n        'padding-bottom': '0',\n        'background': '#fff'\n      });\n      getCheckList();\n    };\n\n    $scope.disconnect = function (item, index1, index2) {\n      $scope.disconnectPopup = true;\n      $scope.item = item;\n      $scope.index1 = index1;\n      $scope.index2 = index2;\n    };\n\n    $scope.disconnectCancelFun = function (params) {\n      $scope.disconnectPopup = false;\n      $scope.item = null;\n      $scope.index1 = null;\n      $scope.index2 = null;\n    };\n\n    $scope.disconnectConfirmFun = function () {\n      // return alert($rootScope.soldOutCount)\n      var item = $scope.item,\n          index1 = $scope.index1,\n          index2 = $scope.index2;\n      var disconnectUrl, sendStr;\n\n      if (index2 >= 0) {\n        disconnectUrl = 'app/connection/relieveCondetaill';\n        sendStr = {\n          \"data\": \"{'id':'\" + item.id + \"','shopVid':'\" + item.ACCVID + \"','shopId':'\" + item.shopId + \"'}\"\n        };\n      } else {\n        disconnectUrl = 'app/connection/relieveCon';\n        sendStr = {\n          \"data\": \"{'pid':'\" + item.ID + \"','shopproductId':'\" + item.ACCPID + \"','shopId':'\" + item.shopId + \"'}\"\n        };\n      }\n\n      var msgLoading = cjMessage.loading({\n        isFixed: true\n      });\n      dsp.postFun(disconnectUrl, sendStr, function (data) {\n        // layer.closeAll(\"loading\")\n        msgLoading.hide();\n        var data = data.data;\n        console.log(data);\n\n        if (data.statusCode != '200') {\n          layer.msg('Disconnect the products failed. ');\n          return false;\n        }\n\n        layer.msg('Disconnected Successfully!');\n        $timeout(function () {\n          if (index2 >= 0) {\n            $scope.conlist[index1].varientList.splice(index2, 1);\n\n            if ($scope.conlist[index1].varientList.length == 0) {\n              $scope.conlist.splice(index1, 1);\n            }\n          } else {\n            getConnectedList(); // 刷新数据\n\n            if (item.SALESTATUS == '5') {\n              $rootScope.soldOutCount -= 1; // 导航栏角标数量\n            }\n          }\n        }, 1000);\n        $scope.disconnectPopup = false;\n      }, function () {\n        msgLoading.hide();\n      });\n    };\n    /*包装相关操作*/\n    // 商品批量关联\n\n\n    $scope.batchAssociation = function (item) {\n      console.log(item);\n\n      if (item.productType === '5') {\n        layer.msg('Packages are not available to the product. ');\n        return;\n      }\n\n      var itemData = {\n        type: \"0\",\n        pid: item.ID,\n        shopId: item.shopId,\n        NAMEEN: item.NAMEEN,\n        //商品名称\n        SKU: item.SKU,\n        // sku\n        prices: item.prices,\n        //价格\n        packweight: item.packweight,\n        //重量\n        connectType: 1 // 关联包装类型 1 是店铺关联\n\n      };\n      location.href = '#/relevant-packaging/' + base64.encode(JSON.stringify(itemData)) + '/0';\n    }; // 变体关联包装\n\n\n    $scope.associatedPackaging = function (item) {\n      console.log(item);\n\n      if (item.productType === '5') {\n        layer.msg('Packages are not available to the product. ');\n        return;\n      }\n\n      var arr = item.STANDARD ? item.STANDARD.split(',') : [],\n          long = null,\n          width = null,\n          height = null;\n      arr.forEach(function (o, i) {\n        if (o.indexOf('long') !== -1) {\n          long = o.substr(o.indexOf('=') + 1, o.length);\n        } else if (o.indexOf('width') !== -1) {\n          width = o.substr(o.indexOf('=') + 1, o.length);\n        } else if (o.indexOf('height') !== -1) {\n          height = o.substr(o.indexOf('=') + 1, o.length);\n        }\n      });\n      var itemData = {\n        type: \"1\",\n        vid: item.VID,\n        shopId: item.shopId,\n        NAMEEN: item.NAMEEN,\n        //商品名称\n        SKU: item.SKU,\n        // sku\n        prices: item.prices,\n        //价格\n        packweight: item.PACKWEIGHT,\n        //重量\n        long: long,\n        //长\n        width: width,\n        //宽\n        height: height //高\n\n      };\n      location.href = '#/relevant-packaging/' + base64.encode(JSON.stringify(itemData)) + '/0';\n    }; //查看包装\n    //获取商品变体集合\n\n\n    $scope.viewPackaging = function (item) {\n      $scope.selectedShopId = item.shopId; // 如果是商品点击的\n\n      dsp.getFun('cj/PackProduct/getProductStandList?pid=' + item.PID + '&type=1&shopId=' + item.shopId, function (res) {\n        layer.closeAll('loading');\n\n        if (res.data.statusCode === '200') {\n          $scope.viewPackagingModal = true;\n          $scope.proStandList = res.data.result;\n          $('.singleSelect').select2();\n        }\n      }, function (err) {\n        $scope.proStandList = [];\n        layer.closeAll('loading');\n        console.log(err);\n      });\n\n      if (!item.ID) {\n        // 如果点击的是变体,直接查询该变体\n        $scope.selectedVid = item.VID;\n        $scope.viewPackagingModal = true;\n        $scope.onSelectPackaging();\n      }\n    }; //选择某个包装变体，查询详情\n\n\n    $scope.onSelectPackaging = function () {\n      if ($scope.selectedVid) {\n        // 选择了变体，显示变体下关联的包装商品\n        dsp.postFun('cj/PackProduct/getCheckedList', {\n          vid: $scope.selectedVid,\n          shopId: $scope.selectedShopId\n        }, function (res) {\n          layer.closeAll('loading');\n\n          if (res.data.statusCode == '200') {\n            $scope.vidCheckedList = res.data.result.checkedList;\n          } else {\n            $scope.vidCheckedList = [];\n          }\n        }, function (err) {\n          layer.closeAll('loading');\n          console.log(err);\n        });\n      } else {\n        // 没有选择，则不要\n        $scope.vidCheckedList = [];\n      }\n    };\n\n    $scope.formateSize = function (size) {\n      var newSize = String(size);\n      newSize = newSize.replace(/Long/, 'Length');\n      return newSize;\n    }; // 关闭 view 弹框\n\n\n    $scope.closeViewPackagingModal = function () {\n      $scope.viewPackagingModal = false;\n      $scope.vidCheckedList = [];\n      $scope.selectedVid = '';\n      $('.singleSelect').select2('destroy');\n    }; //解除绑定\n\n\n    $scope.removeParams = {};\n    $scope.isVarient = false;\n\n    $scope.unBind = function (item, isVarient) {\n      $scope.showPopUps = true;\n      $scope.removeParams = {\n        type: '0',\n        pid: item.PID || '',\n        shopId: item.shopId\n      };\n\n      if (isVarient) {\n        // 如果展开变体，则传入变体id\n        $scope.removeParams.vid = item.VID || '';\n      }\n    }; // 获取弹窗组件关闭按钮\n\n\n    $scope.$on('closePopUps', function (e, data) {\n      $scope.showPopUps = false;\n    }); // 获取弹窗组件确定按钮\n\n    $scope.$on('confirmPopUps', function (e, data) {\n      var msgLoading = cjMessage.loading({\n        isFixed: true\n      });\n      dsp.postFun('cj/PackProduct/delCorrelation', $scope.removeParams, function (res) {\n        msgLoading.hide();\n\n        if (res.data.statusCode == '200') {\n          layer.msg('Removed Successfully');\n          getConnectedList();\n        } else {\n          layer.msg('Binding removal failed');\n        }\n      }, function (err) {\n        msgLoading.hide(); // layer.close(index);\n\n        console.log(err);\n      });\n      $scope.showPopUps = false;\n    }); // 全选所有商品\n\n    $scope.chechedAll = function () {\n      $scope.isCheckAll = !$scope.isCheckAll;\n      $scope.conlist.forEach(function (o) {\n        o.ischeck = $scope.isCheckAll;\n\n        if (o.varientList) {\n          o.varientList.forEach(function (_v) {\n            _v.ischeck = $scope.isCheckAll;\n          });\n        }\n      });\n      $scope.isConnection = $scope.conlist.filter(function (o) {\n        return o.ischeck;\n      }).length > 0;\n      getCheckList();\n    }; // 单选商品\n\n\n    $scope.checkPro = function (item, idx) {\n      console.log(item);\n      item.ischeck = !item.ischeck;\n      var checkLen = $scope.conlist.filter(function (o) {\n        return o.ischeck;\n      }).length;\n      $scope.isConnection = checkLen > 0;\n      $scope.isCheckAll = $scope.conlist.length === checkLen;\n      getCheckList();\n    }; // 批量关联包装\n\n\n    $scope.bulkConnection = function () {\n      if (!$scope.checkList || $scope.checkList.length == 0) return false;\n      var packNames = $scope.checkList.map(function (o) {\n        return {\n          type: \"0\",\n          pid: o.PID,\n          SKU: o.sku,\n          shopId: o.shopId,\n          NAMEEN: o.NAMEEN,\n          prices: o.prices,\n          //价格\n          vid: o.VID,\n          packweight: o.packweight,\n          //重量\n          connectType: 1 // 关联包装类型 1 是店铺关联\n\n        };\n      });\n      ;\n      console.log(\"packNames====\", packNames);\n      localStorage.setItem('relevantpackage', base64.encode(JSON.stringify(packNames)));\n      location.href = \"#/relevant-packaging/1/0\";\n    }; // 批量解除包装\n\n\n    $scope.bulkRemoveConnection = function () {\n      if (!$scope.checkList || $scope.checkList.length == 0) return false;\n      if ($scope.checkList.length > 0) $scope.batchDeletePopup = true;\n    }; // 批量移除包装\n\n\n    $scope.batchDeleteConfirmFun = function () {\n      if (!$scope.checkList || $scope.checkList.length == 0) return false;\n      var params = $scope.checkList.map(function (o) {\n        return {\n          pid: o.PID,\n          shopId: o.shopId,\n          vid: o.VID\n        };\n      });\n      dsp.postFun('cj/PackConnection/batchDelCorrelation', params, function (_ref) {\n        var data = _ref.data;\n\n        if (data.statusCode == '200') {\n          layer.msg(\"Bulk Removed Successfully\");\n        } else if (data.statusCode == '1102') {\n          layer.msg(\"You're not authorized to delete the packaging, please contact your agent for more information\");\n        } else {\n          layer.msg(\"Bulk Removing Failed\");\n        }\n\n        $scope.batchDeletePopup = false;\n      });\n    };\n    /* 修改默认物流 */\n\n\n    $scope.settingLogisticVisible = false;\n    $scope.settingLogisticList = [];\n    $scope.settingCountry = [];\n    $scope.currentProData = null;\n    $scope.currentVarData = null;\n\n    $scope.initSettingLogistic = function (item, itemProduct, index) {\n      $scope.currentIndex = index;\n      $scope.currentProData = itemProduct;\n      $scope.currentVarData = item;\n      $scope.settingLogisticVisible = true;\n      dsp.getAreaByPid(item.PID, function (res) {\n        $scope.settingCountry = res;\n        $scope.currentCountry = item.areaCountryCode;\n        dsp.getShipListNew({\n          platForms: item.shopType || [],\n          startCountryCode: item.areaCountryCode,\n          weightInterval: item.packweight,\n          propertys: itemProduct.MATERIALKEY.split(',')\n        }, function (res2) {\n          $scope.settingLogisticList = res2;\n\n          if (item.LOGISTICS) {\n            $scope.currentLogistic = res2.find(function (i) {\n              return i.nameEn === item.LOGISTICS;\n            });\n          }\n        });\n      });\n      console.log(item);\n    };\n\n    $scope.changeCountry = function (contryCode) {\n      dsp.getShipListNew({\n        platForms: $scope.currentVarData.shopType || [],\n        startCountryCode: contryCode,\n        weightInterval: $scope.currentVarData.packweight,\n        propertys: $scope.currentProData.MATERIALKEY.split(',')\n      }, function (res) {\n        $scope.settingLogisticList = res;\n      });\n    };\n    /* 修改默认物流 */\n\n\n    $scope.submitChangeLogistic = function () {\n      var currentCountryObj = $scope.settingCountry.find(function (i) {\n        return i.countryCode === $scope.currentCountry;\n      });\n\n      if (!$scope.currentLogistic) {\n        return layer.msg('Please select logistics');\n      }\n\n      if (!$scope.currentVarData) {\n        return layer.msg('Please select shipping country');\n      }\n\n      var params = {\n        vid: $scope.currentVarData.VID,\n        shopId: $scope.currentProData.shopId,\n        logisticsName: $scope.currentLogistic.nameEn,\n        areaId: currentCountryObj.areaId,\n        areaEnName: currentCountryObj.areaEn,\n        areaCountryCode: currentCountryObj.countryCode\n      };\n      dsp.postFun('app/connection/updateConStanLogistics', params, function (res) {\n        console.log(res);\n\n        if (res.data.statusCode === '200') {\n          layer.msg('Set successfully');\n          $scope.showVarient($scope.currentProData, $scope.currentIndex);\n        } else {\n          layer.msg('Set failed');\n        }\n\n        $scope.settingLogisticVisible = false;\n      });\n    }; //关闭授权过期提示\n\n\n    $scope.closeStoreAutoExpire = function () {\n      $scope.storeAutoExpirePopup = false;\n      getConnectedList();\n    }; //授权过期跳转到shopify授权列表页面\n\n\n    $scope.storeAutoExpireConfirmFun = function () {\n      location.href = \"/myCJ.html#/authorize/Shopify\";\n    };\n  }]);\n  app.directive('repeatFinish', function ($timeout) {\n    return {\n      restrict: 'A',\n      link: function link(scope, elem, attr) {\n        //当前循环至最后一个\n        if (scope.$last === true) {\n          $timeout(function () {\n            //向父控制器传递事件消息\n            scope.$emit('repeatFinishCallback');\n            var itemTop = $(\"#down-batch0\").offset().top;\n            var itemLeft = $(\"#down-batch0\").offset().left;\n            var itemTop1 = $(\"#input-yd0\").offset().top;\n            var itemLeft1 = $(\"#input-yd0\").offset().left;\n            console.log(itemTop, itemLeft, itemTop1, itemLeft1);\n\n            if (localStorage.getItem('fwStu') == 'downBatch') {\n              $('.fir-zhidao').css({\n                top: itemTop - 5,\n                left: itemLeft - 6\n              });\n            } else {\n              $('.sec-zhidao').css({\n                top: itemTop1 - 11,\n                left: itemLeft1 - 8\n              });\n            }\n          }, 100);\n        }\n      }\n    };\n  });\n  return app;\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi4vc3JjL3BhZ2VzL215Y2ovY29ubmVjdGlvbi9jb25uZWN0aW9uLmpzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4uL3NyYy9wYWdlcy9teWNqL2Nvbm5lY3Rpb24vY29ubmVjdGlvbi5qcz83MWY5Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHBhZ2VGdW5XaXRoUGFyYW1zIH0gZnJvbSAnQHNyYy9wYWdlcy9teWNqL215Y2otY29tbW9uJztcclxuXHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY29ubmVjdGlvbkZhY3RvcnkoYW5ndWxhcikge1xyXG4gIGNvbnN0IGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdjb25uZWN0aW9uLm1vZHVsZScsIFtdKTtcclxuXHJcbiAgYXBwLmNvbnRyb2xsZXIoJ2Nvbm5lY3Rpb24uY3RybCcsIFsnJHJvb3RTY29wZScsICckc2NvcGUnLCAnJHRpbWVvdXQnLCAnJHN0YXRlUGFyYW1zJywgJ2RzcCcsICckc3RhdGUnLFxyXG4gICAgZnVuY3Rpb24gKCRyb290U2NvcGUsICRzY29wZSwgJHRpbWVvdXQsICRzdGF0ZVBhcmFtcywgZHNwLCAkc3RhdGUpIHtcclxuICAgICAgJHJvb3RTY29wZS4kb24oJ2FwcC9jb25uZWN0aW9uL2Nvbkxpc3QnLCAoXywgYm9vbCkgPT4ge1xyXG4gICAgICAgICRzY29wZS5sb2FkaW5nID0gYm9vbDtcclxuICAgICAgICBpZiAoYm9vbCkgJHNjb3BlLm5vdERhdGFGb3VuZCA9IGZhbHNlO1xyXG4gICAgICB9KTtcclxuICAgICAgZHNwLmRvbWFpbkRhdGEoKS50aGVuKChyZXMpID0+IHtcclxuICAgICAgICAvLyDor7fmsYLmiJDlip/nmoTnu5PmnpxcclxuICAgICAgICBjb25zb2xlLmxvZyhyZXMpXHJcbiAgICAgICAgJHNjb3BlLmlzY2ogPSByZXMuaXNjajtcclxuICAgICAgICAkc2NvcGUuYWZmTW9kZWwgPSByZXMuYWZmTW9kZWw7XHJcbiAgICAgICAgaWYgKCRzY29wZS5pc2NqID09ICcxJykge1xyXG4gICAgICAgICAgLy9jalxyXG4gICAgICAgICAgJHNjb3BlLndlYnNpdGVOYW1lID0gJ0NKJztcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgLy/lrqLmiLdcclxuICAgICAgICAgICRzY29wZS53ZWJzaXRlTmFtZSA9IHJlcy53ZWJzaXRlTmFtZSB8fCAnQ0onO1xyXG4gICAgICAgIH1cclxuICAgICAgfSlcclxuICAgICAgdmFyIHZpcCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd2aXAnKSA9PSB1bmRlZmluZWQgPyBcIlwiIDogbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3ZpcCcpO1xyXG4gICAgICBpZiAodmlwID09ICcxJykgey8vdmlwRmxhZ1xyXG4gICAgICAgICQoJy5oZWFkZXItbmF2JykuYWRkQ2xhc3MoJ3ZpcEZsYWcnKTtcclxuICAgICAgICAkKCcubXljai1yaWdodC13cmFwJykuY3NzKCdiYWNrZ3JvdW5kJywgJyNGMEVERTcnKS5hZGRDbGFzcygndmlwJyk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgJCgnLmhlYWRlci1uYXYnKS5yZW1vdmVDbGFzcygndmlwRmxhZycpO1xyXG4gICAgICAgICQoJy5teWNqLXJpZ2h0LXdyYXAnKS5jc3MoJ2JhY2tncm91bmQnLCAnI2YyZjNmNScpLnJlbW92ZUNsYXNzKCd2aXAnKTtcclxuICAgICAgfVxyXG4gICAgICAkKCcuaGVhZGVyLW5hdiBsaScpLmVxKDIpLmFkZENsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgJHNjb3BlLmFmdGVyR2V0TGVmdE5hdiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAodmlwID09ICcxJykge1xyXG4gICAgICAgICAgJCgnLm15Y2otbGVmdC1iYXInKS5hZGRDbGFzcygndmlwRmxhZycpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAkKCcubXljai1sZWZ0LWJhcicpLnJlbW92ZUNsYXNzKCd2aXBGbGFnJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgICQoJy5teWNqLWxlZnQtYmFyIGxpJykuZXEoMCkuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICB9XHJcbiAgICAgIGRzcC5zZXRSaWdodE1pbkhlaWdodCgpO1xyXG4gICAgICBjb25zb2xlLmxvZyhcInByb2R1Y3RzQ29ubmVjdGVkQ3RybFwiKVxyXG4gICAgICB2YXIgYmFzZTY0ID0gbmV3IEJhc2U2NCgpO1xyXG4gICAgICB2YXIgdXNlcklkID0gYmFzZTY0LmRlY29kZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndXNlcklkJykgPT0gdW5kZWZpbmVkID8gXCJcIiA6IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd1c2VySWQnKSk7XHJcbiAgICAgIGNvbnNvbGUubG9nKHVzZXJJZClcclxuICAgICAgdHJ5IHtcclxuICAgICAgICB2YXIgc2VhY2hDcyA9IGRlY29kZVVSSSgkc3RhdGVQYXJhbXMuc2VhY2hDcyB8fCAnJyk7XHJcbiAgICAgIH0gY2F0Y2goZSkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGUpXHJcbiAgICAgIH1cclxuICAgICAgJHNjb3BlLmNvbnRlbnQgPSAnQXJlIHlvdSBzdXJlIHRvIHJlbW92ZSB0aGUgcGFja2FnaW5nPyc7XHJcbiAgICAgICRzY29wZS5zaG93UG9wVXBzID0gZmFsc2U7XHJcbiAgICAgIFxyXG4gICAgICBjb25zb2xlLmxvZyhzZWFjaENzKVxyXG4gICAgICAkcm9vdFNjb3BlLiRvbignYXBwL3Nob3AvZ2V0c2hvcCcsIChfLCBib29sKSA9PiAkc2NvcGUubG9hZGluZ19zaG9wID0gYm9vbCk7XHJcbiAgICAgIGRzcC5wb3N0RnVuKCdhcHAvc2hvcC9nZXRzaG9wJywgeyBcImRhdGFcIjogXCJ7J3VzZXJJZCc6J1wiICsgdXNlcklkICsgXCInfVwiIH0sIGdldHNob3ApO1xyXG5cclxuICAgICAgZnVuY3Rpb24gZ2V0c2hvcChuKSB7XHJcbiAgICAgICAgdmFyIG9iaiA9IEpTT04ucGFyc2Uobi5kYXRhLnJlc3VsdCk7XHJcbiAgICAgICAgLy8gY29uc29sZS5sb2coJ+S4i+aLiScsIG9iai5zaG9wbGlzdClcclxuICAgICAgICAkc2NvcGUuc2hvcHNlbGVjdGxpc3QgPSBvYmouc2hvcGxpc3Q7XHJcbiAgICAgICAgJHNjb3BlLnNob3BzZWxlY3RsaXN0LmZvckVhY2goZSA9PiB7XHJcbiAgICAgICAgICBlLnJOQU1FID0gYCR7ZS5OQU1FfSAtICR7ZS5UWVBFfSAke3JlcGxhY2VOYW1lKChlLlRoZW1lSWQgfHwgZS5NYXJrZXRwbGFjZVVybCkpfWA7IC8vVGhlbWVJZOaYr3Nob3BlZeeahOWbveWutjtNYXJrZXRwbGFjZVVybOaYr2xhemFkYeeahOWbveWutlxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGZ1bmN0aW9uIHJlcGxhY2VOYW1lKHBhcmFtcykge1xyXG4gICAgICAgICAgbGV0IHJOYW1lID0gJyc7XHJcbiAgICAgICAgICBpZiAoL3NnL2kudGVzdChwYXJhbXMpKSB7IHJOYW1lID0gJyAtIFNpbmdhcG9yZScgfVxyXG4gICAgICAgICAgaWYgKC9teS9pLnRlc3QocGFyYW1zKSkgeyByTmFtZSA9ICcgLSBNYWxheXNpYScgfVxyXG4gICAgICAgICAgaWYgKC9pZC9pLnRlc3QocGFyYW1zKSkgeyByTmFtZSA9ICcgLSBJbmRvbmVzaWEnIH1cclxuICAgICAgICAgIGlmICgvdGgvaS50ZXN0KHBhcmFtcykpIHsgck5hbWUgPSAnIC0gVGhhaWxhbmQnIH1cclxuICAgICAgICAgIGlmICgvcGgvaS50ZXN0KHBhcmFtcykpIHsgck5hbWUgPSAnIC0gUGhpbGlwcGluZXMnIH1cclxuICAgICAgICAgIGlmICgvdm4vaS50ZXN0KHBhcmFtcykpIHsgck5hbWUgPSAnIC0gVmlldG5hbScgfVxyXG4gICAgICAgICAgcmV0dXJuIHJOYW1lO1xyXG4gICAgICAgIH1cclxuICAgICAgICAkc2NvcGUuc2hvcHNlbGVjdGxpc3QudW5zaGlmdCh7ck5BTUU6J0FsbCBTdG9yZXMnfSlcclxuICAgICAgICBjb25zb2xlLmxvZygn5LiL5ouJJywgJHNjb3BlLnNob3BzZWxlY3RsaXN0KTsxXHJcbiAgICAgICAgJHNjb3BlLnNlbGVjdHNob3BpbmZvID0gJHNjb3BlLnNob3BzZWxlY3RsaXN0WzBdO1xyXG4gICAgICAgIGdldENvbm5lY3RlZExpc3QoKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy/ojrflj5bmibnph4/liKDpmaTmnYPpmZBcclxuICAgICAgZnVuY3Rpb24gZ2V0QmF0Y2hQZXJtaXNzdGlvbigpe1xyXG4gICAgICAgIGNvbnN0IHVzZXJJZCA9ICAkcm9vdFNjb3BlLmJhc2U2NC5kZWNvZGUobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3VzZXJJZCcpKVxyXG4gICAgICAgIGNvbnNvbGUubG9nKHVzZXJJZClcclxuICAgICAgICBkc3AucG9zdEZ1bignY2ovUGFja0Nvbm5lY3Rpb24vZ2V0RGVsUGFja1Blcm1pc3Npb25zJyx7dXNlcklkOnVzZXJJZH0sKHJlcyk9PntcclxuICAgICAgICAgIGlmKHJlcy5kYXRhLnN0YXR1c0NvZGUgPT0gMjAwKXtcclxuICAgICAgICAgICAgJHNjb3BlLnBhY2tTdGF0dXMgPSByZXMuZGF0YS5yZXN1bHQucGFja1N0YXR1cyAvLzAt5pegIDEt5pyJXHJcbiAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgJHNjb3BlLnBhY2tTdGF0dXMgPSAwXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgICAgfVxyXG4gICAgICBnZXRCYXRjaFBlcm1pc3N0aW9uKCk7XHJcblxyXG4gICAgICBmdW5jdGlvbiBnZXRFbGVtZW50TGVmdChlbGVtZW50KSB7XHJcbiAgICAgICAgdmFyIGFjdHVhbExlZnQgPSBlbGVtZW50Lm9mZnNldExlZnQ7XHJcbiAgICAgICAgdmFyIGN1cnJlbnQgPSBlbGVtZW50Lm9mZnNldFBhcmVudDtcclxuXHJcbiAgICAgICAgd2hpbGUgKGN1cnJlbnQgIT09IG51bGwpIHtcclxuICAgICAgICAgIGFjdHVhbExlZnQgKz0gY3VycmVudC5vZmZzZXRMZWZ0O1xyXG4gICAgICAgICAgY3VycmVudCA9IGN1cnJlbnQub2Zmc2V0UGFyZW50O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGFjdHVhbExlZnQ7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGZ1bmN0aW9uIGdldEVsZW1lbnRUb3AoZWxlbWVudCkge1xyXG4gICAgICAgIHZhciBhY3R1YWxUb3AgPSBlbGVtZW50Lm9mZnNldFRvcDtcclxuICAgICAgICB2YXIgY3VycmVudCA9IGVsZW1lbnQub2Zmc2V0UGFyZW50O1xyXG5cclxuICAgICAgICB3aGlsZSAoY3VycmVudCAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgYWN0dWFsVG9wICs9IGN1cnJlbnQub2Zmc2V0VG9wO1xyXG4gICAgICAgICAgY3VycmVudCA9IGN1cnJlbnQub2Zmc2V0UGFyZW50O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGFjdHVhbFRvcDtcclxuICAgICAgfVxyXG5cclxuICAgICAgJHNjb3BlLmNvbnBhZ2VzaXplID0gJzEwJztcclxuICAgICAgJHNjb3BlLmNvbnBhZ2VudW0gPSAnMSc7XHJcbiAgICAgICRzY29wZS5jb25zaG9waWQgPSAnJztcclxuICAgICAgJHNjb3BlLmNvbnNlYXJjaGluZm8gPSAnJztcclxuICAgICAgJHNjb3BlLmNvblRvdGFsTnVtID0gJyc7XHJcbiAgICAgICRzY29wZS5jb25Ub3RhbFBhZ2UgPSAnJztcclxuICAgICAgLy8gJHNjb3BlLmNvbmxpc3QgPSBbXTtcclxuICAgICAgaWYgKHNlYWNoQ3MpIHtcclxuICAgICAgICAkc2NvcGUuY29uc2VhcmNoaW5mbyA9IHNlYWNoQ3M7XHJcbiAgICAgICAgY29uc29sZS5sb2coJHNjb3BlLmNvbnNlYXJjaGluZm8pXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIGxheWVyLmxvYWQoMik7XHJcbiAgICAgIGZ1bmN0aW9uIGdldENvbm5lY3RlZExpc3QoKSB7XHJcbiAgICAgICAgLy8gZHNwLmxvYWQoKTtcclxuICAgICAgICB2YXIganNvbk9iaiA9IHt9O1xyXG4gICAgICAgIGpzb25PYmoucGFnZVNpemUgPSAkc2NvcGUuY29ucGFnZXNpemU7XHJcbiAgICAgICAganNvbk9iai5wYWdlTnVtID0gJHNjb3BlLmNvbnBhZ2VudW07XHJcbiAgICAgICAganNvbk9iai5zaG9wSWQgPSAkc2NvcGUuc2VsZWN0c2hvcGluZm8uSUQgPyAkc2NvcGUuc2VsZWN0c2hvcGluZm8uSUQgOiAnJztcclxuICAgICAgICBqc29uT2JqLnVzZXJJZCA9IHVzZXJJZDtcclxuICAgICAgICBqc29uT2JqLnNlcmFjaE5hbWUgPSAkc2NvcGUuY29uc2VhcmNoaW5mby5yZXBsYWNlKC8nL2csIFwiJydcIik7XHJcbiAgICAgICAgJHNjb3BlLmNvbmxpc3QgPSBbXTtcclxuICAgICAgICAkc2NvcGUuc2hvd0ZsYWcgPSBbXTtcclxuICAgICAgICAkc2NvcGUuaXNDaGVja0FsbCA9IGZhbHNlXHJcbiAgICAgICAgZHNwLnBvc3RGdW4oJ2FwcC9jb25uZWN0aW9uL2Nvbkxpc3QnLCB7IFwiZGF0YVwiOiBKU09OLnN0cmluZ2lmeShqc29uT2JqKSB9LCBqaWVjaHVndWFubGlhbik7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgICRzY29wZS4kb24oJ3NoaXAtc2V0dGluZycsIGZ1bmN0aW9uIChldiwgZGF0YSkge1xyXG4gICAgICAgIGlmIChkYXRhLmZsYWcgPT0gJ3N1Ym1pdC1zaGlwLXN1Y2Nlc3MnKSB7XHJcbiAgICAgICAgICAkc2NvcGUuY29ubGlzdFtkYXRhLnNoaXAucHJvaW5kZXhdLkxPR0lTVElDUyA9IGRhdGEuc2hpcC5zaGlwTWV0aG9kO1xyXG4gICAgICAgICAgJHNjb3BlLmNvbmxpc3RbZGF0YS5zaGlwLnByb2luZGV4XS5kZWZhdWx0QXJlYSA9IGRhdGEuc2hpcC5kZWZhdWx0QXJlYTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pXHJcblxyXG4gICAgICBmdW5jdGlvbiBzZXR0bGVEYXRhKG9iaikge1xyXG4gICAgICAgIHZhciBwTGlzdCA9IG9iai5jb25MaXN0O1xyXG4gICAgICAgIHZhciByZW1hcmtBcnIgPSBvYmoucmVtYXJrIHx8IFtdO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKHBMaXN0KTtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBMaXN0Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICBwTGlzdFtpXS5kaXNjb3VudFByaWNlID0gZHNwLmNhY3VEaXNjb3VudChwTGlzdFtpXS5TRUxMUFJJQ0UsIHBMaXN0W2ldLlNFTExESVNDT1VOVCk7XHJcbiAgICAgICAgICBwTGlzdFtpXS5kZWNvdW50cnkgPSBudWxsO1xyXG4gICAgICAgICAgcExpc3RbaV0uZGVsdFByaWNlID0gMDtcclxuICAgICAgICAgIHBMaXN0W2ldLmRpc2NvdW50UHJpY2VTaGlwID0gMDtcclxuICAgICAgICAgIGlmIChwTGlzdFtpXS5kZWx0UHJpY2UpIHtcclxuICAgICAgICAgICAgcExpc3RbaV0uZGlzY291bnRQcmljZVNoaXAgPSBkc3AuY2FjdURpc2NvdW50KHBMaXN0W2ldLmRlbHRQcmljZSwgcExpc3RbaV0uRlJFSUdIVERJU0NPVU5UKTtcclxuICAgICAgICAgICAgcExpc3RbaV0uQU1PVU5UUFJJQ0UgPSBkc3AuY2FjdUFtb3VudChwTGlzdFtpXS5kaXNjb3VudFByaWNlLCBwTGlzdFtpXS5kaXNjb3VudFByaWNlU2hpcCk7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBwTGlzdFtpXS5kaXNjb3VudFByaWNlU2hpcCA9ICcnO1xyXG4gICAgICAgICAgICBwTGlzdFtpXS5BTU9VTlRQUklDRSA9IHBMaXN0W2ldLmRpc2NvdW50UHJpY2U7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHJlbWFya0Fyci5sZW5ndGg7IGorKykge1xyXG4gICAgICAgICAgICBpZiAocExpc3RbaV0uTE9HSVNUSUNTID09IHJlbWFya0FycltqXS5uYW1lZW4pIHtcclxuICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZW1hcmtBcnJbal0ucmVtYXJrKTtcclxuICAgICAgICAgICAgICBwTGlzdFtpXS53dWxpdVJlbWFyayA9IHJlbWFya0FycltqXS5yZW1hcms7XHJcbiAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICAgIC8vIOeJqea1geivleeul+e7hOS7tueUqFxyXG4gICAgICAgICAgcExpc3RbaV0uc2hpcGluZm8gPSB7XHJcbiAgICAgICAgICAgIHdlaWdodDogcExpc3RbaV0ucGFja3dlaWdodCxcclxuICAgICAgICAgICAgZW5OYW1lOiBwTGlzdFtpXS5MT0dJU1RJQ1MsXHJcbiAgICAgICAgICAgIHBpZDogcExpc3RbaV0uUElELFxyXG4gICAgICAgICAgICBzaG9wVHlwZTogcExpc3RbaV0uc2hvcFR5cGUsXHJcbiAgICAgICAgICAgIHNoaXBEaXNjb3VudDogcExpc3RbaV0uRlJFSUdIVERJU0NPVU5ULFxyXG4gICAgICAgICAgICBhcmVhQ291bnRyeUNvZGU6IHBMaXN0W2ldLmFyZWFDb3VudHJ5Q29kZSxcclxuICAgICAgICAgICAgaW5kZXgxOiBpXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgICRzY29wZS5jb25saXN0ID0gcExpc3Q7XHJcbiAgICAgICAgY29uc29sZS5sb2coJHNjb3BlLmNvbmxpc3QpO1xyXG4gICAgICAgICRzY29wZS5jb25Ub3RhbFBhZ2UgPSBNYXRoLmNlaWwoKCRzY29wZS5jb25Ub3RhbE51bSAqIDEpIC8gKCRzY29wZS5jb25wYWdlc2l6ZSAqIDEpKTtcclxuICAgICAgfVxyXG4gICAgICAvLyDnianmtYHor5Xnrpfnu4Tku7bov5Tlm57lgLzmjqXmlLZcclxuICAgICAgJHNjb3BlLiRvbignc2F2ZVNoaXBQcmljZScsIGZ1bmN0aW9uIChkLCBkYXRhKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coZGF0YSlcclxuICAgICAgICBpZiAoZGF0YS5pbmRleDIgPj0gMCAmJiBkYXRhLmluZGV4MSA+PSAwKSB7XHJcbiAgICAgICAgICBpZiAoZGF0YS5zaGlwRGlzY291bnRQcmljZSkge1xyXG4gICAgICAgICAgICAkc2NvcGUuY29ubGlzdFtkYXRhLmluZGV4MV0udmFyaWVudExpc3RbZGF0YS5pbmRleDJdLmlzUHJvQW1vdW50VGlwID0gZmFsc2VcclxuICAgICAgICAgIH1cclxuICAgICAgICAgICRzY29wZS5jb25saXN0W2RhdGEuaW5kZXgxXS52YXJpZW50TGlzdFtkYXRhLmluZGV4Ml0uQU1PVU5UUFJJQ0UgPSBkc3AuY2FjdUFtb3VudCgkc2NvcGUuY29ubGlzdFtkYXRhLmluZGV4MV0udmFyaWVudExpc3RbZGF0YS5pbmRleDJdLmRpc2NvdW50UHJpY2UsIGRhdGEuc2hpcERpc2NvdW50UHJpY2UgfHwgMCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGlmIChkYXRhLnNoaXBEaXNjb3VudFByaWNlKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5jb25saXN0W2RhdGEuaW5kZXgxXS5pc1Byb0Ftb3VudFRpcCA9IGZhbHNlXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICAkc2NvcGUuY29ubGlzdFtkYXRhLmluZGV4MV0uQU1PVU5UUFJJQ0UgPSBkc3AuY2FjdUFtb3VudCgkc2NvcGUuY29ubGlzdFtkYXRhLmluZGV4MV0uZGlzY291bnRQcmljZSwgZGF0YS5zaGlwRGlzY291bnRQcmljZSB8fCAwKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAkc2NvcGUuJGFwcGx5KClcclxuICAgICAgICB9KVxyXG4gICAgICB9KVxyXG5cclxuICAgICAgZnVuY3Rpb24gamllY2h1Z3VhbmxpYW4obikge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKG4uZGF0YSk7XHJcbiAgICAgICAgdmFyIG9iaiA9IEpTT04ucGFyc2Uobi5kYXRhLnJlc3VsdCk7XHJcbiAgICAgICAgJHNjb3BlLmNvbm5lY3RlZGxpc3QgPSBvYmo7XHJcbiAgICAgICAgJHNjb3BlLmNvblRvdGFsTnVtID0gb2JqLnRvdGFsO1xyXG4gICAgICAgIGlmICgkc2NvcGUuY29uVG90YWxOdW0gPT0gMCkge1xyXG4gICAgICAgICAgJHNjb3BlLmNvblRvdGFsUGFnZSA9IDA7XHJcbiAgICAgICAgICAkc2NvcGUuY29ubGlzdCA9IFtdO1xyXG4gICAgICAgICAgJHNjb3BlLm5vdERhdGFGb3VuZCA9IHRydWU7XHJcbiAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHNldHRsZURhdGEob2JqKTtcclxuICAgICAgICAkc2NvcGUuJGJyb2FkY2FzdCgncGFnZS1kYXRhJywge1xyXG4gICAgICAgICAgcGFnZU51bTogKyRzY29wZS5jb25wYWdlbnVtLFxyXG4gICAgICAgICAgdG90YWxOdW06ICRzY29wZS5jb25Ub3RhbFBhZ2UsXHJcbiAgICAgICAgICB0b3RhbENvdW50czogKyRzY29wZS5jb25Ub3RhbE51bSxcclxuICAgICAgICAgIHBhZ2VTaXplOiAkc2NvcGUuY29ucGFnZXNpemUsXHJcbiAgICAgICAgICBwYWdlc2l6ZUxpc3Q6IFsnMTAnLCAnMjAnLCAnNTAnXVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICAgICRzY29wZS4kb24oJ3BhZ2VkYXRhLWZhJywgZnVuY3Rpb24gKGQsIGRhdGEpIHsvL+WIhumhteWIh+aNouaVsOaNruebkeWQrFxyXG4gICAgICAgICRzY29wZS5jb25wYWdlbnVtID0gZGF0YS5wYWdlTnVtO1xyXG4gICAgICAgICRzY29wZS5jb25wYWdlc2l6ZSA9IGRhdGEucGFnZVNpemU7XHJcbiAgICAgICAgZ2V0Q29ubmVjdGVkTGlzdCgpO1xyXG4gICAgICB9KVxyXG4gICAgICAvL+aQnOe0olxyXG4gICAgICAkc2NvcGUuc2VhcmNoc2hvcCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAkc2NvcGUuY29ucGFnZW51bSA9ICcxJztcclxuICAgICAgICBnZXRDb25uZWN0ZWRMaXN0KCk7XHJcbiAgICAgIH1cclxuICAgICAgJHNjb3BlLmVudGVyU2VhcmNoID0gZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgaWYgKGV2ZW50LmtleUNvZGUgPT0gXCIxM1wiKSB7XHJcbiAgICAgICAgICAkc2NvcGUuc2VhcmNoc2hvcCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICAvL+avj+mhteaVsOaNruadoeaVsOaUueWPmOeahOaXtuWAmVxyXG4gICAgICAkc2NvcGUuY29ucGFnZWNoYW5nZSA9IGZ1bmN0aW9uIChwYWdlc2l6ZSkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKHBhZ2VzaXplKVxyXG4gICAgICAgICRzY29wZS5jb25wYWdlc2l6ZSA9IHBhZ2VzaXplO1xyXG4gICAgICAgICRzY29wZS5jb25wYWdlbnVtID0gJzEnO1xyXG4gICAgICAgIGdldENvbm5lY3RlZExpc3QoKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy/ovpPlhaXpobXnoIHmlbDot7PovaxcclxuICAgICAgJHNjb3BlLmNvbnBhZ2VudW1jaGFuZ2UgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgJHNjb3BlLmNvbnBhZ2VudW0gPSAkc2NvcGUuY29ucGFnZW51bSAqIDE7XHJcbiAgICAgICAgaWYgKCRzY29wZS5jb25wYWdlbnVtID4gJHNjb3BlLmNvblRvdGFsUGFnZSB8fCAkc2NvcGUuY29ucGFnZW51bSA8IDEpIHJldHVybjtcclxuICAgICAgICBjb25zb2xlLmxvZygkc2NvcGUuY29ucGFnZW51bSlcclxuICAgICAgICBnZXRDb25uZWN0ZWRMaXN0KCk7XHJcbiAgICAgIH1cclxuICAgICAgLy/lupfpk7rpgInmi6lcclxuICAgICAgJHNjb3BlLnNlYXJjaHNob3Bjb25uZWN0ID0gZnVuY3Rpb24gKG4pIHtcclxuICAgICAgICBpZiAobiA9PSBudWxsKSB7XHJcbiAgICAgICAgICBuID0gJyc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnNvbGUubG9nKG4pXHJcbiAgICAgICAgJHNjb3BlLmNvbnNob3BpZCA9IG47XHJcbiAgICAgICAgJHNjb3BlLnNlbGVjdHNob3BpbmZvID0gbjtcclxuICAgICAgICBnZXRDb25uZWN0ZWRMaXN0KCk7XHJcblxyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyDlsZXlvIDlj5jkvZPor6bmg4VcclxuICAgICAgJHNjb3BlLnNob3dWYXJpZW50ID0gZnVuY3Rpb24gKGl0ZW0sIGluZGV4KSB7XHJcbiAgICAgICAgJHNjb3BlLk1hbmFnZW1lbnQgPSBbXTtcclxuICAgICAgICBkc3AucG9zdEZ1bignYXBwL2Nvbm5lY3Rpb24vY29uTGlzdGRhdGVpbGwnLCB7XHJcbiAgICAgICAgICBcImRhdGFcIjogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgICAgICBhY2NwaWQ6IGl0ZW0uQUNDUElELFxyXG4gICAgICAgICAgICBzaG9wSWQ6IGl0ZW0uc2hvcElkXHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgIH0sIGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICB2YXIgZGF0YSA9IGRhdGEuZGF0YTtcclxuICAgICAgICAgIGlmIChkYXRhLnN0YXR1c0NvZGUgIT0gJzIwMCcpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHZhciB2YXJpZW50TGlzdCA9IEpTT04ucGFyc2UoZGF0YS5yZXN1bHQpLmNvbkxpc3Q7XHJcblxyXG4gICAgICAgICAgJHRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHZhcmllbnRMaXN0Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgdmFyaWVudExpc3RbaV0uZGlzY291bnRQcmljZSA9IGRzcC5jYWN1RGlzY291bnQodmFyaWVudExpc3RbaV0uU0VMTFBSSUNFLCB2YXJpZW50TGlzdFtpXS5TRUxMRElTQ09VTlQpO1xyXG4gICAgICAgICAgICAgIHZhcmllbnRMaXN0W2ldLmRlY291bnRyeSA9IG51bGw7XHJcbiAgICAgICAgICAgICAgdmFyaWVudExpc3RbaV0uZGVsdFByaWNlID0gMDtcclxuICAgICAgICAgICAgICB2YXJpZW50TGlzdFtpXS5kaXNjb3VudFByaWNlU2hpcCA9IDA7XHJcbiAgICAgICAgICAgICAgdmFyaWVudExpc3RbaV0uaXNjaGVjayA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgIGlmICh2YXJpZW50TGlzdFtpXS5kZWx0UHJpY2UpIHtcclxuICAgICAgICAgICAgICAgIHZhcmllbnRMaXN0W2ldLmRpc2NvdW50UHJpY2VTaGlwID0gZHNwLmNhY3VEaXNjb3VudCh2YXJpZW50TGlzdFtpXS5kZWx0UHJpY2UsIHZhcmllbnRMaXN0W2ldLkZSRUlHSFRESVNDT1VOVCk7XHJcbiAgICAgICAgICAgICAgICB2YXJpZW50TGlzdFtpXS5BTU9VTlRQUklDRSA9IGRzcC5jYWN1QW1vdW50KHZhcmllbnRMaXN0W2ldLmRpc2NvdW50UHJpY2UsIHZhcmllbnRMaXN0W2ldLmRpc2NvdW50UHJpY2VTaGlwKTtcclxuICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdmFyaWVudExpc3RbaV0uZGlzY291bnRQcmljZVNoaXAgPSAnJztcclxuICAgICAgICAgICAgICAgIHZhcmllbnRMaXN0W2ldLkFNT1VOVFBSSUNFID0gdmFyaWVudExpc3RbaV0uZGlzY291bnRQcmljZTtcclxuICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgIC8vIOWxleekuuWPmOS9k+WxnuaAp1xyXG4gICAgICAgICAgICAgIGlmKHZhcmllbnRMaXN0W2ldLnZhcmlhbnRrZXkpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGN1clZhcmllbnRWYWwgPSBBcnJheS5pc0FycmF5KHZhcmllbnRMaXN0W2ldLnZhcmlhbnRrZXkpID8gdmFyaWVudExpc3RbaV0udmFyaWFudGtleSA6IHZhcmllbnRMaXN0W2ldLnZhcmlhbnRrZXkuc3BsaXQoJy0nKTtcclxuICAgICAgICAgICAgICAgIHZhcmllbnRMaXN0W2ldLnZhcmllbnRTdHIgPSBjdXJWYXJpZW50VmFsLmpvaW4oJzsgJyk7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgIC8vIOeJqea1geivleeul+e7hOS7tueUqFxyXG4gICAgICAgICAgICAgIHZhcmllbnRMaXN0W2ldLnNoaXBpbmZvID0ge1xyXG4gICAgICAgICAgICAgICAgd2VpZ2h0OiB2YXJpZW50TGlzdFtpXS5QQUNLV0VJR0hULFxyXG4gICAgICAgICAgICAgICAgZW5OYW1lOiB2YXJpZW50TGlzdFtpXS5MT0dJU1RJQ1MsXHJcbiAgICAgICAgICAgICAgICBwaWQ6IHZhcmllbnRMaXN0W2ldLlBJRCxcclxuICAgICAgICAgICAgICAgIHNob3BUeXBlOiBpdGVtLnNob3BUeXBlLFxyXG4gICAgICAgICAgICAgICAgc2hpcERpc2NvdW50OiB2YXJpZW50TGlzdFtpXS5GUkVJR0hURElTQ09VTlQsXHJcbiAgICAgICAgICAgICAgICBhcmVhQ291bnRyeUNvZGU6ICRzY29wZS5jb25saXN0W2luZGV4XS5hcmVhQ291bnRyeUNvZGUsXHJcbiAgICAgICAgICAgICAgICBpbmRleDE6IGluZGV4LFxyXG4gICAgICAgICAgICAgICAgaW5kZXgyOiBpXHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHZhcmllbnRMaXN0KTtcclxuICAgICAgICAgICAgJHNjb3BlLmNvbmxpc3RbaW5kZXhdLnZhcmllbnRMaXN0ID0gdmFyaWVudExpc3Q7XHJcbiAgICAgICAgICAgICQoJy5tZWRpYScpLmVxKGluZGV4KS5maW5kKCcuYXNqLXByby1ib3gnKS5oaWRlKCk7XHJcbiAgICAgICAgICAgICQoJy5tZWRpYScpLmVxKGluZGV4KS5jc3MoeyAncGFkZGluZy1ib3R0b20nOiAnMjVweCcsICdiYWNrZ3JvdW5kJzogJyNmOGY4ZjgnIH0pO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygkc2NvcGUuY29ubGlzdClcclxuICAgICAgICAgICAgJHNjb3BlLnNob3dGbGFnID0gJHNjb3BlLmNvbmxpc3QuZmlsdGVyKGZ1bmN0aW9uIChpdGVtKSB7XHJcbiAgICAgICAgICAgICAgaWYgKGl0ZW0udmFyaWVudExpc3QgJiYgaXRlbS52YXJpZW50TGlzdC5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIGdldENoZWNrTGlzdCgpO1xyXG4gICAgICAgICAgfSlcclxuICAgICAgICB9KVxyXG4gICAgICB9O1xyXG4gICAgICAvLyDojrflj5blj5jkvZPpgInmi6nliJfooahcclxuICAgICAgZnVuY3Rpb24gZ2V0Q2hlY2tMaXN0KCl7XHJcbiAgICAgICAgY29uc3QgY2hlY2tMID0gW107XHJcbiAgICAgICAgJHNjb3BlLmNvbmxpc3QuZm9yRWFjaChfdj0+e1xyXG4gICAgICAgICAgaWYoX3YudmFyaWVudExpc3Qpe1xyXG4gICAgICAgICAgICBfdi52YXJpZW50TGlzdC5mb3JFYWNoKF9jdj0+e1xyXG4gICAgICAgICAgICAgIGlmKF9jdi5pc2NoZWNrKXtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHtzaG9wSWQsTkFNRUVOLHByaWNlcyxQQUNLV0VJR0hULHNob3BOYW1lLFNLVSxWSUQsQUNDUElELHZza3UsQUNDVklEfSA9IF9jdjtcclxuICAgICAgICAgICAgICAgIGNoZWNrTC5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgc2hvcE5hbWUsc2hvcElkLE5BTUVFTixwcmljZXMsU0tVLFZJRCxBQ0NQSUQsdnNrdSxBQ0NWSUQsXHJcbiAgICAgICAgICAgICAgICAgIHNob3BUeXBlOl92LnNob3BUeXBlLFxyXG4gICAgICAgICAgICAgICAgICBQSUQ6JycsXHJcbiAgICAgICAgICAgICAgICAgIHBhY2t3ZWlnaHQ6UEFDS1dFSUdIVCxcclxuICAgICAgICAgICAgICAgICAgdHlwZTogXCIxXCIsXHJcbiAgICAgICAgICAgICAgICAgIHNrdTpTS1UsXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgIH1lbHNlIGlmKF92LmlzY2hlY2spe1xyXG4gICAgICAgICAgICBjb25zdCB7UElELHNob3BJZCxOQU1FRU4scHJpY2VzLHBhY2t3ZWlnaHQsc2hvcE5hbWUsU0tVLFZJRCxBQ0NQSUQsQUNDVklELHNob3BUeXBlfSA9IF92O1xyXG4gICAgICAgICAgICBjaGVja0wucHVzaCh7XHJcbiAgICAgICAgICAgICAgc2hvcE5hbWUsc2hvcElkLE5BTUVFTixwcmljZXMsU0tVLFZJRCxQSUQscGFja3dlaWdodCxBQ0NQSUQsQUNDVklELHNob3BUeXBlLFxyXG4gICAgICAgICAgICAgIFZJRDonJywvL+WBh+iuvuaYr+WVhuWTgeWIl+ihqO+8jOWImeaKiuWPmOS9k2lk572u5Li656m6XHJcbiAgICAgICAgICAgICAgdHlwZTogXCIxXCIsXHJcbiAgICAgICAgICAgICAgc2t1OlNLVSxcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgICAgIGNvbnNvbGUubG9nKFwiY2hlY2tMPT09XCIsY2hlY2tMKVxyXG4gICAgICAgICRzY29wZS5jaGVja0xpc3QgPSBjaGVja0w7XHJcbiAgICAgICAgJHNjb3BlLmlzQ29ubmVjdGlvbiA9IGNoZWNrTC5sZW5ndGggPiAwO1xyXG4gICAgICAgICRzY29wZS5zaG93RmxhZyA9ICRzY29wZS5jaGVja0xpc3Q7XHJcbiAgICAgIH1cclxuICAgICAgLy/lj5jkvZPliJfooahcclxuICAgICAgJHNjb3BlLk1hbmFnZW1lbnQgPSBbXVxyXG4gICAgICAkc2NvcGUuY2hlY2hlZCA9IGZ1bmN0aW9uIChpdGVtViwgaWR4KSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coaXRlbVYpXHJcbiAgICAgICAgaXRlbVYuaXNjaGVjayA9ICFpdGVtVi5pc2NoZWNrO1xyXG4gICAgICAgIGdldENoZWNrTGlzdCgpO1xyXG4gICAgICB9O1xyXG4gICAgICAvLyDlkIzmraXlupPlrZjliLDlupfpk7pcclxuICAgICAgJHNjb3BlLmZ1bGZpbCA9ICcxJztcclxuICAgICAgJHNjb3BlLkxldmVscyA9ICcxJztcclxuICAgICAgJHNjb3BlLmZ1bGZpbGxtZW50RnVuID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICgkc2NvcGUuY2hlY2tMaXN0Lmxlbmd0aCA9PSAwKSByZXR1cm4gbGF5ZXIubXNnKCdQbGVhc2Ugc2VsZWN0IGEgcHJvZHVjdCcpO1xyXG4gICAgICAgIGxldCBpc1NhbWUgPSB0cnVlLGlzU2hvcGlmeT10cnVlO1xyXG4gICAgICAgIGNvbnN0IHNob3BOYW1lID0gJHNjb3BlLmNoZWNrTGlzdFswXS5zaG9wTmFtZTtcclxuICAgICAgICAkc2NvcGUuY2hlY2tMaXN0LnNvbWUoX3Y9PntcclxuICAgICAgICAgIGlmKF92LnNob3BOYW1lIT1zaG9wTmFtZSkgaXNTYW1lPWZhbHNlO1xyXG4gICAgICAgICAgaWYoX3Yuc2hvcFR5cGUhPT0nc2hvcGlmeScpaXNTaG9waWZ5PWZhbHNlO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgaWYoIWlzU2FtZSkgcmV0dXJuIGxheWVyLm1zZygnUGxlYXNlIHNlbGVjdCB0aGUgaXRlbSB1bmRlciB0aGUgc2FtZSBzdG9yZScpO1xyXG4gICAgICAgIGlmKCFpc1Nob3BpZnkpIHJldHVybiBsYXllci5tc2coJ0NKIEZ1bGZpbGxtZW50IGlzIG9ubHkgYXZhaWxhYmxlIHRvIFNob3BpZnkgc3RvcmVzJyk7XHJcbiAgICAgICAgJHNjb3BlLmlzQ0pNYW5hZ2VtZW50ID0gdHJ1ZTtcclxuICAgICAgICAkc2NvcGUuWUNKTWFuYWdlbWVudCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgIGNvbnN0IHNob3BOYW1lID0gJHNjb3BlLmNoZWNrTGlzdFswXS5zaG9wTmFtZTtcclxuICAgICAgICAgIGNvbnN0IHNob3BJZCA9ICRzY29wZS5jaGVja0xpc3RbMF0uc2hvcElkO1xyXG4gICAgICAgICAgbGV0IHNrdXMgPSBbXTtcclxuICAgICAgICAgIGxldCBhY2NQaWRzID0gW107XHJcbiAgICAgICAgICAkc2NvcGUuY2hlY2tMaXN0LmZvckVhY2goKG8pPT57XHJcbiAgICAgICAgICAgIGlmKCFvLlBJRCl7XHJcbiAgICAgICAgICAgICAgc2t1cy5wdXNoKHsgdmlkOiBvLkFDQ1ZJRCwgc2t1OiBvLnZza3UgfSlcclxuICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgYWNjUGlkcy5wdXNoKG8uQUNDUElEKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgfSlcclxuICAgICAgICAgIHZhciB1cmwgPSAncGxhdGZvcm0tcHJvZHVjdC9mdWxmaWxsbWVudC9mdWxmaWxsbWVudFNldHRpbmcnO1xyXG4gICAgICAgICAgdmFyIHBhcm1zID0ge1xyXG4gICAgICAgICAgICBmdWxmaWxsbWVudHNlcnZpY2U6ICRzY29wZS5mdWxmaWwgPT0gJzEnID8gJ2NqZHJvcHNoaXBwaW5nJyA6IG51bGwsXHJcbiAgICAgICAgICAgIGludmVudG9yeU1hbmFnZW1lbnQ6ICRzY29wZS5MZXZlbHMgPT0gJzEnID8gJ2NqZHJvcHNoaXBwaW5nJyA6IG51bGwsXHJcbiAgICAgICAgICAgIHNob3BOYW1lLFxyXG4gICAgICAgICAgICBzaG9wSWQsXHJcbiAgICAgICAgICAgIGFjY1BpZHMsXHJcbiAgICAgICAgICAgIHNrdXNcclxuICAgICAgICAgIH07XHJcbsKgwqDCoMKgwqDCoMKgwqAgIGNvbnN0wqBtc2dMb2FkaW5nwqA9wqBjak1lc3NhZ2UubG9hZGluZyh7wqBpc0ZpeGVkOiB0cnVlfSk7XHJcbiAgICAgICAgICBkc3AucG9zdEZ1bih1cmwsIHBhcm1zLCBmdW5jdGlvbiAocmVzKSB7XHJcbiAgICAgICAgICAgIG1zZ0xvYWRpbmcuaGlkZSgpXHJcbiAgICAgICAgICAgIGlmIChyZXMuZGF0YS5jb2RlID09IDIwMCkge1xyXG4gICAgICAgICAgICAgICRzY29wZS5pc0NKTWFuYWdlbWVudCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgIGdldENvbm5lY3RlZExpc3QoKVxyXG4gICAgICAgICAgICAgICRzY29wZS5NYW5hZ2VtZW50ID0gW107XHJcbiAgICAgICAgICAgICAgbGF5ZXIubXNnKHJlcy5kYXRhLmRhdGEpO1xyXG4gICAgICAgICAgICB9ZWxzZSBpZihyZXMuZGF0YS5jb2RlID09IDUwMTApe1xyXG4gICAgICAgICAgICAgICRzY29wZS5pc0NKTWFuYWdlbWVudCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICRzY29wZS5zdG9yZUF1dG9FeHBpcmVQb3B1cCA9IHRydWU7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgbGF5ZXIubXNnKCdUaGUgc2VydmVyIGlzIGJ1c3kgbm93LCBwbGVhc2UgdHJ5IGFnYWluIGxhdGVyLicpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0sIGZ1bmN0aW9uIChlcnIpIHtcclxuICAgICAgICAgICAgbGF5ZXIubXNnKCdTZXJ2aWNlIGV4Y2VwdGlvbicpXHJcbiAgICAgICAgICAgIG1zZ0xvYWRpbmcuaGlkZSgpXHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoJHNjb3BlLnNob3dGbGFnWzBdLnNob3BUeXBlID09IFwic2hvcGlmeVwiKSB7XHJcbiAgICAgICAgICBjb25zdCBzaG9wTGlzdCA9ICRzY29wZS5zaG9wc2VsZWN0bGlzdC5maWx0ZXIoaXRlbSA9PiBpdGVtLklEID09ICRzY29wZS5zaG93RmxhZ1swXS5zaG9wSWQpO1xyXG4gICAgICAgICAgJHNjb3BlLnN5bmNJbnZlbnRvcnkgPSBzaG9wTGlzdFswXS5zeW5jX2ludmVudG9yeTtcclxuICAgICAgICAgIGNvbnNvbGUubG9nKHNob3BMaXN0LCAkc2NvcGUuc3luY0ludmVudG9yeSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG5cclxuICAgICAgJHNjb3BlLmhpZGVWYXJpZW50ID0gZnVuY3Rpb24gKGl0ZW0sIGluZGV4KSB7XHJcbiAgICAgICAgJHNjb3BlLk1hbmFnZW1lbnQgPSBbXTtcclxuICAgICAgICAkc2NvcGUuY29ubGlzdFtpbmRleF0udmFyaWVudExpc3QgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgJCgnLm1lZGlhJykuZXEoaW5kZXgpLmZpbmQoJy5hc2otcHJvLWJveCcpLnNob3coKTtcclxuICAgICAgICAkKCcubWVkaWEnKS5lcShpbmRleCkuY3NzKHsgJ3BhZGRpbmctYm90dG9tJzogJzAnLCAnYmFja2dyb3VuZCc6ICcjZmZmJyB9KTtcclxuICAgICAgICBnZXRDaGVja0xpc3QoKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgJHNjb3BlLmRpc2Nvbm5lY3QgPSBmdW5jdGlvbiAoaXRlbSwgaW5kZXgxLCBpbmRleDIpIHtcclxuXHJcbiAgICAgICAgJHNjb3BlLmRpc2Nvbm5lY3RQb3B1cCA9IHRydWVcclxuICAgICAgICAkc2NvcGUuaXRlbSA9IGl0ZW1cclxuICAgICAgICAkc2NvcGUuaW5kZXgxID0gaW5kZXgxXHJcbiAgICAgICAgJHNjb3BlLmluZGV4MiA9IGluZGV4MlxyXG5cclxuICAgICAgfVxyXG5cclxuICAgICAgJHNjb3BlLmRpc2Nvbm5lY3RDYW5jZWxGdW4gPSBmdW5jdGlvbiAocGFyYW1zKSB7XHJcbiAgICAgICAgJHNjb3BlLmRpc2Nvbm5lY3RQb3B1cCA9IGZhbHNlXHJcbiAgICAgICAgJHNjb3BlLml0ZW0gPSBudWxsXHJcbiAgICAgICAgJHNjb3BlLmluZGV4MSA9IG51bGxcclxuICAgICAgICAkc2NvcGUuaW5kZXgyID0gbnVsbFxyXG4gICAgICB9XHJcblxyXG4gICAgICAkc2NvcGUuZGlzY29ubmVjdENvbmZpcm1GdW4gPSBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgIC8vIHJldHVybiBhbGVydCgkcm9vdFNjb3BlLnNvbGRPdXRDb3VudClcclxuICAgICAgICBsZXQgeyBpdGVtLCBpbmRleDEsIGluZGV4MiB9ID0gJHNjb3BlXHJcbiAgICAgICAgdmFyIGRpc2Nvbm5lY3RVcmwsIHNlbmRTdHI7XHJcbiAgICAgICAgaWYgKGluZGV4MiA+PSAwKSB7XHJcbiAgICAgICAgICBkaXNjb25uZWN0VXJsID0gJ2FwcC9jb25uZWN0aW9uL3JlbGlldmVDb25kZXRhaWxsJztcclxuICAgICAgICAgIHNlbmRTdHIgPSB7IFwiZGF0YVwiOiBcInsnaWQnOidcIiArIGl0ZW0uaWQgKyBcIicsJ3Nob3BWaWQnOidcIiArIGl0ZW0uQUNDVklEICsgXCInLCdzaG9wSWQnOidcIiArIGl0ZW0uc2hvcElkICsgXCInfVwiIH07XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGRpc2Nvbm5lY3RVcmwgPSAnYXBwL2Nvbm5lY3Rpb24vcmVsaWV2ZUNvbic7XHJcbiAgICAgICAgICBzZW5kU3RyID0geyBcImRhdGFcIjogXCJ7J3BpZCc6J1wiICsgaXRlbS5JRCArIFwiJywnc2hvcHByb2R1Y3RJZCc6J1wiICsgaXRlbS5BQ0NQSUQgKyBcIicsJ3Nob3BJZCc6J1wiICsgaXRlbS5zaG9wSWQgKyBcIid9XCIgfTtcclxuICAgICAgICB9XHJcblxyXG7CoMKgwqDCoMKgwqDCoMKgY29uc3TCoG1zZ0xvYWRpbmfCoD3CoGNqTWVzc2FnZS5sb2FkaW5nKHvCoGlzRml4ZWQ6IHRydWXCoH0pXHJcbiAgICAgICAgZHNwLnBvc3RGdW4oZGlzY29ubmVjdFVybCwgc2VuZFN0ciwgZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgIC8vIGxheWVyLmNsb3NlQWxsKFwibG9hZGluZ1wiKVxyXG4gICAgICAgICAgbXNnTG9hZGluZy5oaWRlKCk7XHJcbiAgICAgICAgICB2YXIgZGF0YSA9IGRhdGEuZGF0YTtcclxuICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xyXG4gICAgICAgICAgaWYgKGRhdGEuc3RhdHVzQ29kZSAhPSAnMjAwJykge1xyXG4gICAgICAgICAgICBsYXllci5tc2coJ0Rpc2Nvbm5lY3QgdGhlIHByb2R1Y3RzIGZhaWxlZC4gJyk7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGxheWVyLm1zZygnRGlzY29ubmVjdGVkIFN1Y2Nlc3NmdWxseSEnKTtcclxuICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKGluZGV4MiA+PSAwKSB7XHJcbiAgICAgICAgICAgICAgJHNjb3BlLmNvbmxpc3RbaW5kZXgxXS52YXJpZW50TGlzdC5zcGxpY2UoaW5kZXgyLCAxKTtcclxuICAgICAgICAgICAgICBpZiAoJHNjb3BlLmNvbmxpc3RbaW5kZXgxXS52YXJpZW50TGlzdC5sZW5ndGggPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmNvbmxpc3Quc3BsaWNlKGluZGV4MSwgMSk7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgIGdldENvbm5lY3RlZExpc3QoKTsgLy8g5Yi35paw5pWw5o2uXHJcbiAgICAgICAgICAgICAgaWYgKGl0ZW0uU0FMRVNUQVRVUyA9PSAnNScpIHtcclxuICAgICAgICAgICAgICAgICRyb290U2NvcGUuc29sZE91dENvdW50IC09IDE7IC8vIOWvvOiIquagj+inkuagh+aVsOmHj1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSwgMTAwMCk7XHJcblxyXG4gICAgICAgICAgJHNjb3BlLmRpc2Nvbm5lY3RQb3B1cCA9IGZhbHNlXHJcbiAgICAgICAgfSwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICBtc2dMb2FkaW5nLmhpZGUoKTtcclxuICAgICAgICB9KTtcclxuXHJcblxyXG4gICAgICB9XHJcbiAgICAgIC8q5YyF6KOF55u45YWz5pON5L2cKi9cclxuICAgICAgLy8g5ZWG5ZOB5om56YeP5YWz6IGUXHJcbiAgICAgICRzY29wZS5iYXRjaEFzc29jaWF0aW9uID0gZnVuY3Rpb24gKGl0ZW0pIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhpdGVtKTtcclxuICAgICAgICBpZihpdGVtLnByb2R1Y3RUeXBlID09PSAnNScpIHtcclxuICAgICAgICAgIGxheWVyLm1zZygnUGFja2FnZXMgYXJlIG5vdCBhdmFpbGFibGUgdG8gdGhlIHByb2R1Y3QuICcpO1xyXG4gICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgaXRlbURhdGEgPSB7XHJcbiAgICAgICAgICB0eXBlOiBcIjBcIixcclxuICAgICAgICAgIHBpZDogaXRlbS5JRCxcclxuICAgICAgICAgIHNob3BJZDogaXRlbS5zaG9wSWQsXHJcbiAgICAgICAgICBOQU1FRU46IGl0ZW0uTkFNRUVOLCAvL+WVhuWTgeWQjeensFxyXG4gICAgICAgICAgU0tVOiBpdGVtLlNLVSwgIC8vIHNrdVxyXG4gICAgICAgICAgcHJpY2VzOiBpdGVtLnByaWNlcywgLy/ku7fmoLxcclxuICAgICAgICAgIHBhY2t3ZWlnaHQ6IGl0ZW0ucGFja3dlaWdodCwgLy/ph43ph49cclxuICAgICAgICAgIGNvbm5lY3RUeXBlOjEgLy8g5YWz6IGU5YyF6KOF57G75Z6LIDEg5piv5bqX6ZO65YWz6IGUXHJcbiAgICAgICAgfTtcclxuICAgICAgICBsb2NhdGlvbi5ocmVmID0gJyMvcmVsZXZhbnQtcGFja2FnaW5nLycgKyBiYXNlNjQuZW5jb2RlKEpTT04uc3RyaW5naWZ5KGl0ZW1EYXRhKSkgKyAnLzAnO1xyXG4gICAgICB9O1xyXG4gICAgICAvLyDlj5jkvZPlhbPogZTljIXoo4VcclxuICAgICAgJHNjb3BlLmFzc29jaWF0ZWRQYWNrYWdpbmcgPSBmdW5jdGlvbiAoaXRlbSkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGl0ZW0pXHJcbiAgICAgICAgaWYoaXRlbS5wcm9kdWN0VHlwZSA9PT0gJzUnKSB7XHJcbiAgICAgICAgICBsYXllci5tc2coJ1BhY2thZ2VzIGFyZSBub3QgYXZhaWxhYmxlIHRvIHRoZSBwcm9kdWN0LiAnKTtcclxuICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IGFyciA9IGl0ZW0uU1RBTkRBUkQgPyBpdGVtLlNUQU5EQVJELnNwbGl0KCcsJykgOiBbXSwgbG9uZyA9IG51bGwsIHdpZHRoID0gbnVsbCwgaGVpZ2h0ID0gbnVsbDtcclxuICAgICAgICBhcnIuZm9yRWFjaCgobywgaSkgPT4ge1xyXG4gICAgICAgICAgaWYgKG8uaW5kZXhPZignbG9uZycpICE9PSAtMSkge1xyXG4gICAgICAgICAgICBsb25nID0gby5zdWJzdHIoby5pbmRleE9mKCc9JykgKyAxLCBvLmxlbmd0aClcclxuICAgICAgICAgIH0gZWxzZSBpZiAoby5pbmRleE9mKCd3aWR0aCcpICE9PSAtMSkge1xyXG4gICAgICAgICAgICB3aWR0aCA9IG8uc3Vic3RyKG8uaW5kZXhPZignPScpICsgMSwgby5sZW5ndGgpXHJcbiAgICAgICAgICB9IGVsc2UgaWYgKG8uaW5kZXhPZignaGVpZ2h0JykgIT09IC0xKSB7XHJcbiAgICAgICAgICAgIGhlaWdodCA9IG8uc3Vic3RyKG8uaW5kZXhPZignPScpICsgMSwgby5sZW5ndGgpXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgbGV0IGl0ZW1EYXRhID0ge1xyXG4gICAgICAgICAgdHlwZTogXCIxXCIsXHJcbiAgICAgICAgICB2aWQ6IGl0ZW0uVklELFxyXG4gICAgICAgICAgc2hvcElkOiBpdGVtLnNob3BJZCxcclxuICAgICAgICAgIE5BTUVFTjogaXRlbS5OQU1FRU4sIC8v5ZWG5ZOB5ZCN56ewXHJcbiAgICAgICAgICBTS1U6IGl0ZW0uU0tVLCAgLy8gc2t1XHJcbiAgICAgICAgICBwcmljZXM6IGl0ZW0ucHJpY2VzLCAvL+S7t+agvFxyXG4gICAgICAgICAgcGFja3dlaWdodDogaXRlbS5QQUNLV0VJR0hULCAvL+mHjemHj1xyXG4gICAgICAgICAgbG9uZzogbG9uZywgLy/plb9cclxuICAgICAgICAgIHdpZHRoOiB3aWR0aCwgLy/lrr1cclxuICAgICAgICAgIGhlaWdodDogaGVpZ2h0LCAvL+mrmFxyXG5cclxuICAgICAgICB9O1xyXG4gICAgICAgIGxvY2F0aW9uLmhyZWYgPSAnIy9yZWxldmFudC1wYWNrYWdpbmcvJyArIGJhc2U2NC5lbmNvZGUoSlNPTi5zdHJpbmdpZnkoaXRlbURhdGEpKSArICcvMCc7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgICAvL+afpeeci+WMheijhVxyXG4gICAgICAgLy/ojrflj5bllYblk4Hlj5jkvZPpm4blkIhcclxuICAgICAgICRzY29wZS52aWV3UGFja2FnaW5nID0gZnVuY3Rpb24gKGl0ZW0pIHtcclxuICAgICAgICAkc2NvcGUuc2VsZWN0ZWRTaG9wSWQgPSBpdGVtLnNob3BJZFxyXG4gICAgICAgIC8vIOWmguaenOaYr+WVhuWTgeeCueWHu+eahFxyXG4gICAgICAgIGRzcC5nZXRGdW4oJ2NqL1BhY2tQcm9kdWN0L2dldFByb2R1Y3RTdGFuZExpc3Q/cGlkPScraXRlbS5QSUQrJyZ0eXBlPTEmc2hvcElkPScraXRlbS5zaG9wSWQgLCAocmVzKSA9PiB7XHJcbiAgICAgICAgICBsYXllci5jbG9zZUFsbCgnbG9hZGluZycpO1xyXG5cclxuICAgICAgICAgIGlmIChyZXMuZGF0YS5zdGF0dXNDb2RlID09PSAnMjAwJykge1xyXG4gICAgICAgICAgICAkc2NvcGUudmlld1BhY2thZ2luZ01vZGFsID0gdHJ1ZVxyXG4gICAgICAgICAgICAkc2NvcGUucHJvU3RhbmRMaXN0ID0gcmVzLmRhdGEucmVzdWx0XHJcbiAgICAgICAgICAgICQoJy5zaW5nbGVTZWxlY3QnKS5zZWxlY3QyKCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSwgKGVycikgPT4ge1xyXG4gICAgICAgICAgJHNjb3BlLnByb1N0YW5kTGlzdCA9IFtdXHJcbiAgICAgICAgICBsYXllci5jbG9zZUFsbCgnbG9hZGluZycpO1xyXG4gICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcclxuICAgICAgICB9KVxyXG5cclxuXHJcbiAgICAgICAgaWYoIWl0ZW0uSUQpe1xyXG4gICAgICAgICAgIC8vIOWmguaenOeCueWHu+eahOaYr+WPmOS9kyznm7TmjqXmn6Xor6Lor6Xlj5jkvZNcclxuICAgICAgICAgICRzY29wZS5zZWxlY3RlZFZpZCA9IGl0ZW0uVklEXHJcbiAgICAgICAgICAkc2NvcGUudmlld1BhY2thZ2luZ01vZGFsID0gdHJ1ZVxyXG4gICAgICAgICAgJHNjb3BlLm9uU2VsZWN0UGFja2FnaW5nKClcclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICAgICAgLy/pgInmi6nmn5DkuKrljIXoo4Xlj5jkvZPvvIzmn6Xor6Lor6bmg4VcclxuICAgICAgJHNjb3BlLm9uU2VsZWN0UGFja2FnaW5nID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmKCRzY29wZS5zZWxlY3RlZFZpZCl7XHJcbiAgICAgICAgICAvLyDpgInmi6nkuoblj5jkvZPvvIzmmL7npLrlj5jkvZPkuIvlhbPogZTnmoTljIXoo4XllYblk4FcclxuICAgICAgICAgIGRzcC5wb3N0RnVuKCdjai9QYWNrUHJvZHVjdC9nZXRDaGVja2VkTGlzdCcsIHt2aWQ6JHNjb3BlLnNlbGVjdGVkVmlkLHNob3BJZDokc2NvcGUuc2VsZWN0ZWRTaG9wSWR9LCAocmVzKSA9PiB7XHJcbiAgICAgICAgICAgIGxheWVyLmNsb3NlQWxsKCdsb2FkaW5nJyk7XHJcbiAgICAgICAgICAgIGlmIChyZXMuZGF0YS5zdGF0dXNDb2RlID09ICcyMDAnKSB7XHJcbiAgICAgICAgICAgICAgJHNjb3BlLnZpZENoZWNrZWRMaXN0ID0gcmVzLmRhdGEucmVzdWx0LmNoZWNrZWRMaXN0XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgJHNjb3BlLnZpZENoZWNrZWRMaXN0ID0gW11cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSwgKGVycikgPT4ge1xyXG4gICAgICAgICAgICBsYXllci5jbG9zZUFsbCgnbG9hZGluZycpO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpXHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgLy8g5rKh5pyJ6YCJ5oup77yM5YiZ5LiN6KaBXHJcbiAgICAgICAgICAkc2NvcGUudmlkQ2hlY2tlZExpc3QgPSBbXVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgICAgJHNjb3BlLmZvcm1hdGVTaXplID0gZnVuY3Rpb24oc2l6ZSkge1xyXG4gICAgICAgIGxldCBuZXdTaXplID0gU3RyaW5nKHNpemUpO1xyXG4gICAgICAgIG5ld1NpemUgPSBuZXdTaXplLnJlcGxhY2UoL0xvbmcvLCdMZW5ndGgnKTtcclxuICAgICAgICByZXR1cm4gbmV3U2l6ZTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8g5YWz6ZetIHZpZXcg5by55qGGXHJcbiAgICAgICRzY29wZS5jbG9zZVZpZXdQYWNrYWdpbmdNb2RhbCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAkc2NvcGUudmlld1BhY2thZ2luZ01vZGFsID0gZmFsc2VcclxuICAgICAgICAkc2NvcGUudmlkQ2hlY2tlZExpc3QgPSBbXVxyXG4gICAgICAgICRzY29wZS5zZWxlY3RlZFZpZCA9ICcnXHJcbiAgICAgICAgJCgnLnNpbmdsZVNlbGVjdCcpLnNlbGVjdDIoJ2Rlc3Ryb3knKTtcclxuICAgICAgfVxyXG5cclxuXHJcbiAgICAgIC8v6Kej6Zmk57uR5a6aXHJcbiAgICAgICRzY29wZS5yZW1vdmVQYXJhbXMgPSB7fTtcclxuICAgICAgJHNjb3BlLmlzVmFyaWVudCA9IGZhbHNlO1xyXG4gICAgICAkc2NvcGUudW5CaW5kID0gZnVuY3Rpb24gKGl0ZW0saXNWYXJpZW50KSB7XHJcbiAgICAgICAgJHNjb3BlLnNob3dQb3BVcHMgPSB0cnVlO1xyXG4gICAgICAgICRzY29wZS5yZW1vdmVQYXJhbXMgPSB7XHJcbiAgICAgICAgICB0eXBlOiAnMCcsXHJcbiAgICAgICAgICBwaWQ6IGl0ZW0uUElEIHx8ICcnLFxyXG4gICAgICAgICAgc2hvcElkOiBpdGVtLnNob3BJZFxyXG4gICAgICAgIH1cclxuICAgICAgICBpZihpc1ZhcmllbnQpe1xyXG4gICAgICAgICAgLy8g5aaC5p6c5bGV5byA5Y+Y5L2T77yM5YiZ5Lyg5YWl5Y+Y5L2TaWRcclxuICAgICAgICAgICRzY29wZS5yZW1vdmVQYXJhbXMudmlkPSBpdGVtLlZJRCB8fCAnJ1xyXG4gICAgICAgIH1cclxuICAgICAgfTtcclxuXHJcbiAgICAgIC8vIOiOt+WPluW8ueeql+e7hOS7tuWFs+mXreaMiemSrlxyXG4gICAgICAkc2NvcGUuJG9uKCdjbG9zZVBvcFVwcycsIChlLCBkYXRhKSA9PiB7XHJcbiAgICAgICAgJHNjb3BlLnNob3dQb3BVcHMgPSBmYWxzZTtcclxuICAgICAgfSlcclxuICAgICAgLy8g6I635Y+W5by556qX57uE5Lu256Gu5a6a5oyJ6ZKuXHJcbiAgICAgICRzY29wZS4kb24oJ2NvbmZpcm1Qb3BVcHMnLCAoZSwgZGF0YSkgPT4ge1xyXG7CoMKgwqDCoMKgwqDCoMKgY29uc3TCoG1zZ0xvYWRpbmfCoD3CoGNqTWVzc2FnZS5sb2FkaW5nKHvCoGlzRml4ZWQ6IHRydWXCoH0pO1xyXG4gICAgICAgIGRzcC5wb3N0RnVuKCdjai9QYWNrUHJvZHVjdC9kZWxDb3JyZWxhdGlvbicsICRzY29wZS5yZW1vdmVQYXJhbXMsIChyZXMpID0+IHtcclxuICAgICAgICAgIG1zZ0xvYWRpbmcuaGlkZSgpO1xyXG4gICAgICAgICAgaWYgKHJlcy5kYXRhLnN0YXR1c0NvZGUgPT0gJzIwMCcpIHtcclxuICAgICAgICAgICAgbGF5ZXIubXNnKCdSZW1vdmVkIFN1Y2Nlc3NmdWxseScpXHJcbiAgICAgICAgICAgIGdldENvbm5lY3RlZExpc3QoKTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGxheWVyLm1zZygnQmluZGluZyByZW1vdmFsIGZhaWxlZCcpXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSwgKGVycikgPT4ge1xyXG4gICAgICAgICAgbXNnTG9hZGluZy5oaWRlKCk7XHJcbiAgICAgICAgICAvLyBsYXllci5jbG9zZShpbmRleCk7XHJcbiAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpXHJcbiAgICAgICAgfSlcclxuICAgICAgICAkc2NvcGUuc2hvd1BvcFVwcyA9IGZhbHNlO1xyXG4gICAgICB9KVxyXG5cclxuICAgICAgLy8g5YWo6YCJ5omA5pyJ5ZWG5ZOBXHJcbiAgICAgICRzY29wZS5jaGVjaGVkQWxsID0gKCkgPT4ge1xyXG4gICAgICAgICRzY29wZS5pc0NoZWNrQWxsID0gISRzY29wZS5pc0NoZWNrQWxsO1xyXG4gICAgICAgICRzY29wZS5jb25saXN0LmZvckVhY2gobyA9PiB7XHJcbiAgICAgICAgICBvLmlzY2hlY2sgPSAkc2NvcGUuaXNDaGVja0FsbDtcclxuICAgICAgICAgIGlmKG8udmFyaWVudExpc3Qpe1xyXG4gICAgICAgICAgICBvLnZhcmllbnRMaXN0LmZvckVhY2goX3Y9PntcclxuICAgICAgICAgICAgICBfdi5pc2NoZWNrID0gJHNjb3BlLmlzQ2hlY2tBbGw7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgJHNjb3BlLmlzQ29ubmVjdGlvbiA9ICRzY29wZS5jb25saXN0LmZpbHRlcihvID0+IG8uaXNjaGVjaykubGVuZ3RoID4gMDtcclxuICAgICAgICBnZXRDaGVja0xpc3QoKTtcclxuICAgICAgfVxyXG5cclxuXHJcbiAgICAgIC8vIOWNlemAieWVhuWTgVxyXG4gICAgICAkc2NvcGUuY2hlY2tQcm8gPSAoaXRlbSwgaWR4KSA9PiB7XHJcbiAgICAgICAgY29uc29sZS5sb2coaXRlbSlcclxuICAgICAgICBpdGVtLmlzY2hlY2s9IWl0ZW0uaXNjaGVjaztcclxuICAgICAgICBjb25zdCBjaGVja0xlbiA9ICRzY29wZS5jb25saXN0LmZpbHRlcihvID0+IG8uaXNjaGVjaykubGVuZ3RoXHJcbiAgICAgICAgJHNjb3BlLmlzQ29ubmVjdGlvbiA9IGNoZWNrTGVuID4gMFxyXG4gICAgICAgICRzY29wZS5pc0NoZWNrQWxsID0gJHNjb3BlLmNvbmxpc3QubGVuZ3RoID09PSBjaGVja0xlbjtcclxuICAgICAgICBnZXRDaGVja0xpc3QoKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8g5om56YeP5YWz6IGU5YyF6KOFXHJcbiAgICAgICRzY29wZS5idWxrQ29ubmVjdGlvbiA9ICgpID0+IHtcclxuICAgICAgICBpZighJHNjb3BlLmNoZWNrTGlzdCB8fCAkc2NvcGUuY2hlY2tMaXN0Lmxlbmd0aD09MClyZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgY29uc3QgcGFja05hbWVzID0gICRzY29wZS5jaGVja0xpc3QubWFwKG8gPT4gKHsgXHJcbiAgICAgICAgICB0eXBlOiBcIjBcIixcclxuICAgICAgICAgIHBpZDogby5QSUQsXHJcbiAgICAgICAgICBTS1U6by5za3UsIFxyXG4gICAgICAgICAgc2hvcElkOiBvLnNob3BJZCwgXHJcbiAgICAgICAgICBOQU1FRU46IG8uTkFNRUVOLFxyXG4gICAgICAgICAgcHJpY2VzOiBvLnByaWNlcywgLy/ku7fmoLxcclxuICAgICAgICAgIHZpZDogby5WSUQsXHJcbiAgICAgICAgICBwYWNrd2VpZ2h0OiBvLnBhY2t3ZWlnaHQsIC8v6YeN6YePXHJcbiAgICAgICAgICBjb25uZWN0VHlwZToxIC8vIOWFs+iBlOWMheijheexu+WeiyAxIOaYr+W6l+mTuuWFs+iBlFxyXG4gICAgICAgIH0pKTs7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJwYWNrTmFtZXM9PT09XCIscGFja05hbWVzKVxyXG4gICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdyZWxldmFudHBhY2thZ2UnLGJhc2U2NC5lbmNvZGUoSlNPTi5zdHJpbmdpZnkocGFja05hbWVzKSkpO1xyXG4gICAgICAgIGxvY2F0aW9uLmhyZWYgPSBgIy9yZWxldmFudC1wYWNrYWdpbmcvMS8wYDtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8g5om56YeP6Kej6Zmk5YyF6KOFXHJcbiAgICAgICRzY29wZS5idWxrUmVtb3ZlQ29ubmVjdGlvbiA9ICgpID0+IHtcclxuICAgICAgICBpZighJHNjb3BlLmNoZWNrTGlzdCB8fCAkc2NvcGUuY2hlY2tMaXN0Lmxlbmd0aD09MCkgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIGlmKCRzY29wZS5jaGVja0xpc3QubGVuZ3RoPjApICRzY29wZS5iYXRjaERlbGV0ZVBvcHVwID0gdHJ1ZTtcclxuICAgICAgfVxyXG4gICAgICAvLyDmibnph4/np7vpmaTljIXoo4VcclxuICAgICAgJHNjb3BlLmJhdGNoRGVsZXRlQ29uZmlybUZ1biA9ICgpPT57XHJcbiAgICAgICAgaWYoISRzY29wZS5jaGVja0xpc3QgfHwgJHNjb3BlLmNoZWNrTGlzdC5sZW5ndGg9PTApcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIGNvbnN0IHBhcmFtcyA9ICRzY29wZS5jaGVja0xpc3QubWFwKG8gPT4gKHsgXHJcbiAgICAgICAgICBwaWQ6by5QSUQsXHJcbiAgICAgICAgICBzaG9wSWQ6by5zaG9wSWQsXHJcbiAgICAgICAgICB2aWQ6by5WSURcclxuICAgICAgICB9KSk7XHJcbiAgICAgICAgZHNwLnBvc3RGdW4oJ2NqL1BhY2tDb25uZWN0aW9uL2JhdGNoRGVsQ29ycmVsYXRpb24nLCBwYXJhbXMsIGZ1bmN0aW9uICh7ZGF0YX0pIHtcclxuICAgICAgICAgIGlmKGRhdGEuc3RhdHVzQ29kZT09JzIwMCcpe1xyXG4gICAgICAgICAgICBsYXllci5tc2coXCJCdWxrIFJlbW92ZWQgU3VjY2Vzc2Z1bGx5XCIpO1xyXG4gICAgICAgICAgfWVsc2UgaWYoZGF0YS5zdGF0dXNDb2RlPT0nMTEwMicpe1xyXG4gICAgICAgICAgICBsYXllci5tc2coXCJZb3UncmUgbm90IGF1dGhvcml6ZWQgdG8gZGVsZXRlIHRoZSBwYWNrYWdpbmcsIHBsZWFzZSBjb250YWN0IHlvdXIgYWdlbnQgZm9yIG1vcmUgaW5mb3JtYXRpb25cIik7XHJcbiAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgbGF5ZXIubXNnKFwiQnVsayBSZW1vdmluZyBGYWlsZWRcIik7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICAkc2NvcGUuYmF0Y2hEZWxldGVQb3B1cCA9IGZhbHNlO1xyXG4gICAgICAgIH0pXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8qIOS/ruaUuem7mOiupOeJqea1gSAqL1xyXG4gICAgICAkc2NvcGUuc2V0dGluZ0xvZ2lzdGljVmlzaWJsZSA9IGZhbHNlO1xyXG4gICAgICAkc2NvcGUuc2V0dGluZ0xvZ2lzdGljTGlzdCA9IFtdO1xyXG4gICAgICAkc2NvcGUuc2V0dGluZ0NvdW50cnkgPSBbXTtcclxuICAgICAgJHNjb3BlLmN1cnJlbnRQcm9EYXRhID0gbnVsbDtcclxuICAgICAgJHNjb3BlLmN1cnJlbnRWYXJEYXRhID0gbnVsbDtcclxuXHJcbiAgICAgICRzY29wZS5pbml0U2V0dGluZ0xvZ2lzdGljID0gKGl0ZW0sIGl0ZW1Qcm9kdWN0LGluZGV4KSA9PiB7XHJcbiAgICAgICAgJHNjb3BlLmN1cnJlbnRJbmRleCA9IGluZGV4O1xyXG4gICAgICAgICRzY29wZS5jdXJyZW50UHJvRGF0YSA9IGl0ZW1Qcm9kdWN0O1xyXG4gICAgICAgICRzY29wZS5jdXJyZW50VmFyRGF0YSA9IGl0ZW07XHJcbiAgICAgICAgJHNjb3BlLnNldHRpbmdMb2dpc3RpY1Zpc2libGUgPSB0cnVlO1xyXG4gICAgICAgIGRzcC5nZXRBcmVhQnlQaWQoaXRlbS5QSUQsIGZ1bmN0aW9uIChyZXMpIHtcclxuICAgICAgICAgICRzY29wZS5zZXR0aW5nQ291bnRyeSA9IHJlcztcclxuICAgICAgICAgICRzY29wZS5jdXJyZW50Q291bnRyeSA9IGl0ZW0uYXJlYUNvdW50cnlDb2RlO1xyXG4gICAgICAgICAgZHNwLmdldFNoaXBMaXN0TmV3KHtcclxuICAgICAgICAgICAgICBwbGF0Rm9ybXM6IGl0ZW0uc2hvcFR5cGUgfHwgW10sXHJcbiAgICAgICAgICAgICAgc3RhcnRDb3VudHJ5Q29kZTogaXRlbS5hcmVhQ291bnRyeUNvZGUsXHJcbiAgICAgICAgICAgICAgd2VpZ2h0SW50ZXJ2YWw6IGl0ZW0ucGFja3dlaWdodCxcclxuICAgICAgICAgICAgICBwcm9wZXJ0eXM6IGl0ZW1Qcm9kdWN0Lk1BVEVSSUFMS0VZLnNwbGl0KCcsJylcclxuICAgICAgICAgIH0sIGZ1bmN0aW9uIChyZXMyKSB7XHJcbiAgICAgICAgICAgICAgJHNjb3BlLnNldHRpbmdMb2dpc3RpY0xpc3QgPSByZXMyO1xyXG4gICAgICAgICAgICAgIGlmKGl0ZW0uTE9HSVNUSUNTKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuY3VycmVudExvZ2lzdGljID0gcmVzMi5maW5kKGkgPT4gaS5uYW1lRW4gPT09IGl0ZW0uTE9HSVNUSUNTKVxyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgY29uc29sZS5sb2coaXRlbSlcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgJHNjb3BlLmNoYW5nZUNvdW50cnkgPSAoY29udHJ5Q29kZSkgPT4ge1xyXG4gICAgICAgIGRzcC5nZXRTaGlwTGlzdE5ldyh7XHJcbiAgICAgICAgICAgIHBsYXRGb3JtczogJHNjb3BlLmN1cnJlbnRWYXJEYXRhLnNob3BUeXBlIHx8IFtdLFxyXG4gICAgICAgICAgICBzdGFydENvdW50cnlDb2RlOiBjb250cnlDb2RlLFxyXG4gICAgICAgICAgICB3ZWlnaHRJbnRlcnZhbDogJHNjb3BlLmN1cnJlbnRWYXJEYXRhLnBhY2t3ZWlnaHQsXHJcbiAgICAgICAgICAgIHByb3BlcnR5czogJHNjb3BlLmN1cnJlbnRQcm9EYXRhLk1BVEVSSUFMS0VZLnNwbGl0KCcsJylcclxuICAgICAgICB9LCBmdW5jdGlvbiAocmVzKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5zZXR0aW5nTG9naXN0aWNMaXN0ID0gcmVzO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvKiDkv67mlLnpu5jorqTnianmtYEgKi9cclxuICAgICAgJHNjb3BlLnN1Ym1pdENoYW5nZUxvZ2lzdGljID0gKCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGN1cnJlbnRDb3VudHJ5T2JqID0gJHNjb3BlLnNldHRpbmdDb3VudHJ5LmZpbmQoaSA9PiBpLmNvdW50cnlDb2RlID09PSAkc2NvcGUuY3VycmVudENvdW50cnkpO1xyXG4gICAgICAgIGlmKCEkc2NvcGUuY3VycmVudExvZ2lzdGljKSB7XHJcbiAgICAgICAgICByZXR1cm4gbGF5ZXIubXNnKCdQbGVhc2Ugc2VsZWN0IGxvZ2lzdGljcycpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZighJHNjb3BlLmN1cnJlbnRWYXJEYXRhKSB7XHJcbiAgICAgICAgICByZXR1cm4gbGF5ZXIubXNnKCdQbGVhc2Ugc2VsZWN0IHNoaXBwaW5nIGNvdW50cnknKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgcGFyYW1zID0ge1xyXG4gICAgICAgICAgdmlkOiAkc2NvcGUuY3VycmVudFZhckRhdGEuVklELFxyXG4gICAgICAgICAgc2hvcElkOiAkc2NvcGUuY3VycmVudFByb0RhdGEuc2hvcElkLFxyXG4gICAgICAgICAgbG9naXN0aWNzTmFtZTogJHNjb3BlLmN1cnJlbnRMb2dpc3RpYy5uYW1lRW4sXHJcbiAgICAgICAgICBhcmVhSWQ6IGN1cnJlbnRDb3VudHJ5T2JqLmFyZWFJZCxcclxuICAgICAgICAgIGFyZWFFbk5hbWU6IGN1cnJlbnRDb3VudHJ5T2JqLmFyZWFFbixcclxuICAgICAgICAgIGFyZWFDb3VudHJ5Q29kZTogY3VycmVudENvdW50cnlPYmouY291bnRyeUNvZGVcclxuICAgICAgICB9XHJcbiAgICAgICAgZHNwLnBvc3RGdW4oJ2FwcC9jb25uZWN0aW9uL3VwZGF0ZUNvblN0YW5Mb2dpc3RpY3MnLHBhcmFtcyAsZnVuY3Rpb24ocmVzKSB7XHJcbiAgICAgICAgICBjb25zb2xlLmxvZyhyZXMpXHJcbiAgICAgICAgICBpZihyZXMuZGF0YS5zdGF0dXNDb2RlID09PSAnMjAwJykge1xyXG4gICAgICAgICAgICBsYXllci5tc2coJ1NldCBzdWNjZXNzZnVsbHknKVxyXG4gICAgICAgICAgICAkc2NvcGUuc2hvd1ZhcmllbnQoJHNjb3BlLmN1cnJlbnRQcm9EYXRhLCAkc2NvcGUuY3VycmVudEluZGV4KTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGxheWVyLm1zZygnU2V0IGZhaWxlZCcpXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICAkc2NvcGUuc2V0dGluZ0xvZ2lzdGljVmlzaWJsZSA9IGZhbHNlO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICAgIC8v5YWz6Zet5o6I5p2D6L+H5pyf5o+Q56S6XHJcbiAgICAgICRzY29wZS5jbG9zZVN0b3JlQXV0b0V4cGlyZSA9ICgpPT57XHJcbiAgICAgICAgJHNjb3BlLnN0b3JlQXV0b0V4cGlyZVBvcHVwID0gZmFsc2U7XHJcbiAgICAgICAgZ2V0Q29ubmVjdGVkTGlzdCgpO1xyXG4gICAgICB9XHJcbiAgICAgIC8v5o6I5p2D6L+H5pyf6Lez6L2s5Yiwc2hvcGlmeeaOiOadg+WIl+ihqOmhtemdolxyXG4gICAgICAkc2NvcGUuc3RvcmVBdXRvRXhwaXJlQ29uZmlybUZ1biA9ICgpPT57XHJcbiAgICAgICAgbG9jYXRpb24uaHJlZj1cIi9teUNKLmh0bWwjL2F1dGhvcml6ZS9TaG9waWZ5XCI7XHJcbiAgICAgIH1cclxuICAgIH1dKTtcclxuXHJcbiAgYXBwLmRpcmVjdGl2ZSgncmVwZWF0RmluaXNoJywgZnVuY3Rpb24gKCR0aW1lb3V0KSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICByZXN0cmljdDogJ0EnLFxyXG4gICAgICBsaW5rOiBmdW5jdGlvbiAoc2NvcGUsIGVsZW0sIGF0dHIpIHtcclxuICAgICAgICAvL+W9k+WJjeW+queOr+iHs+acgOWQjuS4gOS4qlxyXG4gICAgICAgIGlmIChzY29wZS4kbGFzdCA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAvL+WQkeeItuaOp+WItuWZqOS8oOmAkuS6i+S7tua2iOaBr1xyXG4gICAgICAgICAgICBzY29wZS4kZW1pdCgncmVwZWF0RmluaXNoQ2FsbGJhY2snKTtcclxuICAgICAgICAgICAgdmFyIGl0ZW1Ub3AgPSAkKFwiI2Rvd24tYmF0Y2gwXCIpLm9mZnNldCgpLnRvcDtcclxuICAgICAgICAgICAgdmFyIGl0ZW1MZWZ0ID0gJChcIiNkb3duLWJhdGNoMFwiKS5vZmZzZXQoKS5sZWZ0O1xyXG4gICAgICAgICAgICB2YXIgaXRlbVRvcDEgPSAkKFwiI2lucHV0LXlkMFwiKS5vZmZzZXQoKS50b3A7XHJcbiAgICAgICAgICAgIHZhciBpdGVtTGVmdDEgPSAkKFwiI2lucHV0LXlkMFwiKS5vZmZzZXQoKS5sZWZ0O1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhpdGVtVG9wLCBpdGVtTGVmdCwgaXRlbVRvcDEsIGl0ZW1MZWZ0MSlcclxuICAgICAgICAgICAgaWYgKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdmd1N0dScpID09ICdkb3duQmF0Y2gnKSB7XHJcbiAgICAgICAgICAgICAgJCgnLmZpci16aGlkYW8nKS5jc3Moe1xyXG4gICAgICAgICAgICAgICAgdG9wOiBpdGVtVG9wIC0gNSxcclxuICAgICAgICAgICAgICAgIGxlZnQ6IGl0ZW1MZWZ0IC0gNlxyXG4gICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgJCgnLnNlYy16aGlkYW8nKS5jc3Moe1xyXG4gICAgICAgICAgICAgICAgdG9wOiBpdGVtVG9wMSAtIDExLFxyXG4gICAgICAgICAgICAgICAgbGVmdDogaXRlbUxlZnQxIC0gOFxyXG4gICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0sIDEwMCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfSk7XHJcblxyXG4gIHJldHVybiBhcHA7XHJcblxyXG59XHJcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQTtBQUdBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUEE7QUFTQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEE7QUFPQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBREE7QUFNQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVJBO0FBVUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFOQTtBQVFBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBREE7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFOQTtBQVFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFGQTtBQUFBO0FBQUE7QUFJQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFUQTtBQVVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBWEE7QUFhQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFWQTtBQUFBO0FBVUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBQUE7QUFLQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQU1BO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBTUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBREE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU5BO0FBUUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBMUJBO0FBNEJBO0FBRUE7QUFFQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///../src/pages/mycj/connection/connection.js\n");

/***/ }),

/***/ "../src/pages/mycj/mycj-common.js":
/*!****************************************!*\
  !*** ../src/pages/mycj/mycj-common.js ***!
  \****************************************/
/*! exports provided: pageFun, pageFunWithParams */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"pageFun\", function() { return pageFun; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"pageFunWithParams\", function() { return pageFunWithParams; });\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\n//分页\nfunction pageFun($scope) {\n  var changeCb = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : function () {};\n\n  if (_typeof($scope) !== 'object') {\n    console.error('参数 $scope 错误', $scope);\n    return;\n  }\n\n  $(\".page-index\").jqPaginator({\n    totalCounts: $scope.totalPageNum,\n    pageSize: $scope.pageSize * 1,\n    visiblePages: 5,\n    currentPage: $scope.pageNum * 1,\n    activeClass: 'current',\n    prev: '<a class=\"prev\" href=\"javascript:void(0);\">&lt;<\\/a>',\n    next: '<a class=\"next\" href=\"javascript:void(0);\">&gt;<\\/a>',\n    page: '<a href=\"javascript:void(0);\">{{page}}<\\/a>',\n    first: '<a class=\"prev\" href=\"javascript:void(0);\">&lt&lt;<\\/a>',\n    last: '<a class=\"prev\" href=\"javascript:void(0);\">&gt&gt;<\\/a>',\n    onPageChange: function onPageChange(n, type) {\n      if (type == 'init') return;\n      changeCb(n);\n    }\n  });\n}\n; //分页\n\nfunction pageFunWithParams(node) {\n  var totalnum = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n  var pagesize = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 10;\n  var currentnum = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 1;\n  var change = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : function () {};\n  console.log(totalnum, pagesize, currentnum);\n  node.jqPaginator({\n    totalCounts: +totalnum,\n    pageSize: +pagesize,\n    visiblePages: 5,\n    currentPage: +currentnum,\n    activeClass: 'current',\n    first: '<a class=\"prev\" href=\"javascript:void(0);\">&lt;&lt;<\\/a>',\n    prev: '<a class=\"prev\" href=\"javascript:void(0);\">&lt;<\\/a>',\n    next: '<a class=\"next\" href=\"javascript:void(0);\">&gt;<\\/a>',\n    last: '<a class=\"prev\" href=\"javascript:void(0);\">&gt;&gt;<\\/a>',\n    page: '<a href=\"javascript:void(0);\">{{page}}<\\/a><\\/li>',\n    onPageChange: change\n  });\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi4vc3JjL3BhZ2VzL215Y2ovbXljai1jb21tb24uanMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi4vc3JjL3BhZ2VzL215Y2ovbXljai1jb21tb24uanM/ODUxNiJdLCJzb3VyY2VzQ29udGVudCI6WyJcclxuLy/liIbpobVcclxuZXhwb3J0IGZ1bmN0aW9uIHBhZ2VGdW4oJHNjb3BlLCBjaGFuZ2VDYiA9ICgpID0+IHt9KSB7XHJcbiAgaWYgKHR5cGVvZiAkc2NvcGUgIT09ICdvYmplY3QnKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCflj4LmlbAgJHNjb3BlIOmUmeivrycsICRzY29wZSk7XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG4gICQoXCIucGFnZS1pbmRleFwiKS5qcVBhZ2luYXRvcih7XHJcbiAgICB0b3RhbENvdW50czogJHNjb3BlLnRvdGFsUGFnZU51bSxcclxuICAgIHBhZ2VTaXplOiAkc2NvcGUucGFnZVNpemUgKiAxLFxyXG4gICAgdmlzaWJsZVBhZ2VzOiA1LFxyXG4gICAgY3VycmVudFBhZ2U6ICRzY29wZS5wYWdlTnVtICogMSxcclxuICAgIGFjdGl2ZUNsYXNzOiAnY3VycmVudCcsXHJcbiAgICBwcmV2OiAnPGEgY2xhc3M9XCJwcmV2XCIgaHJlZj1cImphdmFzY3JpcHQ6dm9pZCgwKTtcIj4mbHQ7PFxcL2E+JyxcclxuICAgIG5leHQ6ICc8YSBjbGFzcz1cIm5leHRcIiBocmVmPVwiamF2YXNjcmlwdDp2b2lkKDApO1wiPiZndDs8XFwvYT4nLFxyXG4gICAgcGFnZTogJzxhIGhyZWY9XCJqYXZhc2NyaXB0OnZvaWQoMCk7XCI+e3twYWdlfX08XFwvYT4nLFxyXG4gICAgZmlyc3Q6ICc8YSBjbGFzcz1cInByZXZcIiBocmVmPVwiamF2YXNjcmlwdDp2b2lkKDApO1wiPiZsdCZsdDs8XFwvYT4nLFxyXG4gICAgbGFzdDogJzxhIGNsYXNzPVwicHJldlwiIGhyZWY9XCJqYXZhc2NyaXB0OnZvaWQoMCk7XCI+Jmd0Jmd0OzxcXC9hPicsXHJcbiAgICBvblBhZ2VDaGFuZ2U6IGZ1bmN0aW9uIChuLCB0eXBlKSB7XHJcbiAgICAgIGlmICh0eXBlID09ICdpbml0JykgcmV0dXJuO1xyXG4gICAgICBjaGFuZ2VDYihuKTtcclxuICAgIH1cclxuICB9KTtcclxufTtcclxuXHJcbi8v5YiG6aG1XHJcbmV4cG9ydCBmdW5jdGlvbiBwYWdlRnVuV2l0aFBhcmFtcyhub2RlLCB0b3RhbG51bSA9IDEsIHBhZ2VzaXplID0gMTAsIGN1cnJlbnRudW0gPSAxLCBjaGFuZ2UgPSAoKSA9PiB7fSkge1xyXG4gIGNvbnNvbGUubG9nKHRvdGFsbnVtLCBwYWdlc2l6ZSwgY3VycmVudG51bSk7XHJcbiAgbm9kZS5qcVBhZ2luYXRvcih7XHJcbiAgICB0b3RhbENvdW50czogK3RvdGFsbnVtLFxyXG4gICAgcGFnZVNpemU6ICtwYWdlc2l6ZSxcclxuICAgIHZpc2libGVQYWdlczogNSxcclxuICAgIGN1cnJlbnRQYWdlOiArY3VycmVudG51bSxcclxuICAgIGFjdGl2ZUNsYXNzOiAnY3VycmVudCcsXHJcbiAgICBmaXJzdDogJzxhIGNsYXNzPVwicHJldlwiIGhyZWY9XCJqYXZhc2NyaXB0OnZvaWQoMCk7XCI+Jmx0OyZsdDs8XFwvYT4nLFxyXG4gICAgcHJldjogJzxhIGNsYXNzPVwicHJldlwiIGhyZWY9XCJqYXZhc2NyaXB0OnZvaWQoMCk7XCI+Jmx0OzxcXC9hPicsXHJcbiAgICBuZXh0OiAnPGEgY2xhc3M9XCJuZXh0XCIgaHJlZj1cImphdmFzY3JpcHQ6dm9pZCgwKTtcIj4mZ3Q7PFxcL2E+JyxcclxuICAgIGxhc3Q6ICc8YSBjbGFzcz1cInByZXZcIiBocmVmPVwiamF2YXNjcmlwdDp2b2lkKDApO1wiPiZndDsmZ3Q7PFxcL2E+JyxcclxuICAgIHBhZ2U6ICc8YSBocmVmPVwiamF2YXNjcmlwdDp2b2lkKDApO1wiPnt7cGFnZX19PFxcL2E+PFxcL2xpPicsXHJcbiAgICBvblBhZ2VDaGFuZ2U6IGNoYW5nZSxcclxuICB9KTtcclxufSJdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFkQTtBQWdCQTtBQUFBO0FBQ0E7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFYQTtBQWFBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///../src/pages/mycj/mycj-common.js\n");

/***/ })

}]);