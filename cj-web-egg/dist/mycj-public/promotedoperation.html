<!-- 消息中心邮件点击进入cj触发点击率记录后转发到置顶页面 -->
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="renderer" content="webkit|ie-comp|ie-stand" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <meta name="description"
    content="CJdropshipping is a platform Sourcing and Fulfilling for WED2C, Shopify, WooCommerce, eBay Dropshippers with High-Quality Products and Faster Shipping.">
  <meta name="keywords"
    content="dropshipping sourcing agent, sourcing agent dropshipping, cjdropshipping, cj dropshipping, chinese dropshipping suppliers, aliexpress dropshipping center, aliexpress dropship center, dropshipping center aliexpress" />

  <!-- share official picture -->
  <meta property="og:type" content="website" />
  <meta property="og:image" content="https://app.cjdropshipping.com/static/image/public-img/share1200x900.jpg" />
  <meta name="twitter:image" property="og:image"
    content="https://cc-west-usa.oss-us-west-1.aliyuncs.com/75e085bc-3839-440a-9847-45da052d8c53.jpg" />
  <meta property="og:image:width" content="1200px" />
  <meta property="og:image:height" content="900px" />
  <meta property="og:url" content="https://cjdropshipping.com/login.html" />

  <!-- twitter share card -->
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:domain" content="cjdropshipping.com" />
  <meta name="twitter:title" property="og:title" itemprop="name" content="Message Center - CJdropshipping" />
  <meta name="twitter:description" property="og:description" itemprop="description"
    content="CJdropshipping is a platform Sourcing and Fulfilling for WED2C, Shopify, WooCommerce, eBay Dropshippers with High-Quality Products and Faster Shipping." />

  <meta name="viewport"
    content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <title>Message Center - CJdropshipping</title>
  <link rel="shortcut icon" href="/favicon.ico" />
</head>

<body>
  <div></div>
  <script src="static/js/public/config.js"></script>
  <script>
    (() => {
      const httpsJson = window.httpsJson || {}
      const _search = urlSearchParse()
      const { countType = '', messageType = '', page = '', taskUserId = '' } = _search

      // 若taskUserId中包含taskUserId字段，说明是测试发送邮件，不需要记录点击率
      if (!taskUserId.includes('taskUserId')) {
        const _ip = httpsJson['messageCenterWeb'] || '/'
        const url = `${_ip}messageCenterWeb/messageTask/taskUserCount`
        const params = {
          countType,
          messageType,
          taskUserId
        }
        ajaxPostFun({
          href: url,
          sendData: params,
          callback: (res) => {}
        })
      }
      if (page) {
        setTimeout(() => {
          window.location.href = page
        }, 400);
      }

      //ajax post请求封装、
      function ajaxPostFun({ href, token = "", sendData, callback }) {
        let xhr = new XMLHttpRequest()
        xhr.open('post', href, true);
        xhr.setRequestHeader("Content-Type", "application/json");
        xhr.setRequestHeader("token", token || '');
        xhr.onreadystatechange = function () {
          if (xhr.readyState == 4 && xhr.status == 200) callback(JSON.parse(xhr.responseText))
        }
        xhr.send(JSON.stringify(sendData));
      }

      // 解析location的search
      function urlSearchParse(url = window.location) {
        let arr, json = {}

        try {
          url = window.decodeURIComponent(typeof url === 'object' ? url.search : url)
          arr = url.replace('?', '').split('&')
          arr.forEach(str => {
            let tmp = str.split('=')
            json[tmp[0]] = tmp[1]
          })
        } catch (e) {
          console.warn(e.stack)
        } finally {
          return json
        }
      }
    })()
  </script>
</body>

</html>